| distributed init (rank 0): tcp://localhost:10910
| distributed init (rank 1): tcp://localhost:10910
| distributed init (rank 3): tcp://localhost:10910
| distributed init (rank 2): tcp://localhost:10910
| initialized host r16g08.bullx as rank 0
| initialized host r16g08.bullx as rank 2
| initialized host r16g08.bullx as rank 1
| initialized host r16g08.bullx as rank 3
Namespace(activation_dropout=0.0, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, arch='transformer', attention_dropout=0.0, bert_first=True, bert_gates=[1, 1, 1, 1, 1, 1], bert_model_name='/scratch/project_2003453/bert-base-finnish-uncased-v1', bert_output_layer=-1, bert_ratio=1.0, bucket_cap_mb=25, clip_norm=25, cpu=False, criterion='label_smoothed_cross_entropy', curriculum=0, data='/scratch/project_2003453/bertnmt_data', dataset_impl='cached', ddp_backend='c10d', decoder_attention_heads=8, decoder_embed_dim=512, decoder_embed_path=None, decoder_ffn_embed_dim=2048, decoder_input_dim=512, decoder_layers=6, decoder_learned_pos=False, decoder_no_bert=False, decoder_normalize_before=False, decoder_output_dim=512, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method='tcp://localhost:10910', distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=4, dropout=0.3, encoder_attention_heads=8, encoder_bert_dropout=True, encoder_bert_dropout_ratio=0.5, encoder_bert_mixup=False, encoder_embed_dim=512, encoder_embed_path=None, encoder_ffn_embed_dim=2048, encoder_layers=6, encoder_learned_pos=False, encoder_normalize_before=False, encoder_ratio=1.0, find_unused_parameters=False, finetune_bert=False, fix_batches_to_gpus=False, fp16=True, fp16_init_scale=128, fp16_scale_tolerance=0.0, fp16_scale_window=None, keep_interval_updates=-1, keep_last_epochs=-1, label_smoothing=0.1, lazy_load=False, left_pad_source='True', left_pad_target='False', log_format=None, log_interval=1000, lr=[0.0005], lr_scheduler='inverse_sqrt', mask_cls_sep=False, max_epoch=0, max_sentences=None, max_sentences_valid=None, max_source_positions=1024, max_target_positions=1024, max_tokens=3584, max_update=150000, memory_efficient_fp16=False, min_loss_scale=0.0001, min_lr=1e-09, no_epoch_checkpoints=False, no_progress_bar=False, no_save=False, no_token_positional_embeddings=False, num_workers=0, optimizer='adam', optimizer_overrides='{}', raw_text=False, required_batch_size_multiple=8, reset_dataloader=False, reset_lr_scheduler=True, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='/scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv', save_interval=1, save_interval_updates=0, seed=1, sentence_avg=False, share_all_embeddings=True, share_decoder_input_output_embed=False, skip_invalid_size_inputs_valid_test=False, source_lang='fi', target_lang='sv', task='translation', tbmf_wrapper=False, tensorboard_logdir='', threshold_loss_scale=None, train_subset='train', update_freq=[1], upsample_primary=1, user_dir=None, valid_subset='valid', validate_interval=1, warmup_from_nmt=True, warmup_init_lr=1e-07, warmup_nmt_file='checkpoint_nmt.pt', warmup_updates=4000, weight_decay=0.0001)
| [fi] dictionary: 37752 types
| [sv] dictionary: 37752 types
| /scratch/project_2003453/bertnmt_data valid fi-sv 5000 examples
bert_gates [True, True, True, True, True, True]
TransformerModel(
  (encoder): TransformerEncoder(
    (embed_tokens): Embedding(37752, 512, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (decoder): TransformerDecoder(
    (embed_tokens): Embedding(37752, 512, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (4): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
      (5): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=512, out_features=2048, bias=True)
        (fc2): Linear(in_features=2048, out_features=512, bias=True)
        (final_layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (bert_encoder): BertModel(
    (embeddings): BertEmbeddings(
      (word_embeddings): Embedding(50101, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): BertEncoder(
      (layer): ModuleList(
        (0): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
)
| model transformer, criterion LabelSmoothedCrossEntropyCriterion
| num. model params: 195863040 (num. trained: 71344128)
| training on 4 GPUs
| max tokens per GPU = 3584 and max sentences per GPU = None
Model will load checkpoint from /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint_nmt.pt
| distributed init (rank 3): tcp://localhost:17818
| distributed init (rank 2): tcp://localhost:17818
| distributed init (rank 1): tcp://localhost:17818
| distributed init (rank 0): tcp://localhost:17818
| initialized host r18g05.bullx as rank 3
| initialized host r18g05.bullx as rank 1
| initialized host r18g05.bullx as rank 0
| initialized host r18g05.bullx as rank 2
Namespace(activation_dropout=0.0, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, arch='transformer_vaswani_wmt_en_de_big', attention_dropout=0.0, bert_first=True, bert_gates=[1, 1, 1, 1, 1, 1], bert_model_name='/scratch/project_2003453/bert-base-finnish-uncased-v1', bert_output_layer=-1, bert_ratio=1.0, bucket_cap_mb=25, clip_norm=25, cpu=False, criterion='label_smoothed_cross_entropy', curriculum=0, data='/scratch/project_2003453/bertnmt_data', dataset_impl='cached', ddp_backend='c10d', decoder_attention_heads=16, decoder_embed_dim=1024, decoder_embed_path=None, decoder_ffn_embed_dim=4096, decoder_input_dim=1024, decoder_layers=6, decoder_learned_pos=False, decoder_no_bert=False, decoder_normalize_before=False, decoder_output_dim=1024, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method='tcp://localhost:17818', distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=4, dropout=0.3, encoder_attention_heads=16, encoder_bert_dropout=True, encoder_bert_dropout_ratio=0.5, encoder_bert_mixup=False, encoder_embed_dim=1024, encoder_embed_path=None, encoder_ffn_embed_dim=4096, encoder_layers=6, encoder_learned_pos=False, encoder_normalize_before=False, encoder_ratio=1.0, find_unused_parameters=False, finetune_bert=False, fix_batches_to_gpus=False, fp16=True, fp16_init_scale=128, fp16_scale_tolerance=0.0, fp16_scale_window=None, keep_interval_updates=-1, keep_last_epochs=-1, label_smoothing=0.1, lazy_load=False, left_pad_source='True', left_pad_target='False', log_format=None, log_interval=1000, lr=[0.0005], lr_scheduler='inverse_sqrt', mask_cls_sep=False, max_epoch=0, max_sentences=None, max_sentences_valid=None, max_source_positions=1024, max_target_positions=1024, max_tokens=3584, max_update=150000, memory_efficient_fp16=False, min_loss_scale=0.0001, min_lr=1e-09, no_epoch_checkpoints=False, no_progress_bar=False, no_save=False, no_token_positional_embeddings=False, num_workers=0, optimizer='adam', optimizer_overrides='{}', raw_text=False, required_batch_size_multiple=8, reset_dataloader=False, reset_lr_scheduler=True, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='/scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv', save_interval=1, save_interval_updates=0, seed=1, sentence_avg=False, share_all_embeddings=True, share_decoder_input_output_embed=False, skip_invalid_size_inputs_valid_test=False, source_lang='fi', target_lang='sv', task='translation', tbmf_wrapper=False, tensorboard_logdir='', threshold_loss_scale=None, train_subset='train', update_freq=[1], upsample_primary=1, user_dir=None, valid_subset='valid', validate_interval=1, warmup_from_nmt=True, warmup_init_lr=1e-07, warmup_nmt_file='checkpoint_nmt.pt', warmup_updates=4000, weight_decay=0.0001)
| [fi] dictionary: 37752 types
| [sv] dictionary: 37752 types
| /scratch/project_2003453/bertnmt_data valid fi-sv 5000 examples
bert_gates [True, True, True, True, True, True]
TransformerModel(
  (encoder): TransformerEncoder(
    (embed_tokens): Embedding(37752, 1024, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (decoder): TransformerDecoder(
    (embed_tokens): Embedding(37752, 1024, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (4): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (5): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (bert_encoder): BertModel(
    (embeddings): BertEmbeddings(
      (word_embeddings): Embedding(50101, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): BertEncoder(
      (layer): ModuleList(
        (0): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
)
| model transformer_vaswani_wmt_en_de_big, criterion LabelSmoothedCrossEntropyCriterion
| num. model params: 361579008 (num. trained: 237060096)
| training on 4 GPUs
| max tokens per GPU = 3584 and max sentences per GPU = None
Model will load checkpoint from /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint_nmt.pt
| loaded checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint_nmt.pt (epoch 67 @ 0 updates)
| loading train data for epoch 67
| /scratch/project_2003453/bertnmt_data train fi-sv 30659795 examples
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint67.pt (epoch 67 @ 0 updates) (writing took 2.1107702255249023 seconds)
| WARNING: overflow detected, setting loss scale to: 64.0
| WARNING: overflow detected, setting loss scale to: 32.0
| WARNING: overflow detected, setting loss scale to: 16.0
| WARNING: overflow detected, setting loss scale to: 8.0
| WARNING: overflow detected, setting loss scale to: 4.0
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 067:  40000 / 49553 loss=4.598, nll_loss=3.015, ppl=8.08, wps=19487, ups=2, wpb=10057.544, bsz=607.881, num_updates=873, lr=0.000109203, gnorm=1.822, clip=0.000, oom=0.000, loss_scale=2.000, wall=451, train_wall=316271
| epoch 067:  41000 / 49553 loss=4.435, nll_loss=2.828, ppl=7.10, wps=30212, ups=3, wpb=10076.970, bsz=609.516, num_updates=1873, lr=0.000234178, gnorm=1.522, clip=0.000, oom=0.000, loss_scale=2.000, wall=625, train_wall=316428
Invalid bert_input shape:torch.Size([6, 555])
| epoch 067:  42000 / 49553 loss=4.398, nll_loss=2.786, ppl=6.90, wps=36150, ups=4, wpb=10091.225, bsz=612.591, num_updates=2873, lr=0.000359153, gnorm=1.427, clip=0.000, oom=0.000, loss_scale=2.000, wall=802, train_wall=316583
Invalid bert_input shape:torch.Size([6, 575])
| epoch 067:  43000 / 49553 loss=4.409, nll_loss=2.798, ppl=6.96, wps=40018, ups=4, wpb=10089.540, bsz=613.242, num_updates=3873, lr=0.000484128, gnorm=1.420, clip=0.000, oom=0.000, loss_scale=2.000, wall=976, train_wall=316738
Invalid bert_input shape:torch.Size([4, 790])
| WARNING: overflow detected, setting loss scale to: 2.0
| WARNING: overflow detected, setting loss scale to: 1.0
| epoch 067:  44000 / 49553 loss=4.439, nll_loss=2.832, ppl=7.12, wps=42679, ups=4, wpb=10072.247, bsz=615.548, num_updates=4871, lr=0.000453097, gnorm=1.430, clip=0.000, oom=0.000, loss_scale=1.000, wall=1150, train_wall=316893
Invalid bert_input shape:torch.Size([5, 703])
| epoch 067:  45000 / 49553 loss=4.453, nll_loss=2.847, ppl=7.19, wps=44626, ups=4, wpb=10072.456, bsz=616.358, num_updates=5871, lr=0.000412709, gnorm=1.459, clip=0.000, oom=0.000, loss_scale=1.000, wall=1325, train_wall=317051
| epoch 067:  46000 / 49553 loss=4.460, nll_loss=2.855, ppl=7.23, wps=46199, ups=5, wpb=10085.364, bsz=616.484, num_updates=6871, lr=0.000381496, gnorm=1.451, clip=0.000, oom=0.000, loss_scale=1.000, wall=1500, train_wall=317208
| WARNING: overflow detected, setting loss scale to: 0.5
Invalid bert_input shape:torch.Size([4, 858])
Invalid bert_input shape:torch.Size([4, 720])
| epoch 067:  47000 / 49553 loss=4.460, nll_loss=2.855, ppl=7.23, wps=47427, ups=5, wpb=10087.389, bsz=618.504, num_updates=7870, lr=0.000356462, gnorm=1.443, clip=0.000, oom=0.000, loss_scale=0.500, wall=1674, train_wall=317364
| epoch 067:  48000 / 49553 loss=4.460, nll_loss=2.854, ppl=7.23, wps=48418, ups=5, wpb=10093.328, bsz=618.331, num_updates=8870, lr=0.000335767, gnorm=1.424, clip=0.000, oom=0.000, loss_scale=0.500, wall=1849, train_wall=317522
| epoch 067:  49000 / 49553 loss=4.455, nll_loss=2.848, ppl=7.20, wps=49187, ups=5, wpb=10088.868, bsz=617.057, num_updates=9870, lr=0.000318304, gnorm=1.403, clip=0.000, oom=0.000, loss_scale=0.500, wall=2024, train_wall=317679
Invalid bert_input shape:torch.Size([5, 994])
| epoch 067 | loss 4.453 | nll_loss 2.847 | ppl 7.19 | wps 49594 | ups 5 | wpb 10089.874 | bsz 616.289 | num_updates 10422 | lr 0.000309759 | gnorm 1.392 | clip 0.000 | oom 0.000 | loss_scale 0.500 | wall 2120 | train_wall 317766
| epoch 067 | valid on 'valid' subset | loss 2.909 | nll_loss 1.070 | ppl 2.10 | num_updates 10422 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint67.pt (epoch 67 @ 10422 updates) (writing took 6.6698267459869385 seconds)
| epoch 068:   1000 / 49553 loss=4.356, nll_loss=2.737, ppl=6.67, wps=57217, ups=3, wpb=10168.351, bsz=616.967, num_updates=11423, lr=0.000295876, gnorm=1.189, clip=0.000, oom=0.000, loss_scale=1.000, wall=2432, train_wall=317925
| epoch 068:   2000 / 49553 loss=4.363, nll_loss=2.746, ppl=6.71, wps=57433, ups=4, wpb=10160.890, bsz=617.146, num_updates=12423, lr=0.000283718, gnorm=1.184, clip=0.000, oom=0.000, loss_scale=1.000, wall=2608, train_wall=318083
| epoch 068:   3000 / 49553 loss=4.361, nll_loss=2.744, ppl=6.70, wps=57374, ups=5, wpb=10129.154, bsz=620.075, num_updates=13423, lr=0.000272945, gnorm=1.189, clip=0.001, oom=0.000, loss_scale=1.000, wall=2784, train_wall=318240
Invalid bert_input shape:torch.Size([4, 858])
| epoch 068:   4000 / 49553 loss=4.351, nll_loss=2.733, ppl=6.65, wps=57318, ups=5, wpb=10117.485, bsz=618.689, num_updates=14423, lr=0.000263313, gnorm=1.166, clip=0.000, oom=0.000, loss_scale=1.000, wall=2961, train_wall=318398
| epoch 068:   5000 / 49553 loss=4.342, nll_loss=2.723, ppl=6.60, wps=57195, ups=5, wpb=10127.596, bsz=617.801, num_updates=15423, lr=0.000254634, gnorm=1.156, clip=0.001, oom=0.000, loss_scale=2.000, wall=3140, train_wall=318558
Invalid bert_input shape:torch.Size([4, 843])
| epoch 068:   6000 / 49553 loss=4.335, nll_loss=2.715, ppl=6.57, wps=57231, ups=5, wpb=10129.271, bsz=618.659, num_updates=16423, lr=0.000246759, gnorm=1.139, clip=0.000, oom=0.000, loss_scale=2.000, wall=3316, train_wall=318715
Invalid bert_input shape:torch.Size([6, 1334])
| epoch 068:   7000 / 49553 loss=4.329, nll_loss=2.709, ppl=6.54, wps=57378, ups=5, wpb=10133.281, bsz=618.789, num_updates=17423, lr=0.000239573, gnorm=1.124, clip=0.000, oom=0.000, loss_scale=2.000, wall=3491, train_wall=318871
| epoch 068:   8000 / 49553 loss=4.322, nll_loss=2.701, ppl=6.50, wps=57343, ups=5, wpb=10121.700, bsz=618.409, num_updates=18423, lr=0.000232981, gnorm=1.116, clip=0.000, oom=0.000, loss_scale=2.000, wall=3667, train_wall=319029
Invalid bert_input shape:torch.Size([3, 944])
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 068:   9000 / 49553 loss=4.316, nll_loss=2.694, ppl=6.47, wps=57410, ups=5, wpb=10117.001, bsz=618.147, num_updates=19422, lr=0.00022691, gnorm=1.105, clip=0.000, oom=0.000, loss_scale=2.000, wall=3840, train_wall=319185
| epoch 068:  10000 / 49553 loss=4.310, nll_loss=2.688, ppl=6.44, wps=57371, ups=5, wpb=10119.070, bsz=618.333, num_updates=20422, lr=0.000221284, gnorm=1.098, clip=0.000, oom=0.000, loss_scale=2.000, wall=4018, train_wall=319344
| epoch 068:  11000 / 49553 loss=4.305, nll_loss=2.682, ppl=6.42, wps=57356, ups=5, wpb=10118.600, bsz=618.371, num_updates=21422, lr=0.000216058, gnorm=1.092, clip=0.000, oom=0.000, loss_scale=2.000, wall=4195, train_wall=319502
| epoch 068:  12000 / 49553 loss=4.297, nll_loss=2.674, ppl=6.38, wps=57411, ups=5, wpb=10113.855, bsz=617.926, num_updates=22422, lr=0.000211185, gnorm=1.084, clip=0.000, oom=0.000, loss_scale=2.000, wall=4368, train_wall=319658
| epoch 068:  13000 / 49553 loss=4.293, nll_loss=2.670, ppl=6.36, wps=57471, ups=5, wpb=10115.820, bsz=618.921, num_updates=23422, lr=0.000206627, gnorm=1.077, clip=0.000, oom=0.000, loss_scale=4.000, wall=4543, train_wall=319813
Invalid bert_input shape:torch.Size([8, 1356])
| epoch 068:  14000 / 49553 loss=4.288, nll_loss=2.664, ppl=6.34, wps=57508, ups=5, wpb=10116.009, bsz=619.105, num_updates=24422, lr=0.000202353, gnorm=1.070, clip=0.000, oom=0.000, loss_scale=4.000, wall=4717, train_wall=319970
Invalid bert_input shape:torch.Size([6, 547])
| epoch 068:  15000 / 49553 loss=4.285, nll_loss=2.660, ppl=6.32, wps=57528, ups=5, wpb=10111.261, bsz=619.290, num_updates=25422, lr=0.000198333, gnorm=1.063, clip=0.000, oom=0.000, loss_scale=4.000, wall=4891, train_wall=320124
| WARNING: overflow detected, setting loss scale to: 2.0
| WARNING: overflow detected, setting loss scale to: 1.0
| epoch 068:  16000 / 49553 loss=4.279, nll_loss=2.654, ppl=6.29, wps=57536, ups=5, wpb=10108.381, bsz=619.161, num_updates=26420, lr=0.000194551, gnorm=1.058, clip=0.000, oom=0.000, loss_scale=1.000, wall=5065, train_wall=320279
| epoch 068:  17000 / 49553 loss=4.274, nll_loss=2.648, ppl=6.27, wps=57505, ups=5, wpb=10109.389, bsz=619.298, num_updates=27420, lr=0.00019097, gnorm=1.054, clip=0.000, oom=0.000, loss_scale=1.000, wall=5243, train_wall=320439
| epoch 068:  18000 / 49553 loss=4.270, nll_loss=2.644, ppl=6.25, wps=57537, ups=5, wpb=10108.488, bsz=619.676, num_updates=28420, lr=0.000187581, gnorm=1.048, clip=0.000, oom=0.000, loss_scale=1.000, wall=5416, train_wall=320596
Invalid bert_input shape:torch.Size([4, 790])
| epoch 068:  19000 / 49553 loss=4.266, nll_loss=2.640, ppl=6.23, wps=57539, ups=5, wpb=10106.409, bsz=619.383, num_updates=29420, lr=0.000184365, gnorm=1.043, clip=0.000, oom=0.000, loss_scale=1.000, wall=5591, train_wall=320753
Invalid bert_input shape:torch.Size([4, 720])
| epoch 068:  20000 / 49553 loss=4.261, nll_loss=2.634, ppl=6.21, wps=57562, ups=5, wpb=10106.592, bsz=619.401, num_updates=30420, lr=0.000181309, gnorm=1.037, clip=0.000, oom=0.000, loss_scale=2.000, wall=5766, train_wall=320910
Invalid bert_input shape:torch.Size([6, 546])
| epoch 068:  21000 / 49553 loss=4.257, nll_loss=2.630, ppl=6.19, wps=57545, ups=5, wpb=10104.454, bsz=619.005, num_updates=31420, lr=0.000178401, gnorm=1.032, clip=0.000, oom=0.000, loss_scale=2.000, wall=5941, train_wall=321062
Invalid bert_input shape:torch.Size([4, 721])
| epoch 068:  22000 / 49553 loss=4.253, nll_loss=2.626, ppl=6.17, wps=57513, ups=6, wpb=10103.863, bsz=619.253, num_updates=32420, lr=0.000175628, gnorm=1.027, clip=0.000, oom=0.000, loss_scale=2.000, wall=6119, train_wall=321218
Invalid bert_input shape:torch.Size([5, 795])
| epoch 068:  23000 / 49553 loss=4.249, nll_loss=2.622, ppl=6.15, wps=57547, ups=6, wpb=10102.891, bsz=619.265, num_updates=33420, lr=0.00017298, gnorm=1.022, clip=0.000, oom=0.000, loss_scale=2.000, wall=6292, train_wall=321373
| epoch 068:  24000 / 49553 loss=4.246, nll_loss=2.618, ppl=6.14, wps=57580, ups=6, wpb=10105.457, bsz=619.109, num_updates=34420, lr=0.000170449, gnorm=1.018, clip=0.000, oom=0.000, loss_scale=4.000, wall=6466, train_wall=321530
Invalid bert_input shape:torch.Size([4, 782])
| epoch 068:  25000 / 49553 loss=4.242, nll_loss=2.613, ppl=6.12, wps=57549, ups=6, wpb=10104.842, bsz=619.023, num_updates=35420, lr=0.000168026, gnorm=1.014, clip=0.000, oom=0.000, loss_scale=4.000, wall=6644, train_wall=321689
Invalid bert_input shape:torch.Size([8, 844])
| epoch 068:  26000 / 49553 loss=4.238, nll_loss=2.609, ppl=6.10, wps=57505, ups=6, wpb=10101.565, bsz=619.386, num_updates=36420, lr=0.000165703, gnorm=1.010, clip=0.000, oom=0.000, loss_scale=4.000, wall=6821, train_wall=321848
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 068:  27000 / 49553 loss=4.235, nll_loss=2.605, ppl=6.09, wps=57510, ups=6, wpb=10103.371, bsz=619.006, num_updates=37419, lr=0.000163476, gnorm=1.006, clip=0.000, oom=0.000, loss_scale=2.000, wall=6997, train_wall=322005
Invalid bert_input shape:torch.Size([7, 900])
| epoch 068:  28000 / 49553 loss=4.231, nll_loss=2.601, ppl=6.07, wps=57462, ups=6, wpb=10102.845, bsz=618.874, num_updates=38419, lr=0.000161334, gnorm=1.002, clip=0.000, oom=0.000, loss_scale=2.000, wall=7177, train_wall=322166
Invalid bert_input shape:torch.Size([5, 692])
| epoch 068:  29000 / 49553 loss=4.227, nll_loss=2.597, ppl=6.05, wps=57436, ups=6, wpb=10102.919, bsz=618.794, num_updates=39419, lr=0.000159275, gnorm=0.999, clip=0.000, oom=0.000, loss_scale=2.000, wall=7355, train_wall=322325
Invalid bert_input shape:torch.Size([7, 600])
| WARNING: overflow detected, setting loss scale to: 1.0
Invalid bert_input shape:torch.Size([5, 627])
| epoch 068:  30000 / 49553 loss=4.225, nll_loss=2.595, ppl=6.04, wps=57427, ups=6, wpb=10105.518, bsz=618.683, num_updates=40418, lr=0.000157294, gnorm=0.996, clip=0.000, oom=0.000, loss_scale=1.000, wall=7533, train_wall=322485
| epoch 068:  31000 / 49553 loss=4.221, nll_loss=2.591, ppl=6.02, wps=57396, ups=6, wpb=10104.253, bsz=618.731, num_updates=41418, lr=0.000155384, gnorm=0.993, clip=0.000, oom=0.000, loss_scale=1.000, wall=7711, train_wall=322643
| epoch 068:  32000 / 49553 loss=4.218, nll_loss=2.587, ppl=6.01, wps=57420, ups=6, wpb=10104.192, bsz=618.965, num_updates=42418, lr=0.000153541, gnorm=0.989, clip=0.000, oom=0.000, loss_scale=1.000, wall=7885, train_wall=322798
Invalid bert_input shape:torch.Size([3, 1184])
Invalid bert_input shape:torch.Size([5, 994])
| epoch 068:  33000 / 49553 loss=4.215, nll_loss=2.584, ppl=6.00, wps=57435, ups=6, wpb=10102.772, bsz=618.960, num_updates=43418, lr=0.000151763, gnorm=0.986, clip=0.000, oom=0.000, loss_scale=1.000, wall=8058, train_wall=322955
| epoch 068:  34000 / 49553 loss=4.212, nll_loss=2.581, ppl=5.98, wps=57430, ups=6, wpb=10101.539, bsz=618.655, num_updates=44418, lr=0.000150045, gnorm=0.983, clip=0.000, oom=0.000, loss_scale=2.000, wall=8234, train_wall=323112
| epoch 068:  35000 / 49553 loss=4.210, nll_loss=2.578, ppl=5.97, wps=57452, ups=6, wpb=10102.637, bsz=618.605, num_updates=45418, lr=0.000148384, gnorm=0.980, clip=0.000, oom=0.000, loss_scale=2.000, wall=8408, train_wall=323269
Invalid bert_input shape:torch.Size([5, 614])
| WARNING: overflow detected, setting loss scale to: 1.0
| epoch 068:  36000 / 49553 loss=4.207, nll_loss=2.575, ppl=5.96, wps=57460, ups=6, wpb=10100.478, bsz=618.870, num_updates=46417, lr=0.000146778, gnorm=0.977, clip=0.000, oom=0.000, loss_scale=1.000, wall=8582, train_wall=323424
Invalid bert_input shape:torch.Size([7, 865])
| epoch 068:  37000 / 49553 loss=4.204, nll_loss=2.572, ppl=5.95, wps=57472, ups=6, wpb=10102.721, bsz=618.660, num_updates=47417, lr=0.000145222, gnorm=0.975, clip=0.000, oom=0.000, loss_scale=1.000, wall=8757, train_wall=323582
| epoch 068:  38000 / 49553 loss=4.202, nll_loss=2.570, ppl=5.94, wps=57486, ups=6, wpb=10100.862, bsz=618.236, num_updates=48417, lr=0.000143715, gnorm=0.973, clip=0.000, oom=0.000, loss_scale=1.000, wall=8930, train_wall=323737
| WARNING: overflow detected, setting loss scale to: 0.5
Invalid bert_input shape:torch.Size([4, 1167])
| epoch 068:  39000 / 49553 loss=4.200, nll_loss=2.567, ppl=5.93, wps=57509, ups=6, wpb=10101.643, bsz=618.153, num_updates=49416, lr=0.000142255, gnorm=0.971, clip=0.000, oom=0.000, loss_scale=0.500, wall=9104, train_wall=323893
| epoch 068:  40000 / 49553 loss=4.197, nll_loss=2.565, ppl=5.92, wps=57518, ups=6, wpb=10102.113, bsz=618.122, num_updates=50416, lr=0.000140837, gnorm=0.968, clip=0.000, oom=0.000, loss_scale=0.500, wall=9279, train_wall=324049
Invalid bert_input shape:torch.Size([6, 784])
Invalid bert_input shape:torch.Size([3, 1514])
| epoch 068:  41000 / 49553 loss=4.195, nll_loss=2.562, ppl=5.91, wps=57542, ups=6, wpb=10105.040, bsz=618.207, num_updates=51416, lr=0.00013946, gnorm=0.966, clip=0.000, oom=0.000, loss_scale=0.500, wall=9453, train_wall=324205
| epoch 068:  42000 / 49553 loss=4.193, nll_loss=2.560, ppl=5.90, wps=57564, ups=6, wpb=10106.370, bsz=618.168, num_updates=52416, lr=0.000138124, gnorm=0.964, clip=0.000, oom=0.000, loss_scale=0.500, wall=9627, train_wall=324362
Invalid bert_input shape:torch.Size([4, 831])
Invalid bert_input shape:torch.Size([7, 722])
| epoch 068:  43000 / 49553 loss=4.191, nll_loss=2.558, ppl=5.89, wps=57557, ups=6, wpb=10104.648, bsz=618.055, num_updates=53416, lr=0.000136825, gnorm=0.962, clip=0.000, oom=0.000, loss_scale=1.000, wall=9802, train_wall=324520
| epoch 068:  44000 / 49553 loss=4.189, nll_loss=2.556, ppl=5.88, wps=57566, ups=6, wpb=10104.889, bsz=618.282, num_updates=54416, lr=0.000135562, gnorm=0.959, clip=0.000, oom=0.000, loss_scale=1.000, wall=9977, train_wall=324676
| WARNING: overflow detected, setting loss scale to: 0.5
| epoch 068:  45000 / 49553 loss=4.187, nll_loss=2.553, ppl=5.87, wps=57564, ups=6, wpb=10103.471, bsz=618.412, num_updates=55415, lr=0.000134334, gnorm=0.957, clip=0.000, oom=0.000, loss_scale=0.500, wall=10151, train_wall=324833
| epoch 068:  46000 / 49553 loss=4.185, nll_loss=2.551, ppl=5.86, wps=57565, ups=6, wpb=10102.452, bsz=618.336, num_updates=56415, lr=0.000133138, gnorm=0.955, clip=0.000, oom=0.000, loss_scale=0.500, wall=10326, train_wall=324990
Invalid bert_input shape:torch.Size([6, 550])
| epoch 068:  47000 / 49553 loss=4.183, nll_loss=2.549, ppl=5.85, wps=57575, ups=6, wpb=10101.879, bsz=618.454, num_updates=57415, lr=0.000131974, gnorm=0.953, clip=0.000, oom=0.000, loss_scale=0.500, wall=10500, train_wall=325146
Invalid bert_input shape:torch.Size([6, 863])
| epoch 068:  48000 / 49553 loss=4.181, nll_loss=2.547, ppl=5.84, wps=57577, ups=6, wpb=10101.411, bsz=618.525, num_updates=58415, lr=0.000130839, gnorm=0.951, clip=0.000, oom=0.000, loss_scale=0.500, wall=10674, train_wall=325303
Invalid bert_input shape:torch.Size([5, 636])
| epoch 068:  49000 / 49553 loss=4.179, nll_loss=2.545, ppl=5.83, wps=57565, ups=6, wpb=10099.902, bsz=618.660, num_updates=59415, lr=0.000129733, gnorm=0.949, clip=0.000, oom=0.000, loss_scale=1.000, wall=10850, train_wall=325461
| epoch 068 | loss 4.178 | nll_loss 2.543 | ppl 5.83 | wps 57557 | ups 6 | wpb 10099.871 | bsz 618.720 | num_updates 59967 | lr 0.000129135 | gnorm 0.948 | clip 0.000 | oom 0.000 | loss_scale 1.000 | wall 10948 | train_wall 325550
| epoch 068 | valid on 'valid' subset | loss 2.828 | nll_loss 1.000 | ppl 2.00 | num_updates 59967 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint68.pt (epoch 68 @ 59967 updates) (writing took 6.775952577590942 seconds)
| epoch 069:   1000 / 49553 loss=4.069, nll_loss=2.423, ppl=5.36, wps=57678, ups=3, wpb=10089.714, bsz=605.586, num_updates=60968, lr=0.00012807, gnorm=0.846, clip=0.000, oom=0.000, loss_scale=1.000, wall=11260, train_wall=325717
| epoch 069:   2000 / 49553 loss=4.052, nll_loss=2.404, ppl=5.29, wps=57243, ups=4, wpb=10071.669, bsz=618.090, num_updates=61968, lr=0.000127033, gnorm=0.850, clip=0.000, oom=0.000, loss_scale=1.000, wall=11437, train_wall=325876
| epoch 069:   3000 / 49553 loss=4.054, nll_loss=2.407, ppl=5.30, wps=57429, ups=5, wpb=10099.875, bsz=618.585, num_updates=62968, lr=0.00012602, gnorm=0.851, clip=0.000, oom=0.000, loss_scale=1.000, wall=11612, train_wall=326032
Invalid bert_input shape:torch.Size([4, 782])
| epoch 069:   4000 / 49553 loss=4.054, nll_loss=2.407, ppl=5.30, wps=57344, ups=5, wpb=10099.623, bsz=620.339, num_updates=63968, lr=0.000125031, gnorm=0.852, clip=0.000, oom=0.000, loss_scale=2.000, wall=11789, train_wall=326190
Invalid bert_input shape:torch.Size([4, 859])
| epoch 069:   5000 / 49553 loss=4.051, nll_loss=2.404, ppl=5.29, wps=57234, ups=5, wpb=10107.360, bsz=620.840, num_updates=64968, lr=0.000124065, gnorm=0.853, clip=0.000, oom=0.000, loss_scale=2.000, wall=11968, train_wall=326351
Invalid bert_input shape:torch.Size([6, 878])
| epoch 069:   6000 / 49553 loss=4.053, nll_loss=2.406, ppl=5.30, wps=57343, ups=5, wpb=10111.274, bsz=620.691, num_updates=65968, lr=0.000123121, gnorm=0.855, clip=0.000, oom=0.000, loss_scale=2.000, wall=12143, train_wall=326506
Invalid bert_input shape:torch.Size([5, 692])
| epoch 069:   7000 / 49553 loss=4.052, nll_loss=2.405, ppl=5.30, wps=57173, ups=5, wpb=10099.955, bsz=620.697, num_updates=66968, lr=0.000122199, gnorm=0.856, clip=0.000, oom=0.000, loss_scale=2.000, wall=12321, train_wall=326666
| epoch 069:   8000 / 49553 loss=4.055, nll_loss=2.408, ppl=5.31, wps=57113, ups=5, wpb=10107.474, bsz=619.532, num_updates=67968, lr=0.000121296, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=4.000, wall=12501, train_wall=326826
| epoch 069:   9000 / 49553 loss=4.055, nll_loss=2.409, ppl=5.31, wps=57058, ups=5, wpb=10104.081, bsz=619.590, num_updates=68968, lr=0.000120414, gnorm=0.852, clip=0.000, oom=0.000, loss_scale=4.000, wall=12679, train_wall=326985
| epoch 069:  10000 / 49553 loss=4.053, nll_loss=2.407, ppl=5.30, wps=57015, ups=5, wpb=10106.046, bsz=620.596, num_updates=69968, lr=0.00011955, gnorm=0.851, clip=0.000, oom=0.000, loss_scale=4.000, wall=12857, train_wall=327147
| epoch 069:  11000 / 49553 loss=4.054, nll_loss=2.407, ppl=5.31, wps=57068, ups=5, wpb=10110.757, bsz=621.122, num_updates=70968, lr=0.000118705, gnorm=0.850, clip=0.000, oom=0.000, loss_scale=4.000, wall=13034, train_wall=327304
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 069:  12000 / 49553 loss=4.053, nll_loss=2.406, ppl=5.30, wps=57101, ups=5, wpb=10107.497, bsz=619.653, num_updates=71967, lr=0.000117878, gnorm=0.849, clip=0.000, oom=0.000, loss_scale=4.000, wall=13209, train_wall=327461
Invalid bert_input shape:torch.Size([6, 528])
| epoch 069:  13000 / 49553 loss=4.053, nll_loss=2.406, ppl=5.30, wps=57154, ups=5, wpb=10106.631, bsz=619.227, num_updates=72967, lr=0.000117068, gnorm=0.848, clip=0.000, oom=0.000, loss_scale=4.000, wall=13383, train_wall=327617
Invalid bert_input shape:torch.Size([5, 616])
Invalid bert_input shape:torch.Size([5, 907])
| WARNING: overflow detected, setting loss scale to: 2.0
Invalid bert_input shape:torch.Size([7, 840])
| epoch 069:  14000 / 49553 loss=4.051, nll_loss=2.404, ppl=5.29, wps=57181, ups=5, wpb=10105.187, bsz=619.723, num_updates=73966, lr=0.000116274, gnorm=0.847, clip=0.000, oom=0.000, loss_scale=2.000, wall=13558, train_wall=327774
Invalid bert_input shape:torch.Size([2, 1562])
Invalid bert_input shape:torch.Size([4, 760])
| epoch 069:  15000 / 49553 loss=4.050, nll_loss=2.403, ppl=5.29, wps=57213, ups=5, wpb=10103.670, bsz=620.521, num_updates=74966, lr=0.000115496, gnorm=0.846, clip=0.000, oom=0.000, loss_scale=2.000, wall=13733, train_wall=327931
| epoch 069:  16000 / 49553 loss=4.049, nll_loss=2.402, ppl=5.29, wps=57243, ups=5, wpb=10104.896, bsz=619.781, num_updates=75966, lr=0.000114734, gnorm=0.845, clip=0.000, oom=0.000, loss_scale=2.000, wall=13909, train_wall=328089
Invalid bert_input shape:torch.Size([6, 550])
| epoch 069:  17000 / 49553 loss=4.049, nll_loss=2.402, ppl=5.29, wps=57302, ups=5, wpb=10107.029, bsz=619.484, num_updates=76966, lr=0.000113986, gnorm=0.844, clip=0.000, oom=0.000, loss_scale=2.000, wall=14083, train_wall=328245
| epoch 069:  18000 / 49553 loss=4.049, nll_loss=2.402, ppl=5.29, wps=57298, ups=5, wpb=10106.694, bsz=619.600, num_updates=77966, lr=0.000113252, gnorm=0.843, clip=0.000, oom=0.000, loss_scale=4.000, wall=14259, train_wall=328402
Invalid bert_input shape:torch.Size([8, 1356])
| epoch 069:  19000 / 49553 loss=4.048, nll_loss=2.402, ppl=5.28, wps=57264, ups=5, wpb=10107.015, bsz=618.871, num_updates=78966, lr=0.000112533, gnorm=0.843, clip=0.000, oom=0.000, loss_scale=4.000, wall=14438, train_wall=328563
| epoch 069:  20000 / 49553 loss=4.048, nll_loss=2.401, ppl=5.28, wps=57222, ups=5, wpb=10103.549, bsz=618.777, num_updates=79966, lr=0.000111827, gnorm=0.843, clip=0.000, oom=0.000, loss_scale=4.000, wall=14616, train_wall=328723
| epoch 069:  21000 / 49553 loss=4.048, nll_loss=2.401, ppl=5.28, wps=57256, ups=5, wpb=10105.707, bsz=618.926, num_updates=80966, lr=0.000111134, gnorm=0.842, clip=0.000, oom=0.000, loss_scale=4.000, wall=14791, train_wall=328881
| epoch 069:  22000 / 49553 loss=4.047, nll_loss=2.400, ppl=5.28, wps=57274, ups=5, wpb=10105.375, bsz=619.029, num_updates=81966, lr=0.000110454, gnorm=0.841, clip=0.000, oom=0.000, loss_scale=8.000, wall=14966, train_wall=329038
| epoch 069:  23000 / 49553 loss=4.047, nll_loss=2.400, ppl=5.28, wps=57273, ups=5, wpb=10105.157, bsz=618.276, num_updates=82966, lr=0.000109787, gnorm=0.840, clip=0.000, oom=0.000, loss_scale=8.000, wall=15142, train_wall=329197
| epoch 069:  24000 / 49553 loss=4.046, nll_loss=2.399, ppl=5.27, wps=57286, ups=5, wpb=10104.873, bsz=617.689, num_updates=83966, lr=0.000109131, gnorm=0.840, clip=0.000, oom=0.000, loss_scale=8.000, wall=15318, train_wall=329354
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 069:  25000 / 49553 loss=4.045, nll_loss=2.398, ppl=5.27, wps=57296, ups=6, wpb=10104.840, bsz=617.086, num_updates=84965, lr=0.000108488, gnorm=0.839, clip=0.000, oom=0.000, loss_scale=4.000, wall=15493, train_wall=329511
Invalid bert_input shape:torch.Size([6, 546])
| epoch 069:  26000 / 49553 loss=4.044, nll_loss=2.397, ppl=5.27, wps=57316, ups=6, wpb=10105.513, bsz=616.648, num_updates=85965, lr=0.000107855, gnorm=0.839, clip=0.000, oom=0.000, loss_scale=4.000, wall=15668, train_wall=329668
Invalid bert_input shape:torch.Size([6, 896])
| epoch 069:  27000 / 49553 loss=4.043, nll_loss=2.396, ppl=5.26, wps=57339, ups=6, wpb=10103.173, bsz=616.696, num_updates=86965, lr=0.000107233, gnorm=0.838, clip=0.000, oom=0.000, loss_scale=4.000, wall=15842, train_wall=329824
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 069:  28000 / 49553 loss=4.043, nll_loss=2.396, ppl=5.26, wps=57355, ups=6, wpb=10105.508, bsz=616.830, num_updates=87964, lr=0.000106622, gnorm=0.838, clip=0.000, oom=0.000, loss_scale=2.000, wall=16017, train_wall=329982
| epoch 069:  29000 / 49553 loss=4.042, nll_loss=2.394, ppl=5.26, wps=57380, ups=6, wpb=10106.401, bsz=617.327, num_updates=88964, lr=0.000106021, gnorm=0.838, clip=0.000, oom=0.000, loss_scale=2.000, wall=16192, train_wall=330138
Invalid bert_input shape:torch.Size([4, 1167])
| epoch 069:  30000 / 49553 loss=4.041, nll_loss=2.394, ppl=5.26, wps=57393, ups=6, wpb=10105.524, bsz=617.526, num_updates=89964, lr=0.00010543, gnorm=0.837, clip=0.000, oom=0.000, loss_scale=2.000, wall=16366, train_wall=330293
| epoch 069:  31000 / 49553 loss=4.040, nll_loss=2.393, ppl=5.25, wps=57390, ups=6, wpb=10104.029, bsz=617.806, num_updates=90964, lr=0.000104849, gnorm=0.836, clip=0.000, oom=0.000, loss_scale=2.000, wall=16542, train_wall=330450
| epoch 069:  32000 / 49553 loss=4.040, nll_loss=2.392, ppl=5.25, wps=57396, ups=6, wpb=10101.761, bsz=618.307, num_updates=91964, lr=0.000104278, gnorm=0.836, clip=0.000, oom=0.000, loss_scale=4.000, wall=16716, train_wall=330605
Invalid bert_input shape:torch.Size([4, 721])
| epoch 069:  33000 / 49553 loss=4.040, nll_loss=2.392, ppl=5.25, wps=57427, ups=6, wpb=10103.227, bsz=618.443, num_updates=92964, lr=0.000103715, gnorm=0.835, clip=0.000, oom=0.000, loss_scale=4.000, wall=16890, train_wall=330760
| epoch 069:  34000 / 49553 loss=4.039, nll_loss=2.392, ppl=5.25, wps=57428, ups=6, wpb=10102.139, bsz=618.244, num_updates=93964, lr=0.000103162, gnorm=0.835, clip=0.000, oom=0.000, loss_scale=4.000, wall=17065, train_wall=330918
| epoch 069:  35000 / 49553 loss=4.039, nll_loss=2.391, ppl=5.25, wps=57441, ups=6, wpb=10102.631, bsz=617.905, num_updates=94964, lr=0.000102617, gnorm=0.835, clip=0.000, oom=0.000, loss_scale=4.000, wall=17240, train_wall=331076
| epoch 069:  36000 / 49553 loss=4.038, nll_loss=2.391, ppl=5.24, wps=57461, ups=6, wpb=10102.856, bsz=617.954, num_updates=95964, lr=0.000102081, gnorm=0.834, clip=0.000, oom=0.000, loss_scale=8.000, wall=17414, train_wall=331231
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([5, 994])
| epoch 069:  37000 / 49553 loss=4.038, nll_loss=2.390, ppl=5.24, wps=57460, ups=6, wpb=10102.247, bsz=617.978, num_updates=96963, lr=0.000101554, gnorm=0.834, clip=0.000, oom=0.000, loss_scale=4.000, wall=17589, train_wall=331389
| epoch 069:  38000 / 49553 loss=4.037, nll_loss=2.390, ppl=5.24, wps=57471, ups=6, wpb=10101.361, bsz=617.953, num_updates=97963, lr=0.000101034, gnorm=0.833, clip=0.000, oom=0.000, loss_scale=4.000, wall=17763, train_wall=331544
| epoch 069:  39000 / 49553 loss=4.037, nll_loss=2.389, ppl=5.24, wps=57490, ups=6, wpb=10101.894, bsz=618.052, num_updates=98963, lr=0.000100523, gnorm=0.833, clip=0.000, oom=0.000, loss_scale=4.000, wall=17937, train_wall=331700
Invalid bert_input shape:torch.Size([4, 720])
Invalid bert_input shape:torch.Size([5, 656])
| epoch 069:  40000 / 49553 loss=4.036, nll_loss=2.388, ppl=5.23, wps=57489, ups=6, wpb=10102.935, bsz=618.057, num_updates=99963, lr=0.000100019, gnorm=0.832, clip=0.000, oom=0.000, loss_scale=4.000, wall=18113, train_wall=331858
Invalid bert_input shape:torch.Size([8, 844])
| epoch 069:  41000 / 49553 loss=4.035, nll_loss=2.387, ppl=5.23, wps=57502, ups=6, wpb=10102.660, bsz=618.495, num_updates=100963, lr=9.95219e-05, gnorm=0.831, clip=0.000, oom=0.000, loss_scale=8.000, wall=18287, train_wall=332014
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 069:  42000 / 49553 loss=4.034, nll_loss=2.386, ppl=5.23, wps=57516, ups=6, wpb=10102.427, bsz=618.832, num_updates=101962, lr=9.90332e-05, gnorm=0.831, clip=0.000, oom=0.000, loss_scale=4.000, wall=18461, train_wall=332169
| epoch 069:  43000 / 49553 loss=4.034, nll_loss=2.386, ppl=5.23, wps=57519, ups=6, wpb=10103.153, bsz=618.796, num_updates=102962, lr=9.85511e-05, gnorm=0.831, clip=0.000, oom=0.000, loss_scale=4.000, wall=18637, train_wall=332326
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 069:  44000 / 49553 loss=4.034, nll_loss=2.386, ppl=5.23, wps=57511, ups=6, wpb=10104.709, bsz=618.608, num_updates=103961, lr=9.80765e-05, gnorm=0.830, clip=0.000, oom=0.000, loss_scale=2.000, wall=18814, train_wall=332486
Invalid bert_input shape:torch.Size([5, 614])
Invalid bert_input shape:torch.Size([6, 863])
| epoch 069:  45000 / 49553 loss=4.034, nll_loss=2.386, ppl=5.23, wps=57491, ups=6, wpb=10102.895, bsz=618.756, num_updates=104961, lr=9.76081e-05, gnorm=0.830, clip=0.000, oom=0.000, loss_scale=2.000, wall=18991, train_wall=332646
Invalid bert_input shape:torch.Size([5, 638])
| epoch 069:  46000 / 49553 loss=4.033, nll_loss=2.385, ppl=5.22, wps=57480, ups=6, wpb=10101.520, bsz=618.571, num_updates=105961, lr=9.71465e-05, gnorm=0.830, clip=0.000, oom=0.000, loss_scale=2.000, wall=19168, train_wall=332804
| epoch 069:  47000 / 49553 loss=4.032, nll_loss=2.384, ppl=5.22, wps=57486, ups=6, wpb=10101.937, bsz=618.492, num_updates=106961, lr=9.66913e-05, gnorm=0.829, clip=0.000, oom=0.000, loss_scale=2.000, wall=19343, train_wall=332961
Invalid bert_input shape:torch.Size([5, 636])
Invalid bert_input shape:torch.Size([3, 944])
| epoch 069:  48000 / 49553 loss=4.031, nll_loss=2.383, ppl=5.22, wps=57486, ups=6, wpb=10101.031, bsz=618.496, num_updates=107961, lr=9.62424e-05, gnorm=0.829, clip=0.000, oom=0.000, loss_scale=2.000, wall=19518, train_wall=333119
Invalid bert_input shape:torch.Size([5, 729])
| epoch 069:  49000 / 49553 loss=4.031, nll_loss=2.383, ppl=5.22, wps=57483, ups=6, wpb=10101.234, bsz=618.633, num_updates=108961, lr=9.57998e-05, gnorm=0.828, clip=0.000, oom=0.000, loss_scale=4.000, wall=19694, train_wall=333276
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 069 | loss 4.030 | nll_loss 2.382 | ppl 5.21 | wps 57477 | ups 6 | wpb 10099.914 | bsz 618.716 | num_updates 109512 | lr 9.55585e-05 | gnorm 0.828 | clip 0.000 | oom 0.000 | loss_scale 2.000 | wall 19791 | train_wall 333361
| epoch 069 | valid on 'valid' subset | loss 2.802 | nll_loss 0.986 | ppl 1.98 | num_updates 109512 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint69.pt (epoch 69 @ 109512 updates) (writing took 6.926485538482666 seconds)
| epoch 070:   1000 / 49553 loss=3.991, nll_loss=2.339, ppl=5.06, wps=57970, ups=3, wpb=10063.826, bsz=612.723, num_updates=110513, lr=9.51247e-05, gnorm=0.816, clip=0.000, oom=0.000, loss_scale=2.000, wall=20097, train_wall=333520
| epoch 070:   2000 / 49553 loss=3.985, nll_loss=2.332, ppl=5.03, wps=57740, ups=4, wpb=10113.600, bsz=615.088, num_updates=111513, lr=9.46972e-05, gnorm=0.808, clip=0.000, oom=0.000, loss_scale=2.000, wall=20274, train_wall=333678
| epoch 070:   3000 / 49553 loss=3.984, nll_loss=2.331, ppl=5.03, wps=57624, ups=5, wpb=10129.424, bsz=615.867, num_updates=112513, lr=9.42755e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=2.000, wall=20451, train_wall=333838
| epoch 070:   4000 / 49553 loss=3.978, nll_loss=2.325, ppl=5.01, wps=57709, ups=5, wpb=10127.239, bsz=617.370, num_updates=113513, lr=9.38593e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=20625, train_wall=333994
| epoch 070:   5000 / 49553 loss=3.980, nll_loss=2.326, ppl=5.01, wps=57505, ups=5, wpb=10121.007, bsz=618.318, num_updates=114513, lr=9.34486e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=4.000, wall=20804, train_wall=334155
Invalid bert_input shape:torch.Size([7, 790])
| epoch 070:   6000 / 49553 loss=3.980, nll_loss=2.327, ppl=5.02, wps=57542, ups=5, wpb=10113.048, bsz=618.139, num_updates=115513, lr=9.30432e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=20978, train_wall=334312
| epoch 070:   7000 / 49553 loss=3.981, nll_loss=2.327, ppl=5.02, wps=57573, ups=5, wpb=10112.734, bsz=619.148, num_updates=116513, lr=9.2643e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=21153, train_wall=334469
| epoch 070:   8000 / 49553 loss=3.982, nll_loss=2.328, ppl=5.02, wps=57566, ups=5, wpb=10114.051, bsz=619.673, num_updates=117513, lr=9.2248e-05, gnorm=0.808, clip=0.000, oom=0.000, loss_scale=8.000, wall=21329, train_wall=334626
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 070:   9000 / 49553 loss=3.984, nll_loss=2.331, ppl=5.03, wps=57505, ups=5, wpb=10111.483, bsz=618.228, num_updates=118512, lr=9.18584e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=21506, train_wall=334778
| epoch 070:  10000 / 49553 loss=3.982, nll_loss=2.329, ppl=5.02, wps=57446, ups=5, wpb=10105.052, bsz=619.059, num_updates=119512, lr=9.14733e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=21682, train_wall=334931
Invalid bert_input shape:torch.Size([4, 864])
| epoch 070:  11000 / 49553 loss=3.981, nll_loss=2.328, ppl=5.02, wps=57438, ups=5, wpb=10103.191, bsz=620.109, num_updates=120512, lr=9.1093e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=21858, train_wall=335089
Invalid bert_input shape:torch.Size([2, 1203])
| epoch 070:  12000 / 49553 loss=3.982, nll_loss=2.329, ppl=5.03, wps=57475, ups=5, wpb=10097.329, bsz=620.156, num_updates=121512, lr=9.07174e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=4.000, wall=22032, train_wall=335244
Invalid bert_input shape:torch.Size([4, 858])
| epoch 070:  13000 / 49553 loss=3.984, nll_loss=2.331, ppl=5.03, wps=57504, ups=5, wpb=10096.746, bsz=620.771, num_updates=122512, lr=9.03464e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=8.000, wall=22206, train_wall=335400
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 070:  14000 / 49553 loss=3.983, nll_loss=2.330, ppl=5.03, wps=57552, ups=5, wpb=10101.733, bsz=619.527, num_updates=123511, lr=8.99802e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=4.000, wall=22380, train_wall=335556
Invalid bert_input shape:torch.Size([6, 595])
| epoch 070:  15000 / 49553 loss=3.983, nll_loss=2.331, ppl=5.03, wps=57564, ups=5, wpb=10099.075, bsz=618.710, num_updates=124511, lr=8.96182e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=4.000, wall=22555, train_wall=335710
Invalid bert_input shape:torch.Size([8, 1356])
| epoch 070:  16000 / 49553 loss=3.983, nll_loss=2.330, ppl=5.03, wps=57487, ups=5, wpb=10095.556, bsz=619.379, num_updates=125511, lr=8.92605e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=4.000, wall=22733, train_wall=335866
Invalid bert_input shape:torch.Size([6, 547])
| epoch 070:  17000 / 49553 loss=3.981, nll_loss=2.328, ppl=5.02, wps=57425, ups=5, wpb=10094.226, bsz=619.600, num_updates=126511, lr=8.8907e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=4.000, wall=22911, train_wall=336021
| epoch 070:  18000 / 49553 loss=3.981, nll_loss=2.329, ppl=5.02, wps=57388, ups=5, wpb=10091.558, bsz=619.646, num_updates=127511, lr=8.85577e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=8.000, wall=23088, train_wall=336172
Invalid bert_input shape:torch.Size([4, 843])
| epoch 070:  19000 / 49553 loss=3.980, nll_loss=2.327, ppl=5.02, wps=57396, ups=5, wpb=10094.187, bsz=619.742, num_updates=128511, lr=8.82124e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=8.000, wall=23265, train_wall=336325
| epoch 070:  20000 / 49553 loss=3.980, nll_loss=2.327, ppl=5.02, wps=57428, ups=5, wpb=10097.376, bsz=619.903, num_updates=129511, lr=8.78712e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=8.000, wall=23440, train_wall=336483
| epoch 070:  21000 / 49553 loss=3.979, nll_loss=2.326, ppl=5.01, wps=57456, ups=5, wpb=10098.209, bsz=620.363, num_updates=130511, lr=8.75339e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=8.000, wall=23614, train_wall=336638
Invalid bert_input shape:torch.Size([7, 900])
| epoch 070:  22000 / 49553 loss=3.979, nll_loss=2.326, ppl=5.01, wps=57436, ups=6, wpb=10095.036, bsz=619.983, num_updates=131511, lr=8.72005e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=16.000, wall=23790, train_wall=336795
| WARNING: overflow detected, setting loss scale to: 8.0
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 070:  23000 / 49553 loss=3.978, nll_loss=2.325, ppl=5.01, wps=57411, ups=6, wpb=10097.613, bsz=620.153, num_updates=132509, lr=8.68715e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=23968, train_wall=336955
Invalid bert_input shape:torch.Size([4, 760])
Invalid bert_input shape:torch.Size([6, 1334])
| epoch 070:  24000 / 49553 loss=3.979, nll_loss=2.326, ppl=5.01, wps=57390, ups=6, wpb=10099.421, bsz=619.835, num_updates=133509, lr=8.65455e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=24146, train_wall=337115
| epoch 070:  25000 / 49553 loss=3.979, nll_loss=2.326, ppl=5.01, wps=57408, ups=6, wpb=10101.600, bsz=619.571, num_updates=134509, lr=8.62232e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=24322, train_wall=337272
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 070:  26000 / 49553 loss=3.979, nll_loss=2.326, ppl=5.02, wps=57410, ups=6, wpb=10100.629, bsz=620.024, num_updates=135508, lr=8.59048e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=2.000, wall=24497, train_wall=337430
| epoch 070:  27000 / 49553 loss=3.979, nll_loss=2.326, ppl=5.02, wps=57425, ups=6, wpb=10099.638, bsz=619.764, num_updates=136508, lr=8.55896e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=2.000, wall=24671, train_wall=337586
| epoch 070:  28000 / 49553 loss=3.979, nll_loss=2.326, ppl=5.02, wps=57443, ups=6, wpb=10098.981, bsz=619.636, num_updates=137508, lr=8.52778e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=2.000, wall=24845, train_wall=337741
| epoch 070:  29000 / 49553 loss=3.980, nll_loss=2.327, ppl=5.02, wps=57457, ups=6, wpb=10099.006, bsz=619.565, num_updates=138508, lr=8.49694e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=2.000, wall=25020, train_wall=337898
Invalid bert_input shape:torch.Size([5, 817])
Invalid bert_input shape:torch.Size([5, 638])
| epoch 070:  30000 / 49553 loss=3.980, nll_loss=2.327, ppl=5.02, wps=57473, ups=6, wpb=10099.616, bsz=620.089, num_updates=139508, lr=8.46643e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=2.000, wall=25194, train_wall=338054
Invalid bert_input shape:torch.Size([6, 784])
| epoch 070:  31000 / 49553 loss=3.980, nll_loss=2.327, ppl=5.02, wps=57487, ups=6, wpb=10101.105, bsz=620.074, num_updates=140508, lr=8.43625e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=25370, train_wall=338211
| epoch 070:  32000 / 49553 loss=3.979, nll_loss=2.326, ppl=5.01, wps=57514, ups=6, wpb=10103.011, bsz=619.656, num_updates=141508, lr=8.40639e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=25544, train_wall=338368
| epoch 070:  33000 / 49553 loss=3.979, nll_loss=2.326, ppl=5.01, wps=57531, ups=6, wpb=10104.782, bsz=619.562, num_updates=142508, lr=8.37684e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=25719, train_wall=338525
| epoch 070:  34000 / 49553 loss=3.978, nll_loss=2.325, ppl=5.01, wps=57537, ups=6, wpb=10103.725, bsz=619.495, num_updates=143508, lr=8.34761e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=25893, train_wall=338682
| epoch 070:  35000 / 49553 loss=3.978, nll_loss=2.325, ppl=5.01, wps=57559, ups=6, wpb=10105.340, bsz=619.454, num_updates=144508, lr=8.31867e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=8.000, wall=26067, train_wall=338839
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 070:  36000 / 49553 loss=3.978, nll_loss=2.325, ppl=5.01, wps=57558, ups=6, wpb=10104.250, bsz=619.783, num_updates=145507, lr=8.29007e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=26242, train_wall=338996
| epoch 070:  37000 / 49553 loss=3.978, nll_loss=2.325, ppl=5.01, wps=57560, ups=6, wpb=10102.858, bsz=619.680, num_updates=146507, lr=8.26173e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=26417, train_wall=339153
| epoch 070:  38000 / 49553 loss=3.978, nll_loss=2.325, ppl=5.01, wps=57562, ups=6, wpb=10100.423, bsz=619.715, num_updates=147507, lr=8.23367e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=26590, train_wall=339309
| epoch 070:  39000 / 49553 loss=3.977, nll_loss=2.324, ppl=5.01, wps=57563, ups=6, wpb=10099.118, bsz=619.387, num_updates=148507, lr=8.20591e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=26765, train_wall=339465
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 070:  40000 / 49553 loss=3.977, nll_loss=2.324, ppl=5.01, wps=57570, ups=6, wpb=10099.019, bsz=619.440, num_updates=149506, lr=8.17844e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=26939, train_wall=339622
| epoch 070 | loss 3.977 | nll_loss 2.324 | ppl 5.01 | wps 57570 | ups 6 | wpb 10099.974 | bsz 619.445 | num_updates 150000 | lr 8.16497e-05 | gnorm 0.808 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 27027 | train_wall 339700
| epoch 070 | valid on 'valid' subset | loss 2.800 | nll_loss 0.983 | ppl 1.98 | num_updates 150000 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint_last.pt (epoch 70 @ 150000 updates) (writing took 4.650139093399048 seconds)
| done training in 26746.5 seconds
| distributed init (rank 3): tcp://localhost:14394
| distributed init (rank 1): tcp://localhost:14394
| distributed init (rank 2): tcp://localhost:14394
| distributed init (rank 0): tcp://localhost:14394
| initialized host r13g04.bullx as rank 3
| initialized host r13g04.bullx as rank 2
| initialized host r13g04.bullx as rank 0
| initialized host r13g04.bullx as rank 1
Namespace(activation_dropout=0.0, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, arch='transformer_vaswani_wmt_en_de_big', attention_dropout=0.0, bert_first=True, bert_gates=[1, 1, 1, 1, 1, 1], bert_model_name='/scratch/project_2003453/bert-base-finnish-uncased-v1', bert_output_layer=-1, bert_ratio=1.0, bucket_cap_mb=25, clip_norm=25, cpu=False, criterion='label_smoothed_cross_entropy', curriculum=0, data='/scratch/project_2003453/bertnmt_data', dataset_impl='cached', ddp_backend='c10d', decoder_attention_heads=16, decoder_embed_dim=1024, decoder_embed_path=None, decoder_ffn_embed_dim=4096, decoder_input_dim=1024, decoder_layers=6, decoder_learned_pos=False, decoder_no_bert=False, decoder_normalize_before=False, decoder_output_dim=1024, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method='tcp://localhost:14394', distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=4, dropout=0.3, encoder_attention_heads=16, encoder_bert_dropout=True, encoder_bert_dropout_ratio=0.5, encoder_bert_mixup=False, encoder_embed_dim=1024, encoder_embed_path=None, encoder_ffn_embed_dim=4096, encoder_layers=6, encoder_learned_pos=False, encoder_normalize_before=False, encoder_ratio=1.0, find_unused_parameters=False, finetune_bert=False, fix_batches_to_gpus=False, fp16=True, fp16_init_scale=128, fp16_scale_tolerance=0.0, fp16_scale_window=None, keep_interval_updates=-1, keep_last_epochs=-1, label_smoothing=0.1, lazy_load=False, left_pad_source='True', left_pad_target='False', log_format=None, log_interval=1000, lr=[0.0005], lr_scheduler='inverse_sqrt', mask_cls_sep=False, max_epoch=0, max_sentences=None, max_sentences_valid=None, max_source_positions=1024, max_target_positions=1024, max_tokens=3584, max_update=0, memory_efficient_fp16=False, min_loss_scale=0.0001, min_lr=1e-09, no_epoch_checkpoints=False, no_progress_bar=False, no_save=False, no_token_positional_embeddings=False, num_workers=0, optimizer='adam', optimizer_overrides='{}', raw_text=False, required_batch_size_multiple=8, reset_dataloader=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='/scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv', save_interval=1, save_interval_updates=0, seed=1, sentence_avg=False, share_all_embeddings=True, share_decoder_input_output_embed=False, skip_invalid_size_inputs_valid_test=False, source_lang='fi', target_lang='sv', task='translation', tbmf_wrapper=False, tensorboard_logdir='', threshold_loss_scale=None, train_subset='train', update_freq=[1], upsample_primary=1, user_dir=None, valid_subset='valid', validate_interval=1, warmup_from_nmt=False, warmup_init_lr=1e-07, warmup_nmt_file='checkpoint_nmt.pt', warmup_updates=4000, weight_decay=0.0001)
| [fi] dictionary: 37752 types
| [sv] dictionary: 37752 types
| /scratch/project_2003453/bertnmt_data valid fi-sv 5000 examples
bert_gates [True, True, True, True, True, True]
TransformerModel(
  (encoder): TransformerEncoder(
    (embed_tokens): Embedding(37752, 1024, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (decoder): TransformerDecoder(
    (embed_tokens): Embedding(37752, 1024, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (4): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (5): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (bert_encoder): BertModel(
    (embeddings): BertEmbeddings(
      (word_embeddings): Embedding(50101, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): BertEncoder(
      (layer): ModuleList(
        (0): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
)
| model transformer_vaswani_wmt_en_de_big, criterion LabelSmoothedCrossEntropyCriterion
| num. model params: 361579008 (num. trained: 237060096)
| training on 4 GPUs
| max tokens per GPU = 3584 and max sentences per GPU = None
| loaded checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint_last.pt (epoch 70 @ 150000 updates)
| loading train data for epoch 70
| /scratch/project_2003453/bertnmt_data train fi-sv 30659795 examples
| epoch 070:  41000 / 49553 loss=3.968, nll_loss=2.314, ppl=4.97, wps=13164, ups=1, wpb=10221.605, bsz=599.381, num_updates=150506, lr=8.15123e-05, gnorm=0.794, clip=0.000, oom=0.000, loss_scale=4.000, wall=393, train_wall=339791
| epoch 070:  42000 / 49553 loss=3.972, nll_loss=2.319, ppl=4.99, wps=26841, ups=3, wpb=10155.972, bsz=614.746, num_updates=151506, lr=8.12428e-05, gnorm=0.799, clip=0.000, oom=0.000, loss_scale=4.000, wall=570, train_wall=339949
Invalid bert_input shape:torch.Size([6, 896])
| epoch 070:  43000 / 49553 loss=3.967, nll_loss=2.313, ppl=4.97, wps=34035, ups=3, wpb=10121.928, bsz=614.263, num_updates=152506, lr=8.0976e-05, gnorm=0.804, clip=0.000, oom=0.000, loss_scale=4.000, wall=745, train_wall=340106
| epoch 070:  44000 / 49553 loss=3.965, nll_loss=2.311, ppl=4.96, wps=38373, ups=4, wpb=10110.233, bsz=612.380, num_updates=153506, lr=8.07119e-05, gnorm=0.803, clip=0.000, oom=0.000, loss_scale=4.000, wall=924, train_wall=340265
| epoch 070:  45000 / 49553 loss=3.970, nll_loss=2.317, ppl=4.98, wps=41472, ups=4, wpb=10111.301, bsz=614.193, num_updates=154506, lr=8.04502e-05, gnorm=0.804, clip=0.000, oom=0.000, loss_scale=8.000, wall=1099, train_wall=340422
Invalid bert_input shape:torch.Size([5, 729])
| epoch 070:  46000 / 49553 loss=3.971, nll_loss=2.318, ppl=4.99, wps=43592, ups=4, wpb=10103.483, bsz=613.595, num_updates=155506, lr=8.01911e-05, gnorm=0.805, clip=0.000, oom=0.000, loss_scale=8.000, wall=1276, train_wall=340582
Invalid bert_input shape:torch.Size([4, 758])
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 070:  47000 / 49553 loss=3.970, nll_loss=2.317, ppl=4.98, wps=45221, ups=4, wpb=10104.074, bsz=614.771, num_updates=156505, lr=7.99348e-05, gnorm=0.805, clip=0.000, oom=0.000, loss_scale=4.000, wall=1453, train_wall=340740
Invalid bert_input shape:torch.Size([2, 1608])
Invalid bert_input shape:torch.Size([6, 575])
Invalid bert_input shape:torch.Size([2, 1562])
Invalid bert_input shape:torch.Size([2, 1513])
Invalid bert_input shape:torch.Size([3, 1160])
| epoch 070:  48000 / 49553 loss=3.970, nll_loss=2.317, ppl=4.98, wps=46545, ups=5, wpb=10097.224, bsz=615.211, num_updates=157505, lr=7.96806e-05, gnorm=0.806, clip=0.000, oom=0.000, loss_scale=4.000, wall=1628, train_wall=340896
| epoch 070:  49000 / 49553 loss=3.971, nll_loss=2.318, ppl=4.99, wps=47597, ups=5, wpb=10100.492, bsz=614.573, num_updates=158505, lr=7.94289e-05, gnorm=0.805, clip=0.000, oom=0.000, loss_scale=4.000, wall=1805, train_wall=341054
| epoch 070 | loss 3.971 | nll_loss 2.318 | ppl 4.99 | wps 48052 | ups 5 | wpb 10100.875 | bsz 615.216 | num_updates 159057 | lr 7.92909e-05 | gnorm 0.806 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 1904 | train_wall 341143
| epoch 070 | valid on 'valid' subset | loss 2.793 | nll_loss 0.971 | ppl 1.96 | num_updates 159057 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint70.pt (epoch 70 @ 159057 updates) (writing took 6.996211767196655 seconds)
Invalid bert_input shape:torch.Size([4, 859])
| epoch 071:   1000 / 49553 loss=3.924, nll_loss=2.265, ppl=4.81, wps=57402, ups=3, wpb=10071.802, bsz=624.281, num_updates=160058, lr=7.90426e-05, gnorm=0.796, clip=0.000, oom=0.000, loss_scale=8.000, wall=2216, train_wall=341301
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([5, 729])
| epoch 071:   2000 / 49553 loss=3.936, nll_loss=2.279, ppl=4.85, wps=57216, ups=4, wpb=10077.652, bsz=629.061, num_updates=161057, lr=7.87971e-05, gnorm=0.799, clip=0.000, oom=0.000, loss_scale=4.000, wall=2392, train_wall=341454
| epoch 071:   3000 / 49553 loss=3.941, nll_loss=2.284, ppl=4.87, wps=57168, ups=5, wpb=10093.984, bsz=624.841, num_updates=162057, lr=7.85536e-05, gnorm=0.800, clip=0.000, oom=0.000, loss_scale=4.000, wall=2570, train_wall=341611
| epoch 071:   4000 / 49553 loss=3.944, nll_loss=2.287, ppl=4.88, wps=57455, ups=5, wpb=10110.940, bsz=622.307, num_updates=163057, lr=7.83124e-05, gnorm=0.802, clip=0.000, oom=0.000, loss_scale=4.000, wall=2744, train_wall=341767
| epoch 071:   5000 / 49553 loss=3.944, nll_loss=2.287, ppl=4.88, wps=57545, ups=5, wpb=10104.562, bsz=620.141, num_updates=164057, lr=7.80733e-05, gnorm=0.802, clip=0.000, oom=0.000, loss_scale=4.000, wall=2918, train_wall=341923
Invalid bert_input shape:torch.Size([6, 555])
| epoch 071:   6000 / 49553 loss=3.947, nll_loss=2.291, ppl=4.89, wps=57524, ups=5, wpb=10107.920, bsz=619.851, num_updates=165057, lr=7.78365e-05, gnorm=0.803, clip=0.000, oom=0.000, loss_scale=8.000, wall=3094, train_wall=342079
Invalid bert_input shape:torch.Size([5, 655])
| epoch 071:   7000 / 49553 loss=3.948, nll_loss=2.292, ppl=4.90, wps=57618, ups=5, wpb=10117.923, bsz=619.806, num_updates=166057, lr=7.76017e-05, gnorm=0.803, clip=0.000, oom=0.000, loss_scale=8.000, wall=3269, train_wall=342236
| epoch 071:   8000 / 49553 loss=3.948, nll_loss=2.292, ppl=4.90, wps=57635, ups=5, wpb=10117.403, bsz=619.542, num_updates=167057, lr=7.73691e-05, gnorm=0.803, clip=0.000, oom=0.000, loss_scale=8.000, wall=3444, train_wall=342392
Invalid bert_input shape:torch.Size([5, 656])
| WARNING: overflow detected, setting loss scale to: 4.0
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 071:   9000 / 49553 loss=3.949, nll_loss=2.293, ppl=4.90, wps=57612, ups=5, wpb=10123.799, bsz=619.359, num_updates=168055, lr=7.7139e-05, gnorm=0.803, clip=0.000, oom=0.000, loss_scale=2.000, wall=3621, train_wall=342550
Invalid bert_input shape:torch.Size([5, 869])
| WARNING: overflow detected, setting loss scale to: 1.0
| epoch 071:  10000 / 49553 loss=3.950, nll_loss=2.294, ppl=4.90, wps=57616, ups=5, wpb=10116.334, bsz=619.922, num_updates=169054, lr=7.69108e-05, gnorm=0.804, clip=0.000, oom=0.000, loss_scale=1.000, wall=3795, train_wall=342706
| epoch 071:  11000 / 49553 loss=3.950, nll_loss=2.294, ppl=4.90, wps=57669, ups=5, wpb=10119.079, bsz=619.358, num_updates=170054, lr=7.66843e-05, gnorm=0.804, clip=0.000, oom=0.000, loss_scale=1.000, wall=3970, train_wall=342862
Invalid bert_input shape:torch.Size([4, 782])
| epoch 071:  12000 / 49553 loss=3.949, nll_loss=2.293, ppl=4.90, wps=57636, ups=5, wpb=10117.350, bsz=619.503, num_updates=171054, lr=7.64598e-05, gnorm=0.804, clip=0.000, oom=0.000, loss_scale=1.000, wall=4146, train_wall=343020
| epoch 071:  13000 / 49553 loss=3.948, nll_loss=2.292, ppl=4.90, wps=57606, ups=5, wpb=10110.334, bsz=618.921, num_updates=172054, lr=7.62373e-05, gnorm=0.804, clip=0.000, oom=0.000, loss_scale=1.000, wall=4321, train_wall=343176
| epoch 071:  14000 / 49553 loss=3.948, nll_loss=2.292, ppl=4.90, wps=57611, ups=5, wpb=10111.387, bsz=619.386, num_updates=173054, lr=7.60167e-05, gnorm=0.805, clip=0.000, oom=0.000, loss_scale=2.000, wall=4497, train_wall=343333
| epoch 071:  15000 / 49553 loss=3.947, nll_loss=2.291, ppl=4.89, wps=57527, ups=5, wpb=10108.601, bsz=619.033, num_updates=174054, lr=7.5798e-05, gnorm=0.805, clip=0.000, oom=0.000, loss_scale=2.000, wall=4675, train_wall=343488
Invalid bert_input shape:torch.Size([6, 566])
| epoch 071:  16000 / 49553 loss=3.948, nll_loss=2.291, ppl=4.90, wps=57462, ups=5, wpb=10103.732, bsz=618.526, num_updates=175054, lr=7.55812e-05, gnorm=0.806, clip=0.000, oom=0.000, loss_scale=2.000, wall=4853, train_wall=343646
| epoch 071:  17000 / 49553 loss=3.948, nll_loss=2.292, ppl=4.90, wps=57492, ups=5, wpb=10103.374, bsz=619.246, num_updates=176054, lr=7.53663e-05, gnorm=0.806, clip=0.000, oom=0.000, loss_scale=2.000, wall=5027, train_wall=343802
Invalid bert_input shape:torch.Size([5, 795])
| epoch 071:  18000 / 49553 loss=3.947, nll_loss=2.290, ppl=4.89, wps=57477, ups=5, wpb=10101.851, bsz=618.640, num_updates=177054, lr=7.51531e-05, gnorm=0.806, clip=0.000, oom=0.000, loss_scale=4.000, wall=5203, train_wall=343959
| epoch 071:  19000 / 49553 loss=3.947, nll_loss=2.291, ppl=4.89, wps=57434, ups=5, wpb=10100.341, bsz=618.920, num_updates=178054, lr=7.49418e-05, gnorm=0.806, clip=0.000, oom=0.000, loss_scale=4.000, wall=5381, train_wall=344118
| epoch 071:  20000 / 49553 loss=3.947, nll_loss=2.291, ppl=4.89, wps=57375, ups=5, wpb=10099.223, bsz=618.885, num_updates=179054, lr=7.47322e-05, gnorm=0.806, clip=0.000, oom=0.000, loss_scale=4.000, wall=5560, train_wall=344279
Invalid bert_input shape:torch.Size([5, 692])
| epoch 071:  21000 / 49553 loss=3.947, nll_loss=2.291, ppl=4.90, wps=57385, ups=5, wpb=10100.576, bsz=619.049, num_updates=180054, lr=7.45244e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=4.000, wall=5736, train_wall=344437
| epoch 071:  22000 / 49553 loss=3.947, nll_loss=2.291, ppl=4.89, wps=57412, ups=5, wpb=10099.905, bsz=619.132, num_updates=181054, lr=7.43183e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=8.000, wall=5910, train_wall=344593
Invalid bert_input shape:torch.Size([4, 823])
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 071:  23000 / 49553 loss=3.946, nll_loss=2.290, ppl=4.89, wps=57421, ups=5, wpb=10100.755, bsz=619.038, num_updates=182053, lr=7.41141e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=4.000, wall=6085, train_wall=344750
| epoch 071:  24000 / 49553 loss=3.947, nll_loss=2.291, ppl=4.89, wps=57421, ups=6, wpb=10100.381, bsz=619.785, num_updates=183053, lr=7.39114e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=4.000, wall=6261, train_wall=344908
| epoch 071:  25000 / 49553 loss=3.946, nll_loss=2.290, ppl=4.89, wps=57447, ups=6, wpb=10101.089, bsz=619.751, num_updates=184053, lr=7.37104e-05, gnorm=0.806, clip=0.000, oom=0.000, loss_scale=4.000, wall=6435, train_wall=345063
Invalid bert_input shape:torch.Size([6, 784])
| epoch 071:  26000 / 49553 loss=3.947, nll_loss=2.291, ppl=4.89, wps=57433, ups=6, wpb=10100.549, bsz=619.755, num_updates=185053, lr=7.35109e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=4.000, wall=6612, train_wall=345220
| epoch 071:  27000 / 49553 loss=3.946, nll_loss=2.290, ppl=4.89, wps=57447, ups=6, wpb=10100.729, bsz=619.716, num_updates=186053, lr=7.33131e-05, gnorm=0.806, clip=0.000, oom=0.000, loss_scale=8.000, wall=6787, train_wall=345377
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 071:  28000 / 49553 loss=3.946, nll_loss=2.290, ppl=4.89, wps=57455, ups=6, wpb=10099.580, bsz=619.349, num_updates=187052, lr=7.31171e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=4.000, wall=6961, train_wall=345533
| epoch 071:  29000 / 49553 loss=3.946, nll_loss=2.290, ppl=4.89, wps=57435, ups=6, wpb=10096.854, bsz=619.778, num_updates=188052, lr=7.29224e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=4.000, wall=7137, train_wall=345689
| epoch 071:  30000 / 49553 loss=3.946, nll_loss=2.290, ppl=4.89, wps=57435, ups=6, wpb=10094.370, bsz=619.283, num_updates=189052, lr=7.27293e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=4.000, wall=7312, train_wall=345846
| epoch 071:  31000 / 49553 loss=3.946, nll_loss=2.290, ppl=4.89, wps=57456, ups=6, wpb=10095.655, bsz=619.332, num_updates=190052, lr=7.25377e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=4.000, wall=7486, train_wall=346002
Invalid bert_input shape:torch.Size([5, 950])
| epoch 071:  32000 / 49553 loss=3.946, nll_loss=2.291, ppl=4.89, wps=57449, ups=6, wpb=10096.386, bsz=619.425, num_updates=191052, lr=7.23476e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=8.000, wall=7663, train_wall=346160
| epoch 071:  33000 / 49553 loss=3.946, nll_loss=2.290, ppl=4.89, wps=57460, ups=6, wpb=10096.954, bsz=619.239, num_updates=192052, lr=7.2159e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=8.000, wall=7838, train_wall=346316
| epoch 071:  34000 / 49553 loss=3.947, nll_loss=2.291, ppl=4.89, wps=57483, ups=6, wpb=10098.257, bsz=619.252, num_updates=193052, lr=7.19719e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=8.000, wall=8012, train_wall=346472
| epoch 071:  35000 / 49553 loss=3.946, nll_loss=2.290, ppl=4.89, wps=57471, ups=6, wpb=10097.792, bsz=619.067, num_updates=194052, lr=7.17862e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=8.000, wall=8189, train_wall=346631
| epoch 071:  36000 / 49553 loss=3.947, nll_loss=2.291, ppl=4.89, wps=57494, ups=6, wpb=10100.741, bsz=619.202, num_updates=195052, lr=7.16019e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=16.000, wall=8364, train_wall=346787
Invalid bert_input shape:torch.Size([6, 575])
Invalid bert_input shape:torch.Size([4, 721])
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 071:  37000 / 49553 loss=3.946, nll_loss=2.291, ppl=4.89, wps=57488, ups=6, wpb=10100.745, bsz=619.207, num_updates=196051, lr=7.14193e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=8.000, wall=8540, train_wall=346943
| epoch 071:  38000 / 49553 loss=3.947, nll_loss=2.291, ppl=4.89, wps=57442, ups=6, wpb=10099.831, bsz=619.183, num_updates=197051, lr=7.12378e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=8.000, wall=8720, train_wall=347095
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 071:  39000 / 49553 loss=3.946, nll_loss=2.291, ppl=4.89, wps=57428, ups=6, wpb=10099.515, bsz=619.321, num_updates=198050, lr=7.10579e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=4.000, wall=8897, train_wall=347248
| epoch 071:  40000 / 49553 loss=3.947, nll_loss=2.291, ppl=4.89, wps=57433, ups=6, wpb=10099.111, bsz=619.709, num_updates=199050, lr=7.08792e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=4.000, wall=9072, train_wall=347405
Invalid bert_input shape:torch.Size([2, 1562])
| epoch 071:  41000 / 49553 loss=3.947, nll_loss=2.291, ppl=4.89, wps=57435, ups=6, wpb=10099.834, bsz=619.371, num_updates=200050, lr=7.07018e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=4.000, wall=9249, train_wall=347562
| epoch 071:  42000 / 49553 loss=3.946, nll_loss=2.290, ppl=4.89, wps=57442, ups=6, wpb=10098.813, bsz=619.196, num_updates=201050, lr=7.05258e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=4.000, wall=9423, train_wall=347719
| epoch 071:  43000 / 49553 loss=3.946, nll_loss=2.290, ppl=4.89, wps=57439, ups=6, wpb=10097.362, bsz=619.303, num_updates=202050, lr=7.0351e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=8.000, wall=9598, train_wall=347875
Invalid bert_input shape:torch.Size([6, 878])
| epoch 071:  44000 / 49553 loss=3.946, nll_loss=2.290, ppl=4.89, wps=57446, ups=6, wpb=10098.982, bsz=619.206, num_updates=203050, lr=7.01776e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=8.000, wall=9774, train_wall=348032
Invalid bert_input shape:torch.Size([3, 1184])
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 071:  45000 / 49553 loss=3.946, nll_loss=2.290, ppl=4.89, wps=57460, ups=6, wpb=10100.093, bsz=618.865, num_updates=204049, lr=7.00056e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=4.000, wall=9949, train_wall=348189
Invalid bert_input shape:torch.Size([8, 1356])
| epoch 071:  46000 / 49553 loss=3.946, nll_loss=2.290, ppl=4.89, wps=57462, ups=6, wpb=10098.819, bsz=618.695, num_updates=205049, lr=6.98347e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=4.000, wall=10123, train_wall=348345
Invalid bert_input shape:torch.Size([5, 644])
Invalid bert_input shape:torch.Size([4, 858])
| epoch 071:  47000 / 49553 loss=3.946, nll_loss=2.290, ppl=4.89, wps=57463, ups=6, wpb=10099.627, bsz=618.815, num_updates=206049, lr=6.9665e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=4.000, wall=10299, train_wall=348502
Invalid bert_input shape:torch.Size([5, 701])
| epoch 071:  48000 / 49553 loss=3.946, nll_loss=2.290, ppl=4.89, wps=57482, ups=6, wpb=10101.421, bsz=618.808, num_updates=207049, lr=6.94966e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=4.000, wall=10474, train_wall=348658
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 071:  49000 / 49553 loss=3.946, nll_loss=2.290, ppl=4.89, wps=57478, ups=6, wpb=10100.713, bsz=618.751, num_updates=208048, lr=6.93295e-05, gnorm=0.807, clip=0.000, oom=0.000, loss_scale=4.000, wall=10649, train_wall=348815
| epoch 071 | loss 3.946 | nll_loss 2.290 | ppl 4.89 | wps 57475 | ups 6 | wpb 10100.032 | bsz 618.660 | num_updates 208600 | lr 6.92377e-05 | gnorm 0.807 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 10746 | train_wall 348901
| epoch 071 | valid on 'valid' subset | loss 2.775 | nll_loss 0.953 | ppl 1.94 | num_updates 208600 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint71.pt (epoch 71 @ 208600 updates) (writing took 7.171540975570679 seconds)
| epoch 072:   1000 / 49553 loss=3.920, nll_loss=2.261, ppl=4.79, wps=56688, ups=3, wpb=10077.691, bsz=620.915, num_updates=209601, lr=6.90722e-05, gnorm=0.813, clip=0.000, oom=0.000, loss_scale=4.000, wall=11060, train_wall=349065
| epoch 072:   2000 / 49553 loss=3.924, nll_loss=2.266, ppl=4.81, wps=56991, ups=4, wpb=10066.621, bsz=620.066, num_updates=210601, lr=6.8908e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=4.000, wall=11235, train_wall=349222
| epoch 072:   3000 / 49553 loss=3.927, nll_loss=2.269, ppl=4.82, wps=56854, ups=4, wpb=10068.019, bsz=620.700, num_updates=211601, lr=6.8745e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=4.000, wall=11413, train_wall=349380
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 072:   4000 / 49553 loss=3.924, nll_loss=2.265, ppl=4.81, wps=57028, ups=5, wpb=10080.985, bsz=619.966, num_updates=212600, lr=6.85833e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=4.000, wall=11589, train_wall=349537
| epoch 072:   5000 / 49553 loss=3.927, nll_loss=2.269, ppl=4.82, wps=57241, ups=5, wpb=10097.787, bsz=617.064, num_updates=213600, lr=6.84226e-05, gnorm=0.808, clip=0.000, oom=0.000, loss_scale=4.000, wall=11764, train_wall=349694
| epoch 072:   6000 / 49553 loss=3.928, nll_loss=2.270, ppl=4.82, wps=57220, ups=5, wpb=10089.491, bsz=617.088, num_updates=214600, lr=6.8263e-05, gnorm=0.808, clip=0.000, oom=0.000, loss_scale=4.000, wall=11940, train_wall=349851
| epoch 072:   7000 / 49553 loss=3.929, nll_loss=2.271, ppl=4.83, wps=57252, ups=5, wpb=10082.401, bsz=617.426, num_updates=215600, lr=6.81045e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=4.000, wall=12115, train_wall=350007
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 072:   8000 / 49553 loss=3.929, nll_loss=2.271, ppl=4.83, wps=57229, ups=5, wpb=10076.612, bsz=616.401, num_updates=216599, lr=6.79472e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=4.000, wall=12290, train_wall=350165
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 072:   9000 / 49553 loss=3.927, nll_loss=2.269, ppl=4.82, wps=57254, ups=5, wpb=10081.245, bsz=616.990, num_updates=217598, lr=6.77911e-05, gnorm=0.809, clip=0.000, oom=0.000, loss_scale=2.000, wall=12466, train_wall=350322
| epoch 072:  10000 / 49553 loss=3.930, nll_loss=2.272, ppl=4.83, wps=57346, ups=5, wpb=10087.412, bsz=616.732, num_updates=218598, lr=6.76358e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=2.000, wall=12641, train_wall=350479
| epoch 072:  11000 / 49553 loss=3.928, nll_loss=2.270, ppl=4.82, wps=57394, ups=5, wpb=10088.558, bsz=619.151, num_updates=219598, lr=6.74817e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=2.000, wall=12815, train_wall=350635
| WARNING: overflow detected, setting loss scale to: 1.0
Invalid bert_input shape:torch.Size([3, 1160])
| epoch 072:  12000 / 49553 loss=3.928, nll_loss=2.270, ppl=4.82, wps=57430, ups=5, wpb=10098.762, bsz=618.647, num_updates=220597, lr=6.73287e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=1.000, wall=12992, train_wall=350793
| epoch 072:  13000 / 49553 loss=3.929, nll_loss=2.271, ppl=4.83, wps=57479, ups=5, wpb=10101.783, bsz=618.592, num_updates=221597, lr=6.71766e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=1.000, wall=13166, train_wall=350949
| epoch 072:  14000 / 49553 loss=3.929, nll_loss=2.272, ppl=4.83, wps=57504, ups=5, wpb=10104.915, bsz=619.279, num_updates=222597, lr=6.70255e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=1.000, wall=13342, train_wall=351106
Invalid bert_input shape:torch.Size([5, 644])
Invalid bert_input shape:torch.Size([5, 614])
| epoch 072:  15000 / 49553 loss=3.930, nll_loss=2.273, ppl=4.83, wps=57492, ups=5, wpb=10105.106, bsz=619.369, num_updates=223597, lr=6.68755e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=1.000, wall=13518, train_wall=351263
Invalid bert_input shape:torch.Size([5, 869])
Invalid bert_input shape:torch.Size([8, 844])
| epoch 072:  16000 / 49553 loss=3.930, nll_loss=2.272, ppl=4.83, wps=57517, ups=5, wpb=10103.431, bsz=618.347, num_updates=224597, lr=6.67265e-05, gnorm=0.810, clip=0.000, oom=0.000, loss_scale=2.000, wall=13692, train_wall=351420
Invalid bert_input shape:torch.Size([5, 602])
Invalid bert_input shape:torch.Size([5, 701])
| epoch 072:  17000 / 49553 loss=3.930, nll_loss=2.272, ppl=4.83, wps=57517, ups=5, wpb=10102.393, bsz=618.071, num_updates=225597, lr=6.65784e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=2.000, wall=13867, train_wall=351577
| epoch 072:  18000 / 49553 loss=3.929, nll_loss=2.272, ppl=4.83, wps=57538, ups=5, wpb=10106.493, bsz=617.775, num_updates=226597, lr=6.64313e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=2.000, wall=14043, train_wall=351733
| epoch 072:  19000 / 49553 loss=3.930, nll_loss=2.272, ppl=4.83, wps=57512, ups=5, wpb=10106.761, bsz=618.135, num_updates=227597, lr=6.62852e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=2.000, wall=14220, train_wall=351892
| epoch 072:  20000 / 49553 loss=3.930, nll_loss=2.273, ppl=4.83, wps=57519, ups=5, wpb=10106.877, bsz=617.661, num_updates=228597, lr=6.61401e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=4.000, wall=14396, train_wall=352050
| epoch 072:  21000 / 49553 loss=3.929, nll_loss=2.271, ppl=4.83, wps=57469, ups=5, wpb=10101.676, bsz=617.836, num_updates=229597, lr=6.59959e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=4.000, wall=14573, train_wall=352208
Invalid bert_input shape:torch.Size([4, 831])
| epoch 072:  22000 / 49553 loss=3.928, nll_loss=2.270, ppl=4.82, wps=57481, ups=5, wpb=10103.130, bsz=618.018, num_updates=230597, lr=6.58526e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=4.000, wall=14748, train_wall=352366
Invalid bert_input shape:torch.Size([7, 790])
Invalid bert_input shape:torch.Size([3, 1119])
| epoch 072:  23000 / 49553 loss=3.928, nll_loss=2.270, ppl=4.82, wps=57454, ups=6, wpb=10100.114, bsz=617.453, num_updates=231597, lr=6.57103e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=4.000, wall=14925, train_wall=352524
| epoch 072:  24000 / 49553 loss=3.928, nll_loss=2.270, ppl=4.82, wps=57440, ups=6, wpb=10099.585, bsz=617.362, num_updates=232597, lr=6.55689e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=8.000, wall=15101, train_wall=352682
| epoch 072:  25000 / 49553 loss=3.927, nll_loss=2.269, ppl=4.82, wps=57445, ups=6, wpb=10099.153, bsz=617.998, num_updates=233597, lr=6.54284e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=8.000, wall=15277, train_wall=352838
Invalid bert_input shape:torch.Size([3, 944])
| epoch 072:  26000 / 49553 loss=3.927, nll_loss=2.269, ppl=4.82, wps=57429, ups=6, wpb=10100.676, bsz=618.379, num_updates=234597, lr=6.52888e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=8.000, wall=15454, train_wall=352996
| epoch 072:  27000 / 49553 loss=3.928, nll_loss=2.270, ppl=4.82, wps=57438, ups=6, wpb=10100.574, bsz=618.211, num_updates=235597, lr=6.51501e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=8.000, wall=15629, train_wall=353153
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 072:  28000 / 49553 loss=3.928, nll_loss=2.270, ppl=4.82, wps=57447, ups=6, wpb=10099.886, bsz=618.613, num_updates=236596, lr=6.50124e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=8.000, wall=15804, train_wall=353309
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([4, 843])
| epoch 072:  29000 / 49553 loss=3.928, nll_loss=2.271, ppl=4.83, wps=57441, ups=6, wpb=10100.241, bsz=618.911, num_updates=237595, lr=6.48756e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=4.000, wall=15980, train_wall=353467
| epoch 072:  30000 / 49553 loss=3.928, nll_loss=2.270, ppl=4.82, wps=57421, ups=6, wpb=10100.465, bsz=619.256, num_updates=238595, lr=6.47395e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=4.000, wall=16158, train_wall=353627
| epoch 072:  31000 / 49553 loss=3.928, nll_loss=2.270, ppl=4.82, wps=57435, ups=6, wpb=10099.634, bsz=619.034, num_updates=239595, lr=6.46043e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=4.000, wall=16332, train_wall=353783
| epoch 072:  32000 / 49553 loss=3.927, nll_loss=2.269, ppl=4.82, wps=57427, ups=6, wpb=10100.195, bsz=619.498, num_updates=240595, lr=6.44699e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=4.000, wall=16509, train_wall=353940
| epoch 072:  33000 / 49553 loss=3.927, nll_loss=2.269, ppl=4.82, wps=57449, ups=6, wpb=10100.951, bsz=619.332, num_updates=241595, lr=6.43363e-05, gnorm=0.811, clip=0.000, oom=0.000, loss_scale=8.000, wall=16683, train_wall=354096
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 072:  34000 / 49553 loss=3.927, nll_loss=2.269, ppl=4.82, wps=57467, ups=6, wpb=10101.982, bsz=619.239, num_updates=242594, lr=6.42037e-05, gnorm=0.812, clip=0.000, oom=0.000, loss_scale=4.000, wall=16858, train_wall=354252
Invalid bert_input shape:torch.Size([6, 575])
| epoch 072:  35000 / 49553 loss=3.927, nll_loss=2.269, ppl=4.82, wps=57463, ups=6, wpb=10101.991, bsz=618.925, num_updates=243594, lr=6.40718e-05, gnorm=0.812, clip=0.000, oom=0.000, loss_scale=4.000, wall=17034, train_wall=354410
| epoch 072:  36000 / 49553 loss=3.927, nll_loss=2.269, ppl=4.82, wps=57479, ups=6, wpb=10102.711, bsz=619.088, num_updates=244594, lr=6.39407e-05, gnorm=0.812, clip=0.000, oom=0.000, loss_scale=4.000, wall=17208, train_wall=354565
| epoch 072:  37000 / 49553 loss=3.927, nll_loss=2.269, ppl=4.82, wps=57480, ups=6, wpb=10101.522, bsz=619.133, num_updates=245594, lr=6.38103e-05, gnorm=0.812, clip=0.000, oom=0.000, loss_scale=4.000, wall=17383, train_wall=354721
Invalid bert_input shape:torch.Size([6, 589])
| epoch 072:  38000 / 49553 loss=3.927, nll_loss=2.269, ppl=4.82, wps=57470, ups=6, wpb=10100.296, bsz=619.095, num_updates=246594, lr=6.36808e-05, gnorm=0.812, clip=0.000, oom=0.000, loss_scale=8.000, wall=17559, train_wall=354878
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 072:  39000 / 49553 loss=3.927, nll_loss=2.269, ppl=4.82, wps=57485, ups=6, wpb=10100.926, bsz=618.962, num_updates=247593, lr=6.35522e-05, gnorm=0.812, clip=0.000, oom=0.000, loss_scale=4.000, wall=17734, train_wall=355034
Invalid bert_input shape:torch.Size([6, 528])
| epoch 072:  40000 / 49553 loss=3.927, nll_loss=2.269, ppl=4.82, wps=57486, ups=6, wpb=10100.073, bsz=619.012, num_updates=248593, lr=6.34243e-05, gnorm=0.812, clip=0.000, oom=0.000, loss_scale=4.000, wall=17909, train_wall=355190
| epoch 072:  41000 / 49553 loss=3.927, nll_loss=2.270, ppl=4.82, wps=57487, ups=6, wpb=10101.038, bsz=618.829, num_updates=249593, lr=6.32971e-05, gnorm=0.812, clip=0.000, oom=0.000, loss_scale=4.000, wall=18085, train_wall=355347
| epoch 072:  42000 / 49553 loss=3.927, nll_loss=2.269, ppl=4.82, wps=57497, ups=6, wpb=10100.216, bsz=618.650, num_updates=250593, lr=6.31707e-05, gnorm=0.812, clip=0.000, oom=0.000, loss_scale=4.000, wall=18259, train_wall=355503
Invalid bert_input shape:torch.Size([6, 547])
Invalid bert_input shape:torch.Size([6, 878])
| epoch 072:  43000 / 49553 loss=3.926, nll_loss=2.269, ppl=4.82, wps=57500, ups=6, wpb=10099.790, bsz=618.741, num_updates=251593, lr=6.3045e-05, gnorm=0.812, clip=0.000, oom=0.000, loss_scale=8.000, wall=18434, train_wall=355659
Invalid bert_input shape:torch.Size([6, 546])
| epoch 072:  44000 / 49553 loss=3.927, nll_loss=2.269, ppl=4.82, wps=57496, ups=6, wpb=10099.978, bsz=618.767, num_updates=252593, lr=6.29201e-05, gnorm=0.812, clip=0.000, oom=0.000, loss_scale=8.000, wall=18610, train_wall=355817
Invalid bert_input shape:torch.Size([4, 859])
Invalid bert_input shape:torch.Size([5, 703])
| epoch 072:  45000 / 49553 loss=3.926, nll_loss=2.268, ppl=4.82, wps=57499, ups=6, wpb=10099.384, bsz=618.832, num_updates=253593, lr=6.27959e-05, gnorm=0.812, clip=0.000, oom=0.000, loss_scale=8.000, wall=18785, train_wall=355973
| epoch 072:  46000 / 49553 loss=3.926, nll_loss=2.269, ppl=4.82, wps=57498, ups=6, wpb=10098.129, bsz=618.822, num_updates=254593, lr=6.26725e-05, gnorm=0.813, clip=0.000, oom=0.000, loss_scale=8.000, wall=18959, train_wall=356128
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 072:  47000 / 49553 loss=3.926, nll_loss=2.269, ppl=4.82, wps=57487, ups=6, wpb=10098.834, bsz=618.852, num_updates=255592, lr=6.25499e-05, gnorm=0.813, clip=0.000, oom=0.000, loss_scale=8.000, wall=19137, train_wall=356286
| epoch 072:  48000 / 49553 loss=3.926, nll_loss=2.268, ppl=4.82, wps=57485, ups=6, wpb=10099.805, bsz=618.710, num_updates=256592, lr=6.24279e-05, gnorm=0.812, clip=0.000, oom=0.000, loss_scale=8.000, wall=19314, train_wall=356444
| epoch 072:  49000 / 49553 loss=3.926, nll_loss=2.268, ppl=4.82, wps=57485, ups=6, wpb=10100.459, bsz=618.862, num_updates=257592, lr=6.23066e-05, gnorm=0.812, clip=0.000, oom=0.000, loss_scale=8.000, wall=19490, train_wall=356600
| epoch 072 | loss 3.926 | nll_loss 2.268 | ppl 4.82 | wps 57479 | ups 6 | wpb 10100.031 | bsz 618.656 | num_updates 258144 | lr 6.22399e-05 | gnorm 0.812 | clip 0.000 | oom 0.000 | loss_scale 8.000 | wall 19588 | train_wall 356687
| epoch 072 | valid on 'valid' subset | loss 2.766 | nll_loss 0.950 | ppl 1.93 | num_updates 258144 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint72.pt (epoch 72 @ 258144 updates) (writing took 7.132850170135498 seconds)
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([2, 1203])
| epoch 073:   1000 / 49553 loss=3.888, nll_loss=2.225, ppl=4.67, wps=56982, ups=3, wpb=10047.711, bsz=620.879, num_updates=259144, lr=6.21197e-05, gnorm=0.823, clip=0.000, oom=0.000, loss_scale=4.000, wall=19903, train_wall=356854
Invalid bert_input shape:torch.Size([5, 817])
| epoch 073:   2000 / 49553 loss=3.900, nll_loss=2.239, ppl=4.72, wps=56641, ups=4, wpb=10076.999, bsz=620.384, num_updates=260144, lr=6.20002e-05, gnorm=0.826, clip=0.000, oom=0.000, loss_scale=4.000, wall=20083, train_wall=357015
| WARNING: overflow detected, setting loss scale to: 2.0
Invalid bert_input shape:torch.Size([4, 832])
| epoch 073:   3000 / 49553 loss=3.906, nll_loss=2.246, ppl=4.74, wps=56287, ups=4, wpb=10060.001, bsz=619.870, num_updates=261143, lr=6.18815e-05, gnorm=0.826, clip=0.000, oom=0.000, loss_scale=2.000, wall=20263, train_wall=357176
| epoch 073:   4000 / 49553 loss=3.903, nll_loss=2.242, ppl=4.73, wps=56660, ups=5, wpb=10070.833, bsz=620.383, num_updates=262143, lr=6.17634e-05, gnorm=0.823, clip=0.000, oom=0.000, loss_scale=2.000, wall=20438, train_wall=357332
| epoch 073:   5000 / 49553 loss=3.903, nll_loss=2.243, ppl=4.73, wps=56859, ups=5, wpb=10070.157, bsz=615.288, num_updates=263143, lr=6.16459e-05, gnorm=0.822, clip=0.000, oom=0.000, loss_scale=2.000, wall=20612, train_wall=357488
Invalid bert_input shape:torch.Size([3, 1184])
| epoch 073:   6000 / 49553 loss=3.904, nll_loss=2.244, ppl=4.74, wps=56954, ups=5, wpb=10076.110, bsz=615.625, num_updates=264143, lr=6.15291e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=2.000, wall=20788, train_wall=357644
Invalid bert_input shape:torch.Size([7, 790])
| epoch 073:   7000 / 49553 loss=3.906, nll_loss=2.245, ppl=4.74, wps=57007, ups=5, wpb=10072.258, bsz=614.726, num_updates=265143, lr=6.14129e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=20964, train_wall=357802
| epoch 073:   8000 / 49553 loss=3.906, nll_loss=2.245, ppl=4.74, wps=57040, ups=5, wpb=10070.119, bsz=614.582, num_updates=266143, lr=6.12975e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=21139, train_wall=357957
Invalid bert_input shape:torch.Size([4, 837])
| epoch 073:   9000 / 49553 loss=3.905, nll_loss=2.245, ppl=4.74, wps=56999, ups=5, wpb=10067.326, bsz=616.596, num_updates=267143, lr=6.11826e-05, gnorm=0.820, clip=0.000, oom=0.000, loss_scale=4.000, wall=21317, train_wall=358114
| epoch 073:  10000 / 49553 loss=3.906, nll_loss=2.246, ppl=4.74, wps=57002, ups=5, wpb=10071.784, bsz=616.702, num_updates=268143, lr=6.10684e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=21494, train_wall=358266
Invalid bert_input shape:torch.Size([6, 784])
| epoch 073:  11000 / 49553 loss=3.909, nll_loss=2.249, ppl=4.75, wps=57049, ups=5, wpb=10072.111, bsz=616.715, num_updates=269143, lr=6.09549e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=8.000, wall=21669, train_wall=358423
Invalid bert_input shape:torch.Size([5, 701])
| epoch 073:  12000 / 49553 loss=3.908, nll_loss=2.248, ppl=4.75, wps=57074, ups=5, wpb=10075.352, bsz=617.192, num_updates=270143, lr=6.0842e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=8.000, wall=21845, train_wall=358581
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([4, 760])
| epoch 073:  13000 / 49553 loss=3.908, nll_loss=2.248, ppl=4.75, wps=57163, ups=5, wpb=10083.263, bsz=616.556, num_updates=271142, lr=6.07298e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=22020, train_wall=358738
| epoch 073:  14000 / 49553 loss=3.908, nll_loss=2.249, ppl=4.75, wps=57217, ups=5, wpb=10087.734, bsz=616.760, num_updates=272142, lr=6.06181e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=22195, train_wall=358894
| epoch 073:  15000 / 49553 loss=3.909, nll_loss=2.249, ppl=4.76, wps=57231, ups=5, wpb=10090.134, bsz=615.768, num_updates=273142, lr=6.0507e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=22371, train_wall=359052
| WARNING: overflow detected, setting loss scale to: 2.0
Invalid bert_input shape:torch.Size([4, 843])
| epoch 073:  16000 / 49553 loss=3.908, nll_loss=2.248, ppl=4.75, wps=57224, ups=5, wpb=10092.131, bsz=615.858, num_updates=274141, lr=6.03967e-05, gnorm=0.820, clip=0.000, oom=0.000, loss_scale=2.000, wall=22548, train_wall=359205
| epoch 073:  17000 / 49553 loss=3.908, nll_loss=2.248, ppl=4.75, wps=57245, ups=5, wpb=10092.751, bsz=615.916, num_updates=275141, lr=6.02868e-05, gnorm=0.820, clip=0.000, oom=0.000, loss_scale=2.000, wall=22724, train_wall=359360
| epoch 073:  18000 / 49553 loss=3.908, nll_loss=2.249, ppl=4.75, wps=57286, ups=5, wpb=10098.376, bsz=615.624, num_updates=276141, lr=6.01776e-05, gnorm=0.820, clip=0.000, oom=0.000, loss_scale=2.000, wall=22900, train_wall=359517
| epoch 073:  19000 / 49553 loss=3.909, nll_loss=2.249, ppl=4.76, wps=57306, ups=5, wpb=10097.797, bsz=615.642, num_updates=277141, lr=6.00689e-05, gnorm=0.820, clip=0.000, oom=0.000, loss_scale=2.000, wall=23075, train_wall=359673
| epoch 073:  20000 / 49553 loss=3.910, nll_loss=2.250, ppl=4.76, wps=57319, ups=5, wpb=10096.295, bsz=616.018, num_updates=278141, lr=5.99608e-05, gnorm=0.820, clip=0.000, oom=0.000, loss_scale=4.000, wall=23249, train_wall=359829
| epoch 073:  21000 / 49553 loss=3.910, nll_loss=2.251, ppl=4.76, wps=57308, ups=5, wpb=10094.000, bsz=615.815, num_updates=279141, lr=5.98533e-05, gnorm=0.820, clip=0.000, oom=0.000, loss_scale=4.000, wall=23425, train_wall=359986
| epoch 073:  22000 / 49553 loss=3.910, nll_loss=2.251, ppl=4.76, wps=57332, ups=5, wpb=10096.996, bsz=615.798, num_updates=280141, lr=5.97464e-05, gnorm=0.820, clip=0.000, oom=0.000, loss_scale=4.000, wall=23601, train_wall=360142
Invalid bert_input shape:torch.Size([5, 644])
| epoch 073:  23000 / 49553 loss=3.910, nll_loss=2.250, ppl=4.76, wps=57343, ups=5, wpb=10094.832, bsz=616.258, num_updates=281141, lr=5.964e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=23776, train_wall=360298
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 073:  24000 / 49553 loss=3.910, nll_loss=2.250, ppl=4.76, wps=57301, ups=5, wpb=10094.477, bsz=616.840, num_updates=282140, lr=5.95344e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=23954, train_wall=360459
| epoch 073:  25000 / 49553 loss=3.910, nll_loss=2.251, ppl=4.76, wps=57300, ups=6, wpb=10095.533, bsz=617.065, num_updates=283140, lr=5.94291e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=24131, train_wall=360615
Invalid bert_input shape:torch.Size([6, 878])
| epoch 073:  26000 / 49553 loss=3.910, nll_loss=2.250, ppl=4.76, wps=57278, ups=6, wpb=10095.977, bsz=616.822, num_updates=284140, lr=5.93245e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=24309, train_wall=360776
| epoch 073:  27000 / 49553 loss=3.910, nll_loss=2.250, ppl=4.76, wps=57288, ups=6, wpb=10096.873, bsz=616.875, num_updates=285140, lr=5.92203e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=24485, train_wall=360933
Invalid bert_input shape:torch.Size([7, 722])
| epoch 073:  28000 / 49553 loss=3.910, nll_loss=2.250, ppl=4.76, wps=57301, ups=6, wpb=10095.647, bsz=617.203, num_updates=286140, lr=5.91168e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=8.000, wall=24660, train_wall=361090
Invalid bert_input shape:torch.Size([4, 823])
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 073:  29000 / 49553 loss=3.910, nll_loss=2.250, ppl=4.76, wps=57312, ups=6, wpb=10095.078, bsz=617.306, num_updates=287139, lr=5.90138e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=24834, train_wall=361247
| epoch 073:  30000 / 49553 loss=3.910, nll_loss=2.250, ppl=4.76, wps=57295, ups=6, wpb=10094.930, bsz=617.650, num_updates=288139, lr=5.89114e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=25012, train_wall=361403
Invalid bert_input shape:torch.Size([6, 575])
| epoch 073:  31000 / 49553 loss=3.910, nll_loss=2.250, ppl=4.76, wps=57306, ups=6, wpb=10095.298, bsz=617.397, num_updates=289139, lr=5.88094e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=25187, train_wall=361559
| epoch 073:  32000 / 49553 loss=3.910, nll_loss=2.251, ppl=4.76, wps=57320, ups=6, wpb=10094.207, bsz=616.822, num_updates=290139, lr=5.8708e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=25361, train_wall=361714
| epoch 073:  33000 / 49553 loss=3.910, nll_loss=2.251, ppl=4.76, wps=57324, ups=6, wpb=10095.253, bsz=617.117, num_updates=291139, lr=5.8607e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=8.000, wall=25538, train_wall=361872
| epoch 073:  34000 / 49553 loss=3.910, nll_loss=2.251, ppl=4.76, wps=57326, ups=6, wpb=10098.051, bsz=617.278, num_updates=292139, lr=5.85066e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=8.000, wall=25715, train_wall=362031
Invalid bert_input shape:torch.Size([4, 859])
| epoch 073:  35000 / 49553 loss=3.910, nll_loss=2.251, ppl=4.76, wps=57340, ups=6, wpb=10098.622, bsz=617.448, num_updates=293139, lr=5.84068e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=8.000, wall=25890, train_wall=362187
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([2, 1513])
| epoch 073:  36000 / 49553 loss=3.910, nll_loss=2.251, ppl=4.76, wps=57344, ups=6, wpb=10098.424, bsz=617.391, num_updates=294138, lr=5.83075e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=26066, train_wall=362344
Invalid bert_input shape:torch.Size([4, 790])
| epoch 073:  37000 / 49553 loss=3.910, nll_loss=2.251, ppl=4.76, wps=57358, ups=6, wpb=10099.551, bsz=617.552, num_updates=295138, lr=5.82086e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=26241, train_wall=362500
| epoch 073:  38000 / 49553 loss=3.911, nll_loss=2.251, ppl=4.76, wps=57374, ups=6, wpb=10101.231, bsz=617.888, num_updates=296138, lr=5.81103e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=26416, train_wall=362656
| epoch 073:  39000 / 49553 loss=3.911, nll_loss=2.252, ppl=4.76, wps=57366, ups=6, wpb=10102.323, bsz=617.766, num_updates=297138, lr=5.80124e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=4.000, wall=26594, train_wall=362815
Invalid bert_input shape:torch.Size([6, 566])
Invalid bert_input shape:torch.Size([5, 729])
| epoch 073:  40000 / 49553 loss=3.911, nll_loss=2.252, ppl=4.76, wps=57358, ups=6, wpb=10102.049, bsz=617.845, num_updates=298138, lr=5.7915e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=8.000, wall=26771, train_wall=362972
| epoch 073:  41000 / 49553 loss=3.911, nll_loss=2.252, ppl=4.76, wps=57365, ups=6, wpb=10103.048, bsz=617.801, num_updates=299138, lr=5.78182e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=8.000, wall=26947, train_wall=363130
| epoch 073:  42000 / 49553 loss=3.911, nll_loss=2.252, ppl=4.76, wps=57358, ups=6, wpb=10101.520, bsz=617.958, num_updates=300138, lr=5.77218e-05, gnorm=0.821, clip=0.000, oom=0.000, loss_scale=8.000, wall=27123, train_wall=363287
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([6, 546])
| epoch 073:  43000 / 49553 loss=3.911, nll_loss=2.252, ppl=4.76, wps=57355, ups=6, wpb=10099.466, bsz=618.163, num_updates=301137, lr=5.76259e-05, gnorm=0.822, clip=0.000, oom=0.000, loss_scale=4.000, wall=27298, train_wall=363441
| epoch 073:  44000 / 49553 loss=3.911, nll_loss=2.252, ppl=4.76, wps=57343, ups=6, wpb=10100.927, bsz=618.314, num_updates=302137, lr=5.75305e-05, gnorm=0.822, clip=0.000, oom=0.000, loss_scale=4.000, wall=27476, train_wall=363601
Invalid bert_input shape:torch.Size([2, 1562])
| epoch 073:  45000 / 49553 loss=3.911, nll_loss=2.252, ppl=4.76, wps=57351, ups=6, wpb=10100.565, bsz=618.288, num_updates=303137, lr=5.74355e-05, gnorm=0.822, clip=0.000, oom=0.000, loss_scale=4.000, wall=27651, train_wall=363758
Invalid bert_input shape:torch.Size([6, 1334])
| epoch 073:  46000 / 49553 loss=3.911, nll_loss=2.252, ppl=4.76, wps=57334, ups=6, wpb=10101.172, bsz=618.867, num_updates=304137, lr=5.7341e-05, gnorm=0.822, clip=0.000, oom=0.000, loss_scale=4.000, wall=27830, train_wall=363917
Invalid bert_input shape:torch.Size([4, 720])
| epoch 073:  47000 / 49553 loss=3.912, nll_loss=2.253, ppl=4.77, wps=57307, ups=6, wpb=10101.580, bsz=618.783, num_updates=305137, lr=5.7247e-05, gnorm=0.822, clip=0.000, oom=0.000, loss_scale=8.000, wall=28011, train_wall=364080
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([4, 758])
| epoch 073:  48000 / 49553 loss=3.912, nll_loss=2.253, ppl=4.77, wps=57318, ups=6, wpb=10101.246, bsz=618.650, num_updates=306136, lr=5.71535e-05, gnorm=0.822, clip=0.000, oom=0.000, loss_scale=4.000, wall=28185, train_wall=364236
| epoch 073:  49000 / 49553 loss=3.912, nll_loss=2.253, ppl=4.77, wps=57308, ups=6, wpb=10100.373, bsz=618.646, num_updates=307136, lr=5.70604e-05, gnorm=0.822, clip=0.000, oom=0.000, loss_scale=4.000, wall=28362, train_wall=364394
| epoch 073 | loss 3.912 | nll_loss 2.253 | ppl 4.77 | wps 57303 | ups 6 | wpb 10100.067 | bsz 618.664 | num_updates 307688 | lr 5.70092e-05 | gnorm 0.822 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 28460 | train_wall 364482
| epoch 073 | valid on 'valid' subset | loss 2.767 | nll_loss 0.944 | ppl 1.92 | num_updates 307688 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint73.pt (epoch 73 @ 307688 updates) (writing took 7.415534973144531 seconds)
Invalid bert_input shape:torch.Size([5, 907])
| epoch 074:   1000 / 49553 loss=3.914, nll_loss=2.255, ppl=4.77, wps=57202, ups=3, wpb=10127.700, bsz=608.855, num_updates=308689, lr=5.69167e-05, gnorm=0.836, clip=0.000, oom=0.000, loss_scale=4.000, wall=28771, train_wall=364644
| epoch 074:   2000 / 49553 loss=3.910, nll_loss=2.251, ppl=4.76, wps=57396, ups=4, wpb=10109.376, bsz=617.055, num_updates=309689, lr=5.68247e-05, gnorm=0.828, clip=0.000, oom=0.000, loss_scale=8.000, wall=28947, train_wall=364800
| epoch 074:   3000 / 49553 loss=3.905, nll_loss=2.245, ppl=4.74, wps=57599, ups=5, wpb=10120.328, bsz=616.733, num_updates=310689, lr=5.67332e-05, gnorm=0.827, clip=0.000, oom=0.000, loss_scale=8.000, wall=29121, train_wall=364956
| epoch 074:   4000 / 49553 loss=3.905, nll_loss=2.245, ppl=4.74, wps=57527, ups=5, wpb=10106.066, bsz=617.465, num_updates=311689, lr=5.66421e-05, gnorm=0.828, clip=0.000, oom=0.000, loss_scale=8.000, wall=29297, train_wall=365113
| epoch 074:   5000 / 49553 loss=3.903, nll_loss=2.243, ppl=4.73, wps=57568, ups=5, wpb=10103.489, bsz=617.291, num_updates=312689, lr=5.65514e-05, gnorm=0.828, clip=0.000, oom=0.000, loss_scale=8.000, wall=29472, train_wall=365270
Invalid bert_input shape:torch.Size([4, 790])
| epoch 074:   6000 / 49553 loss=3.900, nll_loss=2.239, ppl=4.72, wps=57567, ups=5, wpb=10104.402, bsz=618.469, num_updates=313689, lr=5.64612e-05, gnorm=0.828, clip=0.000, oom=0.000, loss_scale=16.000, wall=29647, train_wall=365427
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 074:   7000 / 49553 loss=3.901, nll_loss=2.241, ppl=4.73, wps=57598, ups=5, wpb=10110.614, bsz=618.936, num_updates=314688, lr=5.63715e-05, gnorm=0.827, clip=0.000, oom=0.000, loss_scale=8.000, wall=29823, train_wall=365585
Invalid bert_input shape:torch.Size([5, 817])
| epoch 074:   8000 / 49553 loss=3.900, nll_loss=2.240, ppl=4.72, wps=57557, ups=5, wpb=10122.613, bsz=619.249, num_updates=315688, lr=5.62822e-05, gnorm=0.827, clip=0.000, oom=0.000, loss_scale=8.000, wall=30001, train_wall=365744
| epoch 074:   9000 / 49553 loss=3.899, nll_loss=2.239, ppl=4.72, wps=57605, ups=5, wpb=10128.332, bsz=618.432, num_updates=316688, lr=5.61933e-05, gnorm=0.826, clip=0.000, oom=0.000, loss_scale=8.000, wall=30177, train_wall=365903
| epoch 074:  10000 / 49553 loss=3.900, nll_loss=2.239, ppl=4.72, wps=57627, ups=5, wpb=10126.768, bsz=618.025, num_updates=317688, lr=5.61047e-05, gnorm=0.826, clip=0.000, oom=0.000, loss_scale=8.000, wall=30351, train_wall=366060
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 074:  11000 / 49553 loss=3.900, nll_loss=2.240, ppl=4.72, wps=57613, ups=5, wpb=10121.157, bsz=619.605, num_updates=318687, lr=5.60167e-05, gnorm=0.827, clip=0.000, oom=0.000, loss_scale=8.000, wall=30526, train_wall=366216
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 074:  12000 / 49553 loss=3.900, nll_loss=2.240, ppl=4.72, wps=57625, ups=5, wpb=10121.623, bsz=620.167, num_updates=319686, lr=5.59291e-05, gnorm=0.827, clip=0.000, oom=0.000, loss_scale=4.000, wall=30702, train_wall=366373
Invalid bert_input shape:torch.Size([3, 944])
| epoch 074:  13000 / 49553 loss=3.900, nll_loss=2.239, ppl=4.72, wps=57628, ups=5, wpb=10116.988, bsz=621.243, num_updates=320686, lr=5.58419e-05, gnorm=0.827, clip=0.000, oom=0.000, loss_scale=4.000, wall=30876, train_wall=366529
| epoch 074:  14000 / 49553 loss=3.899, nll_loss=2.238, ppl=4.72, wps=57645, ups=5, wpb=10115.596, bsz=621.269, num_updates=321686, lr=5.5755e-05, gnorm=0.827, clip=0.000, oom=0.000, loss_scale=4.000, wall=31051, train_wall=366685
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 074:  15000 / 49553 loss=3.900, nll_loss=2.239, ppl=4.72, wps=57654, ups=5, wpb=10118.117, bsz=621.211, num_updates=322685, lr=5.56686e-05, gnorm=0.827, clip=0.000, oom=0.000, loss_scale=2.000, wall=31226, train_wall=366843
Invalid bert_input shape:torch.Size([6, 595])
| epoch 074:  16000 / 49553 loss=3.900, nll_loss=2.239, ppl=4.72, wps=57657, ups=5, wpb=10119.399, bsz=620.977, num_updates=323685, lr=5.55826e-05, gnorm=0.827, clip=0.000, oom=0.000, loss_scale=2.000, wall=31402, train_wall=367000
Invalid bert_input shape:torch.Size([4, 864])
| epoch 074:  17000 / 49553 loss=3.899, nll_loss=2.239, ppl=4.72, wps=57627, ups=5, wpb=10111.518, bsz=620.837, num_updates=324685, lr=5.54969e-05, gnorm=0.827, clip=0.000, oom=0.000, loss_scale=2.000, wall=31577, train_wall=367156
| epoch 074:  18000 / 49553 loss=3.900, nll_loss=2.240, ppl=4.72, wps=57623, ups=5, wpb=10111.779, bsz=620.787, num_updates=325685, lr=5.54117e-05, gnorm=0.828, clip=0.000, oom=0.000, loss_scale=2.000, wall=31752, train_wall=367313
| epoch 074:  19000 / 49553 loss=3.900, nll_loss=2.240, ppl=4.72, wps=57632, ups=5, wpb=10111.321, bsz=620.997, num_updates=326685, lr=5.53268e-05, gnorm=0.828, clip=0.000, oom=0.000, loss_scale=4.000, wall=31927, train_wall=367469
| epoch 074:  20000 / 49553 loss=3.901, nll_loss=2.241, ppl=4.73, wps=57638, ups=5, wpb=10111.753, bsz=620.144, num_updates=327685, lr=5.52423e-05, gnorm=0.828, clip=0.000, oom=0.000, loss_scale=4.000, wall=32102, train_wall=367626
| epoch 074:  21000 / 49553 loss=3.901, nll_loss=2.240, ppl=4.73, wps=57627, ups=5, wpb=10110.901, bsz=619.138, num_updates=328685, lr=5.51582e-05, gnorm=0.829, clip=0.000, oom=0.000, loss_scale=4.000, wall=32278, train_wall=367784
Invalid bert_input shape:torch.Size([2, 1608])
| epoch 074:  22000 / 49553 loss=3.900, nll_loss=2.240, ppl=4.72, wps=57632, ups=6, wpb=10108.450, bsz=618.889, num_updates=329685, lr=5.50745e-05, gnorm=0.829, clip=0.000, oom=0.000, loss_scale=4.000, wall=32452, train_wall=367940
Invalid bert_input shape:torch.Size([5, 644])
| epoch 074:  23000 / 49553 loss=3.900, nll_loss=2.240, ppl=4.72, wps=57622, ups=6, wpb=10107.705, bsz=618.792, num_updates=330685, lr=5.49911e-05, gnorm=0.830, clip=0.000, oom=0.000, loss_scale=8.000, wall=32628, train_wall=368096
| epoch 074:  24000 / 49553 loss=3.901, nll_loss=2.240, ppl=4.73, wps=57621, ups=6, wpb=10109.198, bsz=618.276, num_updates=331685, lr=5.49082e-05, gnorm=0.830, clip=0.000, oom=0.000, loss_scale=8.000, wall=32804, train_wall=368253
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 074:  25000 / 49553 loss=3.901, nll_loss=2.241, ppl=4.73, wps=57640, ups=6, wpb=10110.845, bsz=618.112, num_updates=332684, lr=5.48257e-05, gnorm=0.830, clip=0.000, oom=0.000, loss_scale=4.000, wall=32979, train_wall=368410
| epoch 074:  26000 / 49553 loss=3.901, nll_loss=2.241, ppl=4.73, wps=57639, ups=6, wpb=10110.774, bsz=618.445, num_updates=333684, lr=5.47435e-05, gnorm=0.830, clip=0.000, oom=0.000, loss_scale=4.000, wall=33154, train_wall=368567
| epoch 074:  27000 / 49553 loss=3.901, nll_loss=2.241, ppl=4.73, wps=57649, ups=6, wpb=10112.327, bsz=618.518, num_updates=334684, lr=5.46616e-05, gnorm=0.831, clip=0.000, oom=0.000, loss_scale=4.000, wall=33330, train_wall=368724
| epoch 074:  28000 / 49553 loss=3.901, nll_loss=2.241, ppl=4.73, wps=57654, ups=6, wpb=10110.356, bsz=618.400, num_updates=335684, lr=5.45801e-05, gnorm=0.831, clip=0.000, oom=0.000, loss_scale=4.000, wall=33504, train_wall=368880
| epoch 074:  29000 / 49553 loss=3.901, nll_loss=2.241, ppl=4.73, wps=57655, ups=6, wpb=10110.578, bsz=618.134, num_updates=336684, lr=5.4499e-05, gnorm=0.831, clip=0.000, oom=0.000, loss_scale=8.000, wall=33679, train_wall=369036
Invalid bert_input shape:torch.Size([6, 1334])
| epoch 074:  30000 / 49553 loss=3.901, nll_loss=2.241, ppl=4.73, wps=57636, ups=6, wpb=10111.444, bsz=618.239, num_updates=337684, lr=5.44183e-05, gnorm=0.831, clip=0.000, oom=0.000, loss_scale=8.000, wall=33857, train_wall=369194
| epoch 074:  31000 / 49553 loss=3.901, nll_loss=2.241, ppl=4.73, wps=57640, ups=6, wpb=10111.758, bsz=618.483, num_updates=338684, lr=5.43379e-05, gnorm=0.831, clip=0.000, oom=0.000, loss_scale=8.000, wall=34032, train_wall=369349
| epoch 074:  32000 / 49553 loss=3.901, nll_loss=2.240, ppl=4.73, wps=57642, ups=6, wpb=10111.090, bsz=618.425, num_updates=339684, lr=5.42578e-05, gnorm=0.831, clip=0.000, oom=0.000, loss_scale=8.000, wall=34207, train_wall=369505
Invalid bert_input shape:torch.Size([4, 776])
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 074:  33000 / 49553 loss=3.900, nll_loss=2.240, ppl=4.72, wps=57645, ups=6, wpb=10112.084, bsz=618.579, num_updates=340683, lr=5.41782e-05, gnorm=0.831, clip=0.000, oom=0.000, loss_scale=8.000, wall=34382, train_wall=369663
| epoch 074:  34000 / 49553 loss=3.900, nll_loss=2.240, ppl=4.72, wps=57647, ups=6, wpb=10110.867, bsz=618.831, num_updates=341683, lr=5.40989e-05, gnorm=0.832, clip=0.000, oom=0.000, loss_scale=8.000, wall=34557, train_wall=369818
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 074:  35000 / 49553 loss=3.900, nll_loss=2.240, ppl=4.72, wps=57650, ups=6, wpb=10110.752, bsz=619.414, num_updates=342682, lr=5.402e-05, gnorm=0.831, clip=0.000, oom=0.000, loss_scale=4.000, wall=34731, train_wall=369974
| epoch 074:  36000 / 49553 loss=3.900, nll_loss=2.240, ppl=4.72, wps=57634, ups=6, wpb=10108.360, bsz=619.446, num_updates=343682, lr=5.39413e-05, gnorm=0.831, clip=0.000, oom=0.000, loss_scale=4.000, wall=34907, train_wall=370131
| epoch 074:  37000 / 49553 loss=3.900, nll_loss=2.240, ppl=4.72, wps=57631, ups=6, wpb=10109.402, bsz=619.411, num_updates=344682, lr=5.3863e-05, gnorm=0.831, clip=0.000, oom=0.000, loss_scale=4.000, wall=35083, train_wall=370288
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 074:  38000 / 49553 loss=3.900, nll_loss=2.240, ppl=4.72, wps=57625, ups=6, wpb=10107.324, bsz=619.299, num_updates=345681, lr=5.37851e-05, gnorm=0.832, clip=0.000, oom=0.000, loss_scale=2.000, wall=35258, train_wall=370444
| epoch 074:  39000 / 49553 loss=3.900, nll_loss=2.240, ppl=4.72, wps=57620, ups=6, wpb=10106.255, bsz=619.083, num_updates=346681, lr=5.37075e-05, gnorm=0.832, clip=0.000, oom=0.000, loss_scale=2.000, wall=35433, train_wall=370601
| epoch 074:  40000 / 49553 loss=3.901, nll_loss=2.240, ppl=4.73, wps=57617, ups=6, wpb=10105.084, bsz=619.101, num_updates=347681, lr=5.36302e-05, gnorm=0.833, clip=0.000, oom=0.000, loss_scale=2.000, wall=35608, train_wall=370757
| epoch 074:  41000 / 49553 loss=3.901, nll_loss=2.241, ppl=4.73, wps=57618, ups=6, wpb=10105.422, bsz=618.863, num_updates=348681, lr=5.35533e-05, gnorm=0.833, clip=0.000, oom=0.000, loss_scale=2.000, wall=35784, train_wall=370914
Invalid bert_input shape:torch.Size([5, 704])
| epoch 074:  42000 / 49553 loss=3.901, nll_loss=2.240, ppl=4.73, wps=57620, ups=6, wpb=10104.378, bsz=618.823, num_updates=349681, lr=5.34766e-05, gnorm=0.833, clip=0.000, oom=0.000, loss_scale=4.000, wall=35958, train_wall=371071
Invalid bert_input shape:torch.Size([6, 589])
| epoch 074:  43000 / 49553 loss=3.901, nll_loss=2.241, ppl=4.73, wps=57621, ups=6, wpb=10104.352, bsz=618.472, num_updates=350681, lr=5.34003e-05, gnorm=0.833, clip=0.000, oom=0.000, loss_scale=4.000, wall=36133, train_wall=371227
| epoch 074:  44000 / 49553 loss=3.901, nll_loss=2.241, ppl=4.73, wps=57613, ups=6, wpb=10103.216, bsz=618.311, num_updates=351681, lr=5.33243e-05, gnorm=0.833, clip=0.000, oom=0.000, loss_scale=4.000, wall=36309, train_wall=371385
| epoch 074:  45000 / 49553 loss=3.901, nll_loss=2.241, ppl=4.73, wps=57614, ups=6, wpb=10104.211, bsz=618.388, num_updates=352681, lr=5.32487e-05, gnorm=0.833, clip=0.000, oom=0.000, loss_scale=4.000, wall=36485, train_wall=371542
Invalid bert_input shape:torch.Size([5, 674])
Invalid bert_input shape:torch.Size([5, 655])
| epoch 074:  46000 / 49553 loss=3.901, nll_loss=2.241, ppl=4.73, wps=57611, ups=6, wpb=10102.185, bsz=618.296, num_updates=353681, lr=5.31734e-05, gnorm=0.833, clip=0.000, oom=0.000, loss_scale=4.000, wall=36659, train_wall=371697
Invalid bert_input shape:torch.Size([7, 573])
| epoch 074:  47000 / 49553 loss=3.900, nll_loss=2.240, ppl=4.72, wps=57603, ups=6, wpb=10102.824, bsz=618.509, num_updates=354681, lr=5.30984e-05, gnorm=0.833, clip=0.000, oom=0.000, loss_scale=8.000, wall=36836, train_wall=371856
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([4, 859])
| epoch 074:  48000 / 49553 loss=3.900, nll_loss=2.240, ppl=4.72, wps=57591, ups=6, wpb=10101.065, bsz=618.667, num_updates=355680, lr=5.30237e-05, gnorm=0.833, clip=0.000, oom=0.000, loss_scale=4.000, wall=37012, train_wall=372012
Invalid bert_input shape:torch.Size([4, 790])
| epoch 074:  49000 / 49553 loss=3.900, nll_loss=2.240, ppl=4.72, wps=57562, ups=6, wpb=10100.040, bsz=618.832, num_updates=356680, lr=5.29493e-05, gnorm=0.834, clip=0.000, oom=0.000, loss_scale=4.000, wall=37190, train_wall=372170
| epoch 074 | loss 3.900 | nll_loss 2.240 | ppl 4.72 | wps 57549 | ups 6 | wpb 10100.067 | bsz 618.700 | num_updates 357232 | lr 5.29084e-05 | gnorm 0.834 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 37289 | train_wall 372258
| epoch 074 | valid on 'valid' subset | loss 2.764 | nll_loss 0.943 | ppl 1.92 | num_updates 357232 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint74.pt (epoch 74 @ 357232 updates) (writing took 7.1951868534088135 seconds)
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 075:   1000 / 49553 loss=3.890, nll_loss=2.228, ppl=4.68, wps=57664, ups=3, wpb=10132.588, bsz=615.080, num_updates=358232, lr=5.28345e-05, gnorm=0.838, clip=0.000, oom=0.000, loss_scale=2.000, wall=37597, train_wall=372416
Invalid bert_input shape:torch.Size([6, 547])
Invalid bert_input shape:torch.Size([4, 790])
| epoch 075:   2000 / 49553 loss=3.886, nll_loss=2.223, ppl=4.67, wps=57505, ups=4, wpb=10078.426, bsz=616.755, num_updates=359232, lr=5.27609e-05, gnorm=0.842, clip=0.000, oom=0.000, loss_scale=2.000, wall=37772, train_wall=372571
Invalid bert_input shape:torch.Size([5, 616])
| epoch 075:   3000 / 49553 loss=3.887, nll_loss=2.225, ppl=4.68, wps=57659, ups=5, wpb=10110.144, bsz=617.410, num_updates=360232, lr=5.26877e-05, gnorm=0.840, clip=0.000, oom=0.000, loss_scale=2.000, wall=37947, train_wall=372728
| epoch 075:   4000 / 49553 loss=3.887, nll_loss=2.225, ppl=4.67, wps=57598, ups=5, wpb=10095.527, bsz=617.282, num_updates=361232, lr=5.26147e-05, gnorm=0.841, clip=0.000, oom=0.000, loss_scale=2.000, wall=38122, train_wall=372885
| epoch 075:   5000 / 49553 loss=3.886, nll_loss=2.224, ppl=4.67, wps=57654, ups=5, wpb=10099.274, bsz=617.637, num_updates=362232, lr=5.2542e-05, gnorm=0.838, clip=0.000, oom=0.000, loss_scale=4.000, wall=38297, train_wall=373041
| epoch 075:   6000 / 49553 loss=3.885, nll_loss=2.222, ppl=4.67, wps=57626, ups=5, wpb=10087.477, bsz=617.849, num_updates=363232, lr=5.24696e-05, gnorm=0.839, clip=0.000, oom=0.000, loss_scale=4.000, wall=38472, train_wall=373197
| epoch 075:   7000 / 49553 loss=3.886, nll_loss=2.224, ppl=4.67, wps=57638, ups=5, wpb=10091.414, bsz=617.884, num_updates=364232, lr=5.23975e-05, gnorm=0.839, clip=0.000, oom=0.000, loss_scale=4.000, wall=38647, train_wall=373354
Invalid bert_input shape:torch.Size([5, 655])
Invalid bert_input shape:torch.Size([2, 1562])
| epoch 075:   8000 / 49553 loss=3.888, nll_loss=2.226, ppl=4.68, wps=57643, ups=5, wpb=10088.904, bsz=619.400, num_updates=365232, lr=5.23258e-05, gnorm=0.840, clip=0.000, oom=0.000, loss_scale=4.000, wall=38821, train_wall=373510
Invalid bert_input shape:torch.Size([8, 844])
| epoch 075:   9000 / 49553 loss=3.889, nll_loss=2.227, ppl=4.68, wps=57681, ups=5, wpb=10099.958, bsz=620.194, num_updates=366232, lr=5.22543e-05, gnorm=0.839, clip=0.000, oom=0.000, loss_scale=8.000, wall=38997, train_wall=373666
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([5, 994])
| epoch 075:  10000 / 49553 loss=3.889, nll_loss=2.228, ppl=4.68, wps=57606, ups=5, wpb=10099.668, bsz=619.626, num_updates=367231, lr=5.21832e-05, gnorm=0.839, clip=0.000, oom=0.000, loss_scale=4.000, wall=39174, train_wall=373825
| epoch 075:  11000 / 49553 loss=3.890, nll_loss=2.229, ppl=4.69, wps=57585, ups=5, wpb=10095.884, bsz=620.248, num_updates=368231, lr=5.21123e-05, gnorm=0.840, clip=0.000, oom=0.000, loss_scale=4.000, wall=39350, train_wall=373981
Invalid bert_input shape:torch.Size([2, 1513])
| epoch 075:  12000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57593, ups=5, wpb=10094.330, bsz=619.833, num_updates=369231, lr=5.20416e-05, gnorm=0.841, clip=0.000, oom=0.000, loss_scale=4.000, wall=39524, train_wall=374137
Invalid bert_input shape:torch.Size([4, 864])
| epoch 075:  13000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57585, ups=5, wpb=10093.181, bsz=619.403, num_updates=370231, lr=5.19713e-05, gnorm=0.840, clip=0.000, oom=0.000, loss_scale=4.000, wall=39700, train_wall=374295
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 075:  14000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57518, ups=5, wpb=10090.083, bsz=619.146, num_updates=371230, lr=5.19013e-05, gnorm=0.841, clip=0.000, oom=0.000, loss_scale=4.000, wall=39877, train_wall=374448
| epoch 075:  15000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57543, ups=5, wpb=10089.157, bsz=618.348, num_updates=372230, lr=5.18316e-05, gnorm=0.841, clip=0.000, oom=0.000, loss_scale=4.000, wall=40051, train_wall=374605
Invalid bert_input shape:torch.Size([6, 589])
| epoch 075:  16000 / 49553 loss=3.892, nll_loss=2.231, ppl=4.69, wps=57560, ups=5, wpb=10091.829, bsz=618.804, num_updates=373230, lr=5.17621e-05, gnorm=0.840, clip=0.000, oom=0.000, loss_scale=4.000, wall=40226, train_wall=374761
| epoch 075:  17000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57535, ups=5, wpb=10092.077, bsz=619.024, num_updates=374230, lr=5.16929e-05, gnorm=0.840, clip=0.000, oom=0.000, loss_scale=4.000, wall=40403, train_wall=374919
| epoch 075:  18000 / 49553 loss=3.890, nll_loss=2.229, ppl=4.69, wps=57518, ups=5, wpb=10090.250, bsz=618.948, num_updates=375230, lr=5.16239e-05, gnorm=0.841, clip=0.000, oom=0.000, loss_scale=8.000, wall=40579, train_wall=375077
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([5, 907])
| epoch 075:  19000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57551, ups=5, wpb=10094.099, bsz=618.521, num_updates=376229, lr=5.15554e-05, gnorm=0.841, clip=0.000, oom=0.000, loss_scale=4.000, wall=40753, train_wall=375233
Invalid bert_input shape:torch.Size([5, 817])
| epoch 075:  20000 / 49553 loss=3.891, nll_loss=2.229, ppl=4.69, wps=57567, ups=5, wpb=10096.203, bsz=618.707, num_updates=377229, lr=5.1487e-05, gnorm=0.841, clip=0.000, oom=0.000, loss_scale=4.000, wall=40928, train_wall=375390
| epoch 075:  21000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57554, ups=6, wpb=10093.375, bsz=618.765, num_updates=378229, lr=5.14189e-05, gnorm=0.841, clip=0.000, oom=0.000, loss_scale=4.000, wall=41104, train_wall=375547
| epoch 075:  22000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57568, ups=6, wpb=10099.188, bsz=619.236, num_updates=379229, lr=5.1351e-05, gnorm=0.841, clip=0.000, oom=0.000, loss_scale=4.000, wall=41280, train_wall=375705
| epoch 075:  23000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57555, ups=6, wpb=10096.201, bsz=618.837, num_updates=380229, lr=5.12835e-05, gnorm=0.842, clip=0.000, oom=0.000, loss_scale=8.000, wall=41455, train_wall=375861
Invalid bert_input shape:torch.Size([3, 1160])
| epoch 075:  24000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57551, ups=6, wpb=10096.079, bsz=619.208, num_updates=381229, lr=5.12162e-05, gnorm=0.842, clip=0.000, oom=0.000, loss_scale=8.000, wall=41631, train_wall=376018
| epoch 075:  25000 / 49553 loss=3.892, nll_loss=2.231, ppl=4.69, wps=57566, ups=6, wpb=10097.029, bsz=619.046, num_updates=382229, lr=5.11491e-05, gnorm=0.842, clip=0.000, oom=0.000, loss_scale=8.000, wall=41806, train_wall=376175
| epoch 075:  26000 / 49553 loss=3.892, nll_loss=2.231, ppl=4.69, wps=57577, ups=6, wpb=10097.739, bsz=618.769, num_updates=383229, lr=5.10823e-05, gnorm=0.842, clip=0.000, oom=0.000, loss_scale=8.000, wall=41981, train_wall=376331
Invalid bert_input shape:torch.Size([7, 900])
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 075:  27000 / 49553 loss=3.892, nll_loss=2.231, ppl=4.69, wps=57540, ups=6, wpb=10097.566, bsz=618.609, num_updates=384228, lr=5.10159e-05, gnorm=0.842, clip=0.000, oom=0.000, loss_scale=8.000, wall=42159, train_wall=376491
| epoch 075:  28000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57548, ups=6, wpb=10096.864, bsz=618.619, num_updates=385228, lr=5.09496e-05, gnorm=0.843, clip=0.000, oom=0.000, loss_scale=8.000, wall=42333, train_wall=376647
Invalid bert_input shape:torch.Size([5, 869])
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 075:  29000 / 49553 loss=3.892, nll_loss=2.231, ppl=4.69, wps=57549, ups=6, wpb=10098.890, bsz=618.566, num_updates=386227, lr=5.08837e-05, gnorm=0.842, clip=0.000, oom=0.000, loss_scale=4.000, wall=42509, train_wall=376804
| epoch 075:  30000 / 49553 loss=3.892, nll_loss=2.231, ppl=4.69, wps=57517, ups=6, wpb=10100.498, bsz=618.449, num_updates=387227, lr=5.0818e-05, gnorm=0.842, clip=0.000, oom=0.000, loss_scale=4.000, wall=42689, train_wall=376965
Invalid bert_input shape:torch.Size([5, 950])
Invalid bert_input shape:torch.Size([5, 636])
| epoch 075:  31000 / 49553 loss=3.892, nll_loss=2.231, ppl=4.69, wps=57480, ups=6, wpb=10098.757, bsz=618.713, num_updates=388227, lr=5.07525e-05, gnorm=0.843, clip=0.000, oom=0.000, loss_scale=4.000, wall=42867, train_wall=377126
| epoch 075:  32000 / 49553 loss=3.892, nll_loss=2.231, ppl=4.70, wps=57461, ups=6, wpb=10100.780, bsz=618.217, num_updates=389227, lr=5.06872e-05, gnorm=0.843, clip=0.000, oom=0.000, loss_scale=4.000, wall=43046, train_wall=377287
| epoch 075:  33000 / 49553 loss=3.892, nll_loss=2.231, ppl=4.70, wps=57453, ups=6, wpb=10099.229, bsz=618.333, num_updates=390227, lr=5.06222e-05, gnorm=0.843, clip=0.000, oom=0.000, loss_scale=8.000, wall=43221, train_wall=377444
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 075:  34000 / 49553 loss=3.892, nll_loss=2.231, ppl=4.69, wps=57457, ups=6, wpb=10099.684, bsz=618.538, num_updates=391226, lr=5.05576e-05, gnorm=0.843, clip=0.000, oom=0.000, loss_scale=4.000, wall=43397, train_wall=377600
| epoch 075:  35000 / 49553 loss=3.892, nll_loss=2.231, ppl=4.69, wps=57480, ups=6, wpb=10101.966, bsz=618.358, num_updates=392226, lr=5.04931e-05, gnorm=0.843, clip=0.000, oom=0.000, loss_scale=4.000, wall=43571, train_wall=377757
| epoch 075:  36000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57486, ups=6, wpb=10102.295, bsz=618.273, num_updates=393226, lr=5.04288e-05, gnorm=0.843, clip=0.000, oom=0.000, loss_scale=4.000, wall=43747, train_wall=377914
| epoch 075:  37000 / 49553 loss=3.891, nll_loss=2.229, ppl=4.69, wps=57490, ups=6, wpb=10100.954, bsz=617.993, num_updates=394226, lr=5.03648e-05, gnorm=0.843, clip=0.000, oom=0.000, loss_scale=4.000, wall=43921, train_wall=378070
Invalid bert_input shape:torch.Size([6, 575])
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 075:  38000 / 49553 loss=3.891, nll_loss=2.229, ppl=4.69, wps=57490, ups=6, wpb=10100.139, bsz=617.880, num_updates=395225, lr=5.03011e-05, gnorm=0.843, clip=0.000, oom=0.000, loss_scale=4.000, wall=44096, train_wall=378226
| epoch 075:  39000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57493, ups=6, wpb=10100.450, bsz=618.054, num_updates=396225, lr=5.02376e-05, gnorm=0.843, clip=0.000, oom=0.000, loss_scale=4.000, wall=44272, train_wall=378384
| epoch 075:  40000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57511, ups=6, wpb=10101.608, bsz=617.826, num_updates=397225, lr=5.01743e-05, gnorm=0.843, clip=0.000, oom=0.000, loss_scale=4.000, wall=44446, train_wall=378540
| epoch 075:  41000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57509, ups=6, wpb=10100.762, bsz=618.160, num_updates=398225, lr=5.01113e-05, gnorm=0.844, clip=0.000, oom=0.000, loss_scale=4.000, wall=44621, train_wall=378696
| epoch 075:  42000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57506, ups=6, wpb=10099.013, bsz=617.949, num_updates=399225, lr=5.00485e-05, gnorm=0.844, clip=0.000, oom=0.000, loss_scale=4.000, wall=44796, train_wall=378854
| epoch 075:  43000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57511, ups=6, wpb=10099.211, bsz=617.898, num_updates=400225, lr=4.99859e-05, gnorm=0.844, clip=0.000, oom=0.000, loss_scale=8.000, wall=44971, train_wall=379010
Invalid bert_input shape:torch.Size([4, 831])
| epoch 075:  44000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57513, ups=6, wpb=10098.802, bsz=617.875, num_updates=401225, lr=4.99236e-05, gnorm=0.844, clip=0.000, oom=0.000, loss_scale=8.000, wall=45146, train_wall=379167
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([6, 878])
| epoch 075:  45000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57519, ups=6, wpb=10099.994, bsz=617.733, num_updates=402224, lr=4.98616e-05, gnorm=0.844, clip=0.000, oom=0.000, loss_scale=4.000, wall=45322, train_wall=379325
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 075:  46000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57517, ups=6, wpb=10099.356, bsz=617.827, num_updates=403223, lr=4.97998e-05, gnorm=0.844, clip=0.000, oom=0.000, loss_scale=2.000, wall=45497, train_wall=379480
| epoch 075:  47000 / 49553 loss=3.892, nll_loss=2.231, ppl=4.69, wps=57519, ups=6, wpb=10098.675, bsz=618.146, num_updates=404223, lr=4.97381e-05, gnorm=0.844, clip=0.000, oom=0.000, loss_scale=2.000, wall=45671, train_wall=379636
| epoch 075:  48000 / 49553 loss=3.891, nll_loss=2.231, ppl=4.69, wps=57523, ups=6, wpb=10099.135, bsz=618.334, num_updates=405223, lr=4.96767e-05, gnorm=0.844, clip=0.000, oom=0.000, loss_scale=2.000, wall=45847, train_wall=379793
| epoch 075:  49000 / 49553 loss=3.891, nll_loss=2.230, ppl=4.69, wps=57525, ups=6, wpb=10098.932, bsz=618.548, num_updates=406223, lr=4.96155e-05, gnorm=0.844, clip=0.000, oom=0.000, loss_scale=2.000, wall=46022, train_wall=379949
| epoch 075 | loss 3.891 | nll_loss 2.231 | ppl 4.69 | wps 57533 | ups 6 | wpb 10099.922 | bsz 618.644 | num_updates 406775 | lr 4.95819e-05 | gnorm 0.844 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 46119 | train_wall 380035
| epoch 075 | valid on 'valid' subset | loss 2.770 | nll_loss 0.955 | ppl 1.94 | num_updates 406775 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint75.pt (epoch 75 @ 406775 updates) (writing took 7.3001861572265625 seconds)
Invalid bert_input shape:torch.Size([5, 638])
| epoch 076:   1000 / 49553 loss=3.874, nll_loss=2.211, ppl=4.63, wps=57210, ups=3, wpb=10208.436, bsz=615.928, num_updates=407776, lr=4.9521e-05, gnorm=0.847, clip=0.000, oom=0.000, loss_scale=4.000, wall=46433, train_wall=380201
| epoch 076:   2000 / 49553 loss=3.878, nll_loss=2.216, ppl=4.64, wps=57471, ups=4, wpb=10171.761, bsz=619.006, num_updates=408776, lr=4.94604e-05, gnorm=0.850, clip=0.000, oom=0.000, loss_scale=4.000, wall=46609, train_wall=380358
| epoch 076:   3000 / 49553 loss=3.879, nll_loss=2.216, ppl=4.65, wps=56961, ups=4, wpb=10111.166, bsz=616.013, num_updates=409776, lr=4.94e-05, gnorm=0.856, clip=0.000, oom=0.000, loss_scale=4.000, wall=46787, train_wall=380518
| epoch 076:   4000 / 49553 loss=3.875, nll_loss=2.212, ppl=4.63, wps=56911, ups=5, wpb=10099.018, bsz=616.676, num_updates=410776, lr=4.93398e-05, gnorm=0.853, clip=0.000, oom=0.000, loss_scale=8.000, wall=46965, train_wall=380678
| epoch 076:   5000 / 49553 loss=3.879, nll_loss=2.217, ppl=4.65, wps=57063, ups=5, wpb=10101.772, bsz=616.491, num_updates=411776, lr=4.92799e-05, gnorm=0.855, clip=0.000, oom=0.000, loss_scale=8.000, wall=47140, train_wall=380834
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([6, 575])
| epoch 076:   6000 / 49553 loss=3.879, nll_loss=2.216, ppl=4.65, wps=57159, ups=5, wpb=10098.235, bsz=618.800, num_updates=412775, lr=4.92202e-05, gnorm=0.856, clip=0.000, oom=0.000, loss_scale=4.000, wall=47315, train_wall=380990
| epoch 076:   7000 / 49553 loss=3.875, nll_loss=2.213, ppl=4.63, wps=57265, ups=5, wpb=10104.887, bsz=617.831, num_updates=413775, lr=4.91607e-05, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=4.000, wall=47490, train_wall=381147
| epoch 076:   8000 / 49553 loss=3.878, nll_loss=2.216, ppl=4.64, wps=57370, ups=5, wpb=10115.188, bsz=618.136, num_updates=414775, lr=4.91014e-05, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=4.000, wall=47665, train_wall=381303
| epoch 076:   9000 / 49553 loss=3.879, nll_loss=2.217, ppl=4.65, wps=57452, ups=5, wpb=10118.983, bsz=618.141, num_updates=415775, lr=4.90423e-05, gnorm=0.853, clip=0.000, oom=0.000, loss_scale=4.000, wall=47840, train_wall=381459
| epoch 076:  10000 / 49553 loss=3.880, nll_loss=2.218, ppl=4.65, wps=57491, ups=5, wpb=10121.066, bsz=618.241, num_updates=416775, lr=4.89834e-05, gnorm=0.853, clip=0.000, oom=0.000, loss_scale=8.000, wall=48015, train_wall=381616
Invalid bert_input shape:torch.Size([5, 703])
| epoch 076:  11000 / 49553 loss=3.881, nll_loss=2.219, ppl=4.66, wps=57436, ups=5, wpb=10122.314, bsz=618.298, num_updates=417775, lr=4.89248e-05, gnorm=0.853, clip=0.000, oom=0.000, loss_scale=8.000, wall=48193, train_wall=381776
| epoch 076:  12000 / 49553 loss=3.880, nll_loss=2.218, ppl=4.65, wps=57373, ups=5, wpb=10118.582, bsz=617.767, num_updates=418775, lr=4.88663e-05, gnorm=0.853, clip=0.000, oom=0.000, loss_scale=8.000, wall=48371, train_wall=381935
| epoch 076:  13000 / 49553 loss=3.882, nll_loss=2.220, ppl=4.66, wps=57343, ups=5, wpb=10114.706, bsz=618.823, num_updates=419775, lr=4.88081e-05, gnorm=0.853, clip=0.000, oom=0.000, loss_scale=8.000, wall=48548, train_wall=382094
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 076:  14000 / 49553 loss=3.880, nll_loss=2.218, ppl=4.65, wps=57321, ups=5, wpb=10102.077, bsz=617.785, num_updates=420774, lr=4.87501e-05, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=8.000, wall=48722, train_wall=382249
| epoch 076:  15000 / 49553 loss=3.881, nll_loss=2.219, ppl=4.65, wps=57354, ups=5, wpb=10102.140, bsz=617.709, num_updates=421774, lr=4.86923e-05, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=8.000, wall=48897, train_wall=382405
| epoch 076:  16000 / 49553 loss=3.881, nll_loss=2.219, ppl=4.65, wps=57339, ups=5, wpb=10101.426, bsz=617.861, num_updates=422774, lr=4.86347e-05, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=8.000, wall=49073, train_wall=382564
Invalid bert_input shape:torch.Size([5, 614])
Invalid bert_input shape:torch.Size([6, 550])
Invalid bert_input shape:torch.Size([5, 907])
| epoch 076:  17000 / 49553 loss=3.881, nll_loss=2.218, ppl=4.65, wps=57344, ups=5, wpb=10101.333, bsz=618.730, num_updates=423774, lr=4.85772e-05, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=8.000, wall=49249, train_wall=382720
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 076:  18000 / 49553 loss=3.881, nll_loss=2.219, ppl=4.66, wps=57386, ups=5, wpb=10104.696, bsz=618.324, num_updates=424773, lr=4.85201e-05, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=4.000, wall=49424, train_wall=382875
| epoch 076:  19000 / 49553 loss=3.882, nll_loss=2.220, ppl=4.66, wps=57382, ups=5, wpb=10102.609, bsz=618.519, num_updates=425773, lr=4.84631e-05, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=4.000, wall=49599, train_wall=383032
| epoch 076:  20000 / 49553 loss=3.882, nll_loss=2.220, ppl=4.66, wps=57371, ups=5, wpb=10103.402, bsz=618.644, num_updates=426773, lr=4.84063e-05, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=4.000, wall=49776, train_wall=383189
| epoch 076:  21000 / 49553 loss=3.882, nll_loss=2.220, ppl=4.66, wps=57392, ups=5, wpb=10102.514, bsz=618.688, num_updates=427773, lr=4.83496e-05, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=4.000, wall=49951, train_wall=383345
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([5, 627])
Invalid bert_input shape:torch.Size([7, 865])
| epoch 076:  22000 / 49553 loss=3.882, nll_loss=2.220, ppl=4.66, wps=57386, ups=5, wpb=10101.684, bsz=618.593, num_updates=428772, lr=4.82933e-05, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=4.000, wall=50127, train_wall=383502
Invalid bert_input shape:torch.Size([6, 863])
Invalid bert_input shape:torch.Size([4, 776])
| epoch 076:  23000 / 49553 loss=3.882, nll_loss=2.220, ppl=4.66, wps=57382, ups=5, wpb=10100.831, bsz=618.544, num_updates=429772, lr=4.82371e-05, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=4.000, wall=50303, train_wall=383658
| epoch 076:  24000 / 49553 loss=3.883, nll_loss=2.221, ppl=4.66, wps=57403, ups=6, wpb=10100.617, bsz=618.266, num_updates=430772, lr=4.81811e-05, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=4.000, wall=50477, train_wall=383813
Invalid bert_input shape:torch.Size([5, 666])
| epoch 076:  25000 / 49553 loss=3.883, nll_loss=2.221, ppl=4.66, wps=57389, ups=6, wpb=10103.874, bsz=618.068, num_updates=431772, lr=4.81252e-05, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=4.000, wall=50656, train_wall=383973
| epoch 076:  26000 / 49553 loss=3.883, nll_loss=2.221, ppl=4.66, wps=57342, ups=6, wpb=10102.834, bsz=618.360, num_updates=432772, lr=4.80696e-05, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=8.000, wall=50835, train_wall=384134
| epoch 076:  27000 / 49553 loss=3.883, nll_loss=2.221, ppl=4.66, wps=57304, ups=6, wpb=10102.663, bsz=617.998, num_updates=433772, lr=4.80141e-05, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=8.000, wall=51014, train_wall=384294
Invalid bert_input shape:torch.Size([5, 869])
| epoch 076:  28000 / 49553 loss=3.883, nll_loss=2.221, ppl=4.66, wps=57282, ups=6, wpb=10103.352, bsz=618.526, num_updates=434772, lr=4.79589e-05, gnorm=0.854, clip=0.000, oom=0.000, loss_scale=8.000, wall=51193, train_wall=384451
| epoch 076:  29000 / 49553 loss=3.883, nll_loss=2.221, ppl=4.66, wps=57257, ups=6, wpb=10103.398, bsz=618.739, num_updates=435772, lr=4.79038e-05, gnorm=0.855, clip=0.000, oom=0.000, loss_scale=8.000, wall=51371, train_wall=384610
Invalid bert_input shape:torch.Size([2, 1608])
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 076:  30000 / 49553 loss=3.882, nll_loss=2.220, ppl=4.66, wps=57273, ups=6, wpb=10103.852, bsz=618.530, num_updates=436771, lr=4.7849e-05, gnorm=0.855, clip=0.000, oom=0.000, loss_scale=8.000, wall=51546, train_wall=384766
| epoch 076:  31000 / 49553 loss=3.883, nll_loss=2.221, ppl=4.66, wps=57273, ups=6, wpb=10103.520, bsz=618.219, num_updates=437771, lr=4.77943e-05, gnorm=0.855, clip=0.000, oom=0.000, loss_scale=8.000, wall=51723, train_wall=384922
| epoch 076:  32000 / 49553 loss=3.883, nll_loss=2.221, ppl=4.66, wps=57277, ups=6, wpb=10104.076, bsz=617.987, num_updates=438771, lr=4.77398e-05, gnorm=0.855, clip=0.000, oom=0.000, loss_scale=8.000, wall=51899, train_wall=385078
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 076:  33000 / 49553 loss=3.883, nll_loss=2.221, ppl=4.66, wps=57279, ups=6, wpb=10103.255, bsz=617.791, num_updates=439770, lr=4.76856e-05, gnorm=0.855, clip=0.000, oom=0.000, loss_scale=4.000, wall=52075, train_wall=385235
| epoch 076:  34000 / 49553 loss=3.883, nll_loss=2.221, ppl=4.66, wps=57251, ups=6, wpb=10101.700, bsz=618.115, num_updates=440770, lr=4.76315e-05, gnorm=0.855, clip=0.000, oom=0.000, loss_scale=4.000, wall=52253, train_wall=385395
Invalid bert_input shape:torch.Size([2, 1513])
| epoch 076:  35000 / 49553 loss=3.883, nll_loss=2.221, ppl=4.66, wps=57264, ups=6, wpb=10102.143, bsz=617.750, num_updates=441770, lr=4.75775e-05, gnorm=0.855, clip=0.000, oom=0.000, loss_scale=4.000, wall=52428, train_wall=385551
| epoch 076:  36000 / 49553 loss=3.883, nll_loss=2.221, ppl=4.66, wps=57286, ups=6, wpb=10103.119, bsz=618.103, num_updates=442770, lr=4.75238e-05, gnorm=0.855, clip=0.000, oom=0.000, loss_scale=4.000, wall=52603, train_wall=385706
Invalid bert_input shape:torch.Size([4, 837])
| epoch 076:  37000 / 49553 loss=3.883, nll_loss=2.221, ppl=4.66, wps=57282, ups=6, wpb=10102.004, bsz=618.392, num_updates=443770, lr=4.74702e-05, gnorm=0.855, clip=0.000, oom=0.000, loss_scale=8.000, wall=52779, train_wall=385863
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([4, 858])
Invalid bert_input shape:torch.Size([4, 1167])
| epoch 076:  38000 / 49553 loss=3.883, nll_loss=2.222, ppl=4.66, wps=57281, ups=6, wpb=10102.308, bsz=618.487, num_updates=444769, lr=4.74169e-05, gnorm=0.856, clip=0.000, oom=0.000, loss_scale=4.000, wall=52955, train_wall=386019
| epoch 076:  39000 / 49553 loss=3.884, nll_loss=2.222, ppl=4.67, wps=57278, ups=6, wpb=10102.704, bsz=618.119, num_updates=445769, lr=4.73636e-05, gnorm=0.856, clip=0.000, oom=0.000, loss_scale=4.000, wall=53132, train_wall=386176
| epoch 076:  40000 / 49553 loss=3.884, nll_loss=2.222, ppl=4.67, wps=57294, ups=6, wpb=10104.191, bsz=617.756, num_updates=446769, lr=4.73106e-05, gnorm=0.856, clip=0.000, oom=0.000, loss_scale=4.000, wall=53308, train_wall=386334
| epoch 076:  41000 / 49553 loss=3.884, nll_loss=2.222, ppl=4.67, wps=57301, ups=6, wpb=10104.431, bsz=617.745, num_updates=447769, lr=4.72577e-05, gnorm=0.856, clip=0.000, oom=0.000, loss_scale=4.000, wall=53483, train_wall=386490
Invalid bert_input shape:torch.Size([4, 720])
Invalid bert_input shape:torch.Size([3, 1514])
| WARNING: overflow detected, setting loss scale to: 4.0
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 076:  42000 / 49553 loss=3.884, nll_loss=2.223, ppl=4.67, wps=57275, ups=6, wpb=10103.799, bsz=618.084, num_updates=448767, lr=4.72052e-05, gnorm=0.856, clip=0.000, oom=0.000, loss_scale=2.000, wall=53662, train_wall=386649
Invalid bert_input shape:torch.Size([5, 636])
| epoch 076:  43000 / 49553 loss=3.884, nll_loss=2.223, ppl=4.67, wps=57277, ups=6, wpb=10103.413, bsz=618.152, num_updates=449767, lr=4.71527e-05, gnorm=0.856, clip=0.000, oom=0.000, loss_scale=2.000, wall=53838, train_wall=386806
| epoch 076:  44000 / 49553 loss=3.884, nll_loss=2.222, ppl=4.67, wps=57287, ups=6, wpb=10102.986, bsz=618.156, num_updates=450767, lr=4.71003e-05, gnorm=0.856, clip=0.000, oom=0.000, loss_scale=2.000, wall=54013, train_wall=386962
| epoch 076:  45000 / 49553 loss=3.884, nll_loss=2.223, ppl=4.67, wps=57284, ups=6, wpb=10102.678, bsz=618.396, num_updates=451767, lr=4.70482e-05, gnorm=0.856, clip=0.000, oom=0.000, loss_scale=2.000, wall=54190, train_wall=387121
Invalid bert_input shape:torch.Size([6, 784])
| epoch 076:  46000 / 49553 loss=3.884, nll_loss=2.223, ppl=4.67, wps=57270, ups=6, wpb=10102.140, bsz=618.366, num_updates=452767, lr=4.69962e-05, gnorm=0.856, clip=0.000, oom=0.000, loss_scale=4.000, wall=54367, train_wall=387280
| epoch 076:  47000 / 49553 loss=3.885, nll_loss=2.223, ppl=4.67, wps=57267, ups=6, wpb=10100.611, bsz=618.767, num_updates=453767, lr=4.69444e-05, gnorm=0.857, clip=0.000, oom=0.000, loss_scale=4.000, wall=54543, train_wall=387436
| epoch 076:  48000 / 49553 loss=3.885, nll_loss=2.224, ppl=4.67, wps=57279, ups=6, wpb=10101.227, bsz=618.706, num_updates=454767, lr=4.68927e-05, gnorm=0.857, clip=0.000, oom=0.000, loss_scale=4.000, wall=54718, train_wall=387593
Invalid bert_input shape:torch.Size([7, 722])
| epoch 076:  49000 / 49553 loss=3.885, nll_loss=2.224, ppl=4.67, wps=57276, ups=6, wpb=10100.644, bsz=618.805, num_updates=455767, lr=4.68413e-05, gnorm=0.857, clip=0.000, oom=0.000, loss_scale=4.000, wall=54894, train_wall=387750
Invalid bert_input shape:torch.Size([7, 790])
| epoch 076 | loss 3.885 | nll_loss 2.223 | ppl 4.67 | wps 57281 | ups 6 | wpb 10099.997 | bsz 618.688 | num_updates 456319 | lr 4.68129e-05 | gnorm 0.857 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 54990 | train_wall 387836
| epoch 076 | valid on 'valid' subset | loss 2.774 | nll_loss 0.965 | ppl 1.95 | num_updates 456319 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint76.pt (epoch 76 @ 456319 updates) (writing took 8.909730195999146 seconds)
| epoch 077:   1000 / 49553 loss=3.879, nll_loss=2.216, ppl=4.65, wps=57222, ups=3, wpb=10125.505, bsz=620.803, num_updates=457320, lr=4.67617e-05, gnorm=0.860, clip=0.000, oom=0.000, loss_scale=8.000, wall=55307, train_wall=388004
Invalid bert_input shape:torch.Size([3, 1160])
Invalid bert_input shape:torch.Size([7, 865])
Invalid bert_input shape:torch.Size([6, 1334])
| epoch 077:   2000 / 49553 loss=3.876, nll_loss=2.213, ppl=4.64, wps=57580, ups=4, wpb=10154.493, bsz=617.899, num_updates=458320, lr=4.67106e-05, gnorm=0.861, clip=0.000, oom=0.000, loss_scale=8.000, wall=55483, train_wall=388162
Invalid bert_input shape:torch.Size([5, 644])
Invalid bert_input shape:torch.Size([4, 864])
| epoch 077:   3000 / 49553 loss=3.871, nll_loss=2.207, ppl=4.62, wps=57582, ups=4, wpb=10127.480, bsz=619.131, num_updates=459320, lr=4.66597e-05, gnorm=0.861, clip=0.000, oom=0.000, loss_scale=8.000, wall=55658, train_wall=388318
Invalid bert_input shape:torch.Size([5, 704])
| epoch 077:   4000 / 49553 loss=3.872, nll_loss=2.209, ppl=4.62, wps=57743, ups=5, wpb=10133.338, bsz=618.801, num_updates=460320, lr=4.6609e-05, gnorm=0.861, clip=0.000, oom=0.000, loss_scale=8.000, wall=55832, train_wall=388475
Invalid bert_input shape:torch.Size([6, 555])
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 077:   5000 / 49553 loss=3.873, nll_loss=2.210, ppl=4.63, wps=57582, ups=5, wpb=10119.840, bsz=616.849, num_updates=461319, lr=4.65585e-05, gnorm=0.863, clip=0.000, oom=0.000, loss_scale=8.000, wall=56009, train_wall=388633
Invalid bert_input shape:torch.Size([4, 832])
Invalid bert_input shape:torch.Size([8, 1356])
| epoch 077:   6000 / 49553 loss=3.873, nll_loss=2.211, ppl=4.63, wps=57634, ups=5, wpb=10117.273, bsz=616.694, num_updates=462319, lr=4.65082e-05, gnorm=0.863, clip=0.000, oom=0.000, loss_scale=8.000, wall=56184, train_wall=388789
| epoch 077:   7000 / 49553 loss=3.875, nll_loss=2.212, ppl=4.63, wps=57715, ups=5, wpb=10121.300, bsz=618.004, num_updates=463319, lr=4.64579e-05, gnorm=0.862, clip=0.000, oom=0.000, loss_scale=8.000, wall=56358, train_wall=388944
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 077:   8000 / 49553 loss=3.875, nll_loss=2.212, ppl=4.63, wps=57659, ups=5, wpb=10122.145, bsz=617.480, num_updates=464318, lr=4.64079e-05, gnorm=0.863, clip=0.000, oom=0.000, loss_scale=4.000, wall=56535, train_wall=389102
| epoch 077:   9000 / 49553 loss=3.874, nll_loss=2.211, ppl=4.63, wps=57688, ups=5, wpb=10119.886, bsz=616.954, num_updates=465318, lr=4.6358e-05, gnorm=0.862, clip=0.000, oom=0.000, loss_scale=4.000, wall=56709, train_wall=389258
| epoch 077:  10000 / 49553 loss=3.874, nll_loss=2.212, ppl=4.63, wps=57688, ups=5, wpb=10115.862, bsz=617.415, num_updates=466318, lr=4.63083e-05, gnorm=0.863, clip=0.000, oom=0.000, loss_scale=4.000, wall=56884, train_wall=389414
Invalid bert_input shape:torch.Size([3, 1184])
Invalid bert_input shape:torch.Size([4, 858])
| epoch 077:  11000 / 49553 loss=3.875, nll_loss=2.212, ppl=4.63, wps=57613, ups=5, wpb=10103.771, bsz=617.749, num_updates=467318, lr=4.62587e-05, gnorm=0.864, clip=0.000, oom=0.000, loss_scale=4.000, wall=57059, train_wall=389572
Invalid bert_input shape:torch.Size([5, 638])
| epoch 077:  12000 / 49553 loss=3.875, nll_loss=2.212, ppl=4.63, wps=57598, ups=5, wpb=10100.647, bsz=618.660, num_updates=468318, lr=4.62093e-05, gnorm=0.864, clip=0.000, oom=0.000, loss_scale=4.000, wall=57235, train_wall=389728
| epoch 077:  13000 / 49553 loss=3.875, nll_loss=2.212, ppl=4.63, wps=57563, ups=5, wpb=10093.001, bsz=618.831, num_updates=469318, lr=4.61601e-05, gnorm=0.865, clip=0.000, oom=0.000, loss_scale=8.000, wall=57410, train_wall=389885
Invalid bert_input shape:torch.Size([4, 859])
| epoch 077:  14000 / 49553 loss=3.875, nll_loss=2.212, ppl=4.63, wps=57509, ups=5, wpb=10092.278, bsz=619.240, num_updates=470318, lr=4.6111e-05, gnorm=0.865, clip=0.000, oom=0.000, loss_scale=8.000, wall=57587, train_wall=390043
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 077:  15000 / 49553 loss=3.875, nll_loss=2.213, ppl=4.64, wps=57503, ups=5, wpb=10093.296, bsz=618.726, num_updates=471317, lr=4.60621e-05, gnorm=0.865, clip=0.000, oom=0.000, loss_scale=4.000, wall=57763, train_wall=390200
Invalid bert_input shape:torch.Size([4, 823])
| epoch 077:  16000 / 49553 loss=3.878, nll_loss=2.216, ppl=4.65, wps=57544, ups=5, wpb=10097.594, bsz=618.397, num_updates=472317, lr=4.60133e-05, gnorm=0.865, clip=0.000, oom=0.000, loss_scale=4.000, wall=57938, train_wall=390356
| epoch 077:  17000 / 49553 loss=3.877, nll_loss=2.215, ppl=4.64, wps=57520, ups=5, wpb=10098.107, bsz=618.502, num_updates=473317, lr=4.59646e-05, gnorm=0.865, clip=0.000, oom=0.000, loss_scale=4.000, wall=58114, train_wall=390514
| epoch 077:  18000 / 49553 loss=3.877, nll_loss=2.214, ppl=4.64, wps=57490, ups=5, wpb=10092.356, bsz=618.775, num_updates=474317, lr=4.59162e-05, gnorm=0.866, clip=0.000, oom=0.000, loss_scale=4.000, wall=58290, train_wall=390670
| epoch 077:  19000 / 49553 loss=3.877, nll_loss=2.214, ppl=4.64, wps=57507, ups=5, wpb=10092.101, bsz=618.269, num_updates=475317, lr=4.58678e-05, gnorm=0.866, clip=0.000, oom=0.000, loss_scale=8.000, wall=58464, train_wall=390827
Invalid bert_input shape:torch.Size([7, 722])
| epoch 077:  20000 / 49553 loss=3.877, nll_loss=2.214, ppl=4.64, wps=57455, ups=5, wpb=10089.355, bsz=618.537, num_updates=476317, lr=4.58197e-05, gnorm=0.866, clip=0.000, oom=0.000, loss_scale=8.000, wall=58642, train_wall=390986
Invalid bert_input shape:torch.Size([4, 721])
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 077:  21000 / 49553 loss=3.876, nll_loss=2.214, ppl=4.64, wps=57466, ups=5, wpb=10087.839, bsz=618.391, num_updates=477316, lr=4.57717e-05, gnorm=0.866, clip=0.000, oom=0.000, loss_scale=4.000, wall=58816, train_wall=391142
| epoch 077:  22000 / 49553 loss=3.877, nll_loss=2.215, ppl=4.64, wps=57491, ups=5, wpb=10091.081, bsz=618.126, num_updates=478316, lr=4.57238e-05, gnorm=0.866, clip=0.000, oom=0.000, loss_scale=4.000, wall=58991, train_wall=391299
| epoch 077:  23000 / 49553 loss=3.877, nll_loss=2.215, ppl=4.64, wps=57473, ups=6, wpb=10090.407, bsz=618.320, num_updates=479316, lr=4.56761e-05, gnorm=0.866, clip=0.000, oom=0.000, loss_scale=4.000, wall=59168, train_wall=391456
Invalid bert_input shape:torch.Size([6, 878])
| epoch 077:  24000 / 49553 loss=3.877, nll_loss=2.214, ppl=4.64, wps=57487, ups=6, wpb=10090.014, bsz=618.325, num_updates=480316, lr=4.56285e-05, gnorm=0.866, clip=0.000, oom=0.000, loss_scale=4.000, wall=59342, train_wall=391612
| epoch 077:  25000 / 49553 loss=3.876, nll_loss=2.214, ppl=4.64, wps=57487, ups=6, wpb=10089.027, bsz=618.326, num_updates=481316, lr=4.55811e-05, gnorm=0.866, clip=0.000, oom=0.000, loss_scale=8.000, wall=59517, train_wall=391769
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([4, 1167])
| epoch 077:  26000 / 49553 loss=3.876, nll_loss=2.214, ppl=4.64, wps=57473, ups=6, wpb=10087.735, bsz=618.037, num_updates=482315, lr=4.55339e-05, gnorm=0.867, clip=0.000, oom=0.000, loss_scale=4.000, wall=59693, train_wall=391926
| epoch 077:  27000 / 49553 loss=3.877, nll_loss=2.215, ppl=4.64, wps=57488, ups=6, wpb=10087.505, bsz=617.926, num_updates=483315, lr=4.54867e-05, gnorm=0.867, clip=0.000, oom=0.000, loss_scale=4.000, wall=59867, train_wall=392082
Invalid bert_input shape:torch.Size([2, 1562])
Invalid bert_input shape:torch.Size([5, 602])
| epoch 077:  28000 / 49553 loss=3.877, nll_loss=2.215, ppl=4.64, wps=57489, ups=6, wpb=10088.197, bsz=618.298, num_updates=484315, lr=4.54398e-05, gnorm=0.867, clip=0.000, oom=0.000, loss_scale=4.000, wall=60043, train_wall=392239
| epoch 077:  29000 / 49553 loss=3.877, nll_loss=2.215, ppl=4.64, wps=57493, ups=6, wpb=10089.816, bsz=618.253, num_updates=485315, lr=4.53929e-05, gnorm=0.867, clip=0.000, oom=0.000, loss_scale=4.000, wall=60219, train_wall=392396
Invalid bert_input shape:torch.Size([5, 869])
| epoch 077:  30000 / 49553 loss=3.877, nll_loss=2.215, ppl=4.64, wps=57471, ups=6, wpb=10089.463, bsz=617.893, num_updates=486315, lr=4.53462e-05, gnorm=0.867, clip=0.000, oom=0.000, loss_scale=8.000, wall=60396, train_wall=392555
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 077:  31000 / 49553 loss=3.877, nll_loss=2.215, ppl=4.64, wps=57481, ups=6, wpb=10090.422, bsz=618.142, num_updates=487314, lr=4.52997e-05, gnorm=0.867, clip=0.000, oom=0.000, loss_scale=4.000, wall=60571, train_wall=392712
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 077:  32000 / 49553 loss=3.877, nll_loss=2.215, ppl=4.64, wps=57440, ups=6, wpb=10087.230, bsz=618.076, num_updates=488313, lr=4.52534e-05, gnorm=0.867, clip=0.000, oom=0.000, loss_scale=2.000, wall=60749, train_wall=392870
Invalid bert_input shape:torch.Size([5, 656])
| epoch 077:  33000 / 49553 loss=3.877, nll_loss=2.215, ppl=4.64, wps=57439, ups=6, wpb=10087.503, bsz=618.206, num_updates=489313, lr=4.52071e-05, gnorm=0.867, clip=0.000, oom=0.000, loss_scale=2.000, wall=60925, train_wall=393026
Invalid bert_input shape:torch.Size([7, 573])
| epoch 077:  34000 / 49553 loss=3.877, nll_loss=2.215, ppl=4.64, wps=57433, ups=6, wpb=10089.355, bsz=618.293, num_updates=490313, lr=4.5161e-05, gnorm=0.867, clip=0.000, oom=0.000, loss_scale=2.000, wall=61102, train_wall=393183
Invalid bert_input shape:torch.Size([5, 817])
| epoch 077:  35000 / 49553 loss=3.877, nll_loss=2.215, ppl=4.64, wps=57445, ups=6, wpb=10091.819, bsz=618.615, num_updates=491313, lr=4.5115e-05, gnorm=0.868, clip=0.000, oom=0.000, loss_scale=2.000, wall=61278, train_wall=393340
Invalid bert_input shape:torch.Size([6, 896])
| epoch 077:  36000 / 49553 loss=3.877, nll_loss=2.215, ppl=4.64, wps=57462, ups=6, wpb=10093.900, bsz=618.211, num_updates=492313, lr=4.50691e-05, gnorm=0.868, clip=0.000, oom=0.000, loss_scale=4.000, wall=61453, train_wall=393498
| epoch 077:  37000 / 49553 loss=3.878, nll_loss=2.216, ppl=4.64, wps=57489, ups=6, wpb=10097.765, bsz=618.126, num_updates=493313, lr=4.50234e-05, gnorm=0.868, clip=0.000, oom=0.000, loss_scale=4.000, wall=61628, train_wall=393654
Invalid bert_input shape:torch.Size([4, 843])
| epoch 077:  38000 / 49553 loss=3.877, nll_loss=2.215, ppl=4.64, wps=57480, ups=6, wpb=10096.807, bsz=618.336, num_updates=494313, lr=4.49779e-05, gnorm=0.868, clip=0.000, oom=0.000, loss_scale=4.000, wall=61804, train_wall=393811
Invalid bert_input shape:torch.Size([6, 575])
| epoch 077:  39000 / 49553 loss=3.877, nll_loss=2.215, ppl=4.64, wps=57495, ups=6, wpb=10096.965, bsz=618.651, num_updates=495313, lr=4.49325e-05, gnorm=0.868, clip=0.000, oom=0.000, loss_scale=4.000, wall=61978, train_wall=393967
| epoch 077:  40000 / 49553 loss=3.877, nll_loss=2.215, ppl=4.64, wps=57503, ups=6, wpb=10099.080, bsz=618.676, num_updates=496313, lr=4.48872e-05, gnorm=0.868, clip=0.000, oom=0.000, loss_scale=8.000, wall=62154, train_wall=394125
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 077:  41000 / 49553 loss=3.878, nll_loss=2.216, ppl=4.65, wps=57509, ups=6, wpb=10099.386, bsz=618.717, num_updates=497312, lr=4.48421e-05, gnorm=0.868, clip=0.000, oom=0.000, loss_scale=4.000, wall=62329, train_wall=394281
| epoch 077:  42000 / 49553 loss=3.878, nll_loss=2.216, ppl=4.65, wps=57520, ups=6, wpb=10099.522, bsz=618.610, num_updates=498312, lr=4.4797e-05, gnorm=0.868, clip=0.000, oom=0.000, loss_scale=4.000, wall=62504, train_wall=394437
Invalid bert_input shape:torch.Size([5, 703])
| epoch 077:  43000 / 49553 loss=3.878, nll_loss=2.216, ppl=4.65, wps=57523, ups=6, wpb=10100.221, bsz=618.560, num_updates=499312, lr=4.47522e-05, gnorm=0.869, clip=0.000, oom=0.000, loss_scale=4.000, wall=62679, train_wall=394594
Invalid bert_input shape:torch.Size([4, 720])
| epoch 077:  44000 / 49553 loss=3.878, nll_loss=2.216, ppl=4.65, wps=57511, ups=6, wpb=10099.055, bsz=618.729, num_updates=500312, lr=4.47074e-05, gnorm=0.869, clip=0.000, oom=0.000, loss_scale=4.000, wall=62856, train_wall=394749
| epoch 077:  45000 / 49553 loss=3.878, nll_loss=2.216, ppl=4.65, wps=57507, ups=6, wpb=10099.920, bsz=618.623, num_updates=501312, lr=4.46628e-05, gnorm=0.869, clip=0.000, oom=0.000, loss_scale=8.000, wall=63032, train_wall=394902
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 077:  46000 / 49553 loss=3.878, nll_loss=2.216, ppl=4.65, wps=57503, ups=6, wpb=10100.418, bsz=618.712, num_updates=502311, lr=4.46184e-05, gnorm=0.868, clip=0.000, oom=0.000, loss_scale=4.000, wall=63209, train_wall=395059
Invalid bert_input shape:torch.Size([5, 795])
| epoch 077:  47000 / 49553 loss=3.878, nll_loss=2.216, ppl=4.65, wps=57511, ups=6, wpb=10099.722, bsz=618.685, num_updates=503311, lr=4.4574e-05, gnorm=0.869, clip=0.000, oom=0.000, loss_scale=4.000, wall=63383, train_wall=395214
| epoch 077:  48000 / 49553 loss=3.878, nll_loss=2.217, ppl=4.65, wps=57531, ups=6, wpb=10101.857, bsz=618.797, num_updates=504311, lr=4.45298e-05, gnorm=0.869, clip=0.000, oom=0.000, loss_scale=4.000, wall=63557, train_wall=395370
| epoch 077:  49000 / 49553 loss=3.878, nll_loss=2.216, ppl=4.65, wps=57525, ups=6, wpb=10101.433, bsz=618.575, num_updates=505311, lr=4.44857e-05, gnorm=0.869, clip=0.000, oom=0.000, loss_scale=4.000, wall=63733, train_wall=395528
| epoch 077 | loss 3.878 | nll_loss 2.216 | ppl 4.65 | wps 57524 | ups 6 | wpb 10100.081 | bsz 618.657 | num_updates 505863 | lr 4.44614e-05 | gnorm 0.869 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 63829 | train_wall 395614
| epoch 077 | valid on 'valid' subset | loss 2.764 | nll_loss 0.947 | ppl 1.93 | num_updates 505863 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint77.pt (epoch 77 @ 505863 updates) (writing took 8.391266584396362 seconds)
| epoch 078:   1000 / 49553 loss=3.859, nll_loss=2.195, ppl=4.58, wps=57438, ups=3, wpb=9995.413, bsz=635.165, num_updates=506864, lr=4.44175e-05, gnorm=0.874, clip=0.000, oom=0.000, loss_scale=8.000, wall=64135, train_wall=395769
| WARNING: overflow detected, setting loss scale to: 4.0
| WARNING: overflow detected, setting loss scale to: 2.0
Invalid bert_input shape:torch.Size([5, 638])
| epoch 078:   2000 / 49553 loss=3.859, nll_loss=2.194, ppl=4.58, wps=57486, ups=4, wpb=10087.141, bsz=623.148, num_updates=507862, lr=4.43739e-05, gnorm=0.874, clip=0.000, oom=0.000, loss_scale=2.000, wall=64311, train_wall=395926
| epoch 078:   3000 / 49553 loss=3.865, nll_loss=2.201, ppl=4.60, wps=57211, ups=5, wpb=10095.872, bsz=622.146, num_updates=508862, lr=4.43302e-05, gnorm=0.874, clip=0.000, oom=0.000, loss_scale=2.000, wall=64490, train_wall=396086
| distributed init (rank 0): tcp://localhost:12088
| distributed init (rank 3): tcp://localhost:12088
| distributed init (rank 1): tcp://localhost:12088
| distributed init (rank 2): tcp://localhost:12088
| initialized host r03g07.bullx as rank 0
| initialized host r03g07.bullx as rank 3
| initialized host r03g07.bullx as rank 2
| initialized host r03g07.bullx as rank 1
Namespace(activation_dropout=0.0, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, arch='transformer_vaswani_wmt_en_de_big', attention_dropout=0.0, bert_first=True, bert_gates=[1, 1, 1, 1, 1, 1], bert_model_name='/scratch/project_2003453/bert-base-finnish-uncased-v1', bert_output_layer=-1, bert_ratio=1.0, bucket_cap_mb=25, clip_norm=25, cpu=False, criterion='label_smoothed_cross_entropy', curriculum=0, data='/scratch/project_2003453/bertnmt_data', dataset_impl='cached', ddp_backend='c10d', decoder_attention_heads=16, decoder_embed_dim=1024, decoder_embed_path=None, decoder_ffn_embed_dim=4096, decoder_input_dim=1024, decoder_layers=6, decoder_learned_pos=False, decoder_no_bert=False, decoder_normalize_before=False, decoder_output_dim=1024, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method='tcp://localhost:12088', distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=4, dropout=0.3, encoder_attention_heads=16, encoder_bert_dropout=True, encoder_bert_dropout_ratio=0.5, encoder_bert_mixup=False, encoder_embed_dim=1024, encoder_embed_path=None, encoder_ffn_embed_dim=4096, encoder_layers=6, encoder_learned_pos=False, encoder_normalize_before=False, encoder_ratio=1.0, find_unused_parameters=False, finetune_bert=False, fix_batches_to_gpus=False, fp16=True, fp16_init_scale=128, fp16_scale_tolerance=0.0, fp16_scale_window=None, keep_interval_updates=-1, keep_last_epochs=-1, label_smoothing=0.1, lazy_load=False, left_pad_source='True', left_pad_target='False', log_format=None, log_interval=1000, lr=[0.0005], lr_scheduler='inverse_sqrt', mask_cls_sep=False, max_epoch=0, max_sentences=None, max_sentences_valid=None, max_source_positions=1024, max_target_positions=1024, max_tokens=3584, max_update=0, memory_efficient_fp16=False, min_loss_scale=0.0001, min_lr=1e-09, no_epoch_checkpoints=False, no_progress_bar=False, no_save=False, no_token_positional_embeddings=False, num_workers=0, optimizer='adam', optimizer_overrides='{}', raw_text=False, required_batch_size_multiple=8, reset_dataloader=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='/scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv', save_interval=1, save_interval_updates=0, seed=1, sentence_avg=False, share_all_embeddings=True, share_decoder_input_output_embed=False, skip_invalid_size_inputs_valid_test=False, source_lang='fi', target_lang='sv', task='translation', tbmf_wrapper=False, tensorboard_logdir='', threshold_loss_scale=None, train_subset='train', update_freq=[1], upsample_primary=1, user_dir=None, valid_subset='valid', validate_interval=1, warmup_from_nmt=False, warmup_init_lr=1e-07, warmup_nmt_file='checkpoint_nmt.pt', warmup_updates=4000, weight_decay=0.0001)
| [fi] dictionary: 37752 types
| [sv] dictionary: 37752 types
| /scratch/project_2003453/bertnmt_data valid fi-sv 5000 examples
bert_gates [True, True, True, True, True, True]
TransformerModel(
  (encoder): TransformerEncoder(
    (embed_tokens): Embedding(37752, 1024, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (decoder): TransformerDecoder(
    (embed_tokens): Embedding(37752, 1024, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (4): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (5): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (bert_encoder): BertModel(
    (embeddings): BertEmbeddings(
      (word_embeddings): Embedding(50101, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): BertEncoder(
      (layer): ModuleList(
        (0): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
)
| model transformer_vaswani_wmt_en_de_big, criterion LabelSmoothedCrossEntropyCriterion
| num. model params: 361579008 (num. trained: 237060096)
| training on 4 GPUs
| max tokens per GPU = 3584 and max sentences per GPU = None
| loaded checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint_last.pt (epoch 77 @ 505863 updates)
| loading train data for epoch 77
| /scratch/project_2003453/bertnmt_data train fi-sv 30659795 examples
| epoch 078:   1000 / 49553 loss=3.862, nll_loss=2.198, ppl=4.59, wps=56692, ups=2, wpb=9995.413, bsz=635.165, num_updates=506864, lr=4.44175e-05, gnorm=0.877, clip=0.000, oom=0.000, loss_scale=4.000, wall=608, train_wall=395770
Invalid bert_input shape:torch.Size([5, 638])
| epoch 078:   2000 / 49553 loss=3.858, nll_loss=2.194, ppl=4.58, wps=57403, ups=3, wpb=10087.576, bsz=623.416, num_updates=507864, lr=4.43738e-05, gnorm=0.873, clip=0.000, oom=0.000, loss_scale=4.000, wall=784, train_wall=395926
| epoch 078:   3000 / 49553 loss=3.866, nll_loss=2.202, ppl=4.60, wps=57457, ups=3, wpb=10096.156, bsz=622.326, num_updates=508864, lr=4.43301e-05, gnorm=0.876, clip=0.000, oom=0.000, loss_scale=4.000, wall=959, train_wall=396081
| epoch 078:   4000 / 49553 loss=3.860, nll_loss=2.196, ppl=4.58, wps=57547, ups=4, wpb=10113.171, bsz=624.522, num_updates=509864, lr=4.42866e-05, gnorm=0.874, clip=0.000, oom=0.000, loss_scale=4.000, wall=1135, train_wall=396237
Invalid bert_input shape:torch.Size([4, 720])
| epoch 078:   5000 / 49553 loss=3.861, nll_loss=2.197, ppl=4.59, wps=57381, ups=4, wpb=10102.729, bsz=623.976, num_updates=510864, lr=4.42433e-05, gnorm=0.874, clip=0.000, oom=0.000, loss_scale=8.000, wall=1312, train_wall=396390
Invalid bert_input shape:torch.Size([4, 837])
| epoch 078:   6000 / 49553 loss=3.862, nll_loss=2.198, ppl=4.59, wps=57180, ups=4, wpb=10104.576, bsz=621.848, num_updates=511864, lr=4.42e-05, gnorm=0.875, clip=0.000, oom=0.000, loss_scale=8.000, wall=1492, train_wall=396547
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 078:   7000 / 49553 loss=3.863, nll_loss=2.200, ppl=4.59, wps=57312, ups=4, wpb=10113.570, bsz=621.411, num_updates=512863, lr=4.4157e-05, gnorm=0.874, clip=0.000, oom=0.000, loss_scale=4.000, wall=1667, train_wall=396704
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 078:   8000 / 49553 loss=3.865, nll_loss=2.202, ppl=4.60, wps=57367, ups=4, wpb=10121.270, bsz=620.078, num_updates=513862, lr=4.4114e-05, gnorm=0.874, clip=0.000, oom=0.000, loss_scale=2.000, wall=1843, train_wall=396860
| epoch 078:   9000 / 49553 loss=3.868, nll_loss=2.205, ppl=4.61, wps=57350, ups=4, wpb=10111.702, bsz=619.320, num_updates=514862, lr=4.40712e-05, gnorm=0.875, clip=0.000, oom=0.000, loss_scale=2.000, wall=2019, train_wall=397017
| epoch 078:  10000 / 49553 loss=3.868, nll_loss=2.205, ppl=4.61, wps=57396, ups=5, wpb=10108.360, bsz=618.640, num_updates=515862, lr=4.40284e-05, gnorm=0.876, clip=0.000, oom=0.000, loss_scale=2.000, wall=2193, train_wall=397174
Invalid bert_input shape:torch.Size([5, 656])
| epoch 078:  11000 / 49553 loss=3.869, nll_loss=2.206, ppl=4.62, wps=57456, ups=5, wpb=10107.727, bsz=618.533, num_updates=516862, lr=4.39858e-05, gnorm=0.876, clip=0.000, oom=0.000, loss_scale=2.000, wall=2367, train_wall=397330
| epoch 078:  12000 / 49553 loss=3.869, nll_loss=2.206, ppl=4.61, wps=57297, ups=5, wpb=10104.106, bsz=618.454, num_updates=517862, lr=4.39433e-05, gnorm=0.876, clip=0.000, oom=0.000, loss_scale=4.000, wall=2548, train_wall=397492
| epoch 078:  13000 / 49553 loss=3.869, nll_loss=2.206, ppl=4.61, wps=57245, ups=5, wpb=10104.169, bsz=618.202, num_updates=518862, lr=4.3901e-05, gnorm=0.876, clip=0.000, oom=0.000, loss_scale=4.000, wall=2726, train_wall=397652
| epoch 078:  14000 / 49553 loss=3.868, nll_loss=2.205, ppl=4.61, wps=57253, ups=5, wpb=10103.736, bsz=619.619, num_updates=519862, lr=4.38587e-05, gnorm=0.876, clip=0.000, oom=0.000, loss_scale=4.000, wall=2902, train_wall=397810
Invalid bert_input shape:torch.Size([6, 589])
| epoch 078:  15000 / 49553 loss=3.869, nll_loss=2.206, ppl=4.61, wps=57253, ups=5, wpb=10101.962, bsz=619.908, num_updates=520862, lr=4.38166e-05, gnorm=0.876, clip=0.000, oom=0.000, loss_scale=4.000, wall=3078, train_wall=397966
Invalid bert_input shape:torch.Size([4, 823])
Invalid bert_input shape:torch.Size([8, 844])
| epoch 078:  16000 / 49553 loss=3.869, nll_loss=2.206, ppl=4.61, wps=57197, ups=5, wpb=10101.606, bsz=620.343, num_updates=521862, lr=4.37746e-05, gnorm=0.876, clip=0.000, oom=0.000, loss_scale=8.000, wall=3257, train_wall=398126
| epoch 078:  17000 / 49553 loss=3.869, nll_loss=2.206, ppl=4.61, wps=57207, ups=5, wpb=10097.936, bsz=620.635, num_updates=522862, lr=4.37327e-05, gnorm=0.876, clip=0.000, oom=0.000, loss_scale=8.000, wall=3432, train_wall=398282
| epoch 078:  18000 / 49553 loss=3.868, nll_loss=2.205, ppl=4.61, wps=57207, ups=5, wpb=10101.218, bsz=620.758, num_updates=523862, lr=4.3691e-05, gnorm=0.876, clip=0.000, oom=0.000, loss_scale=8.000, wall=3610, train_wall=398441
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 078:  19000 / 49553 loss=3.868, nll_loss=2.205, ppl=4.61, wps=57208, ups=5, wpb=10104.560, bsz=620.065, num_updates=524861, lr=4.36494e-05, gnorm=0.876, clip=0.000, oom=0.000, loss_scale=4.000, wall=3787, train_wall=398600
| epoch 078:  20000 / 49553 loss=3.869, nll_loss=2.206, ppl=4.61, wps=57150, ups=5, wpb=10102.578, bsz=620.643, num_updates=525861, lr=4.36078e-05, gnorm=0.877, clip=0.000, oom=0.000, loss_scale=4.000, wall=3967, train_wall=398759
Invalid bert_input shape:torch.Size([4, 790])
| epoch 078:  21000 / 49553 loss=3.869, nll_loss=2.206, ppl=4.61, wps=57111, ups=5, wpb=10103.365, bsz=620.368, num_updates=526861, lr=4.35664e-05, gnorm=0.877, clip=0.000, oom=0.000, loss_scale=4.000, wall=4147, train_wall=398920
Invalid bert_input shape:torch.Size([4, 760])
| epoch 078:  22000 / 49553 loss=3.869, nll_loss=2.207, ppl=4.62, wps=57102, ups=5, wpb=10105.757, bsz=620.368, num_updates=527861, lr=4.35251e-05, gnorm=0.877, clip=0.000, oom=0.000, loss_scale=4.000, wall=4325, train_wall=399079
Invalid bert_input shape:torch.Size([7, 790])
| epoch 078:  23000 / 49553 loss=3.871, nll_loss=2.209, ppl=4.62, wps=57098, ups=5, wpb=10103.944, bsz=619.967, num_updates=528861, lr=4.3484e-05, gnorm=0.877, clip=0.000, oom=0.000, loss_scale=8.000, wall=4502, train_wall=399237
| epoch 078:  24000 / 49553 loss=3.871, nll_loss=2.208, ppl=4.62, wps=57098, ups=5, wpb=10105.469, bsz=619.993, num_updates=529861, lr=4.34429e-05, gnorm=0.877, clip=0.000, oom=0.000, loss_scale=8.000, wall=4679, train_wall=399396
Invalid bert_input shape:torch.Size([5, 703])
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 078:  25000 / 49553 loss=3.871, nll_loss=2.208, ppl=4.62, wps=57120, ups=5, wpb=10103.590, bsz=620.364, num_updates=530860, lr=4.3402e-05, gnorm=0.877, clip=0.000, oom=0.000, loss_scale=4.000, wall=4853, train_wall=399552
| epoch 078:  26000 / 49553 loss=3.871, nll_loss=2.208, ppl=4.62, wps=57113, ups=5, wpb=10103.902, bsz=619.698, num_updates=531860, lr=4.33612e-05, gnorm=0.877, clip=0.000, oom=0.000, loss_scale=4.000, wall=5031, train_wall=399711
| epoch 078:  27000 / 49553 loss=3.871, nll_loss=2.208, ppl=4.62, wps=57076, ups=5, wpb=10103.218, bsz=620.243, num_updates=532860, lr=4.33205e-05, gnorm=0.878, clip=0.000, oom=0.000, loss_scale=4.000, wall=5211, train_wall=399871
| epoch 078:  28000 / 49553 loss=3.871, nll_loss=2.208, ppl=4.62, wps=57090, ups=5, wpb=10101.685, bsz=620.287, num_updates=533860, lr=4.32799e-05, gnorm=0.878, clip=0.000, oom=0.000, loss_scale=4.000, wall=5386, train_wall=400028
| epoch 078:  29000 / 49553 loss=3.870, nll_loss=2.207, ppl=4.62, wps=57099, ups=5, wpb=10100.649, bsz=620.138, num_updates=534860, lr=4.32394e-05, gnorm=0.878, clip=0.000, oom=0.000, loss_scale=8.000, wall=5561, train_wall=400185
| epoch 078:  30000 / 49553 loss=3.870, nll_loss=2.207, ppl=4.62, wps=57115, ups=5, wpb=10101.116, bsz=620.312, num_updates=535860, lr=4.31991e-05, gnorm=0.878, clip=0.000, oom=0.000, loss_scale=8.000, wall=5737, train_wall=400343
| epoch 078:  31000 / 49553 loss=3.870, nll_loss=2.208, ppl=4.62, wps=57143, ups=5, wpb=10100.310, bsz=620.035, num_updates=536860, lr=4.31588e-05, gnorm=0.878, clip=0.000, oom=0.000, loss_scale=8.000, wall=5911, train_wall=400498
| epoch 078:  32000 / 49553 loss=3.871, nll_loss=2.208, ppl=4.62, wps=57137, ups=5, wpb=10097.224, bsz=620.039, num_updates=537860, lr=4.31187e-05, gnorm=0.878, clip=0.000, oom=0.000, loss_scale=8.000, wall=6086, train_wall=400656
| epoch 078:  33000 / 49553 loss=3.870, nll_loss=2.208, ppl=4.62, wps=57161, ups=5, wpb=10097.907, bsz=619.452, num_updates=538860, lr=4.30786e-05, gnorm=0.878, clip=0.000, oom=0.000, loss_scale=16.000, wall=6261, train_wall=400812
| WARNING: overflow detected, setting loss scale to: 8.0
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 078:  34000 / 49553 loss=3.870, nll_loss=2.208, ppl=4.62, wps=57139, ups=5, wpb=10098.042, bsz=619.648, num_updates=539858, lr=4.30388e-05, gnorm=0.879, clip=0.000, oom=0.000, loss_scale=4.000, wall=6440, train_wall=400972
| epoch 078:  35000 / 49553 loss=3.871, nll_loss=2.208, ppl=4.62, wps=57127, ups=5, wpb=10097.240, bsz=619.434, num_updates=540858, lr=4.2999e-05, gnorm=0.879, clip=0.000, oom=0.000, loss_scale=4.000, wall=6617, train_wall=401130
Invalid bert_input shape:torch.Size([5, 666])
Invalid bert_input shape:torch.Size([4, 758])
| epoch 078:  36000 / 49553 loss=3.871, nll_loss=2.209, ppl=4.62, wps=57145, ups=5, wpb=10098.062, bsz=619.210, num_updates=541858, lr=4.29593e-05, gnorm=0.879, clip=0.000, oom=0.000, loss_scale=4.000, wall=6792, train_wall=401288
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 078:  37000 / 49553 loss=3.872, nll_loss=2.210, ppl=4.63, wps=57158, ups=5, wpb=10098.083, bsz=619.186, num_updates=542857, lr=4.29198e-05, gnorm=0.879, clip=0.000, oom=0.000, loss_scale=2.000, wall=6968, train_wall=401445
| epoch 078:  38000 / 49553 loss=3.873, nll_loss=2.210, ppl=4.63, wps=57166, ups=5, wpb=10097.747, bsz=619.350, num_updates=543857, lr=4.28803e-05, gnorm=0.880, clip=0.000, oom=0.000, loss_scale=2.000, wall=7143, train_wall=401601
| epoch 078:  39000 / 49553 loss=3.873, nll_loss=2.210, ppl=4.63, wps=57175, ups=5, wpb=10096.913, bsz=619.249, num_updates=544857, lr=4.28409e-05, gnorm=0.880, clip=0.000, oom=0.000, loss_scale=2.000, wall=7318, train_wall=401757
| epoch 078:  40000 / 49553 loss=3.873, nll_loss=2.211, ppl=4.63, wps=57186, ups=5, wpb=10100.134, bsz=619.176, num_updates=545857, lr=4.28017e-05, gnorm=0.880, clip=0.000, oom=0.000, loss_scale=2.000, wall=7496, train_wall=401910
| epoch 078:  41000 / 49553 loss=3.873, nll_loss=2.211, ppl=4.63, wps=57156, ups=5, wpb=10099.286, bsz=619.303, num_updates=546857, lr=4.27625e-05, gnorm=0.880, clip=0.000, oom=0.000, loss_scale=4.000, wall=7675, train_wall=402063
| epoch 078:  42000 / 49553 loss=3.874, nll_loss=2.211, ppl=4.63, wps=57154, ups=5, wpb=10098.475, bsz=619.243, num_updates=547857, lr=4.27235e-05, gnorm=0.880, clip=0.000, oom=0.000, loss_scale=4.000, wall=7852, train_wall=402217
| epoch 078:  43000 / 49553 loss=3.874, nll_loss=2.212, ppl=4.63, wps=57170, ups=5, wpb=10098.453, bsz=619.161, num_updates=548857, lr=4.26845e-05, gnorm=0.881, clip=0.000, oom=0.000, loss_scale=4.000, wall=8026, train_wall=402372
| epoch 078:  44000 / 49553 loss=3.874, nll_loss=2.212, ppl=4.63, wps=57155, ups=5, wpb=10098.797, bsz=619.038, num_updates=549857, lr=4.26457e-05, gnorm=0.880, clip=0.000, oom=0.000, loss_scale=4.000, wall=8205, train_wall=402528
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 078:  45000 / 49553 loss=3.874, nll_loss=2.212, ppl=4.63, wps=57157, ups=5, wpb=10101.057, bsz=618.748, num_updates=550856, lr=4.2607e-05, gnorm=0.880, clip=0.000, oom=0.000, loss_scale=4.000, wall=8383, train_wall=402681
Invalid bert_input shape:torch.Size([4, 721])
| epoch 078:  46000 / 49553 loss=3.874, nll_loss=2.212, ppl=4.63, wps=57176, ups=5, wpb=10101.855, bsz=618.641, num_updates=551856, lr=4.25684e-05, gnorm=0.880, clip=0.000, oom=0.000, loss_scale=4.000, wall=8558, train_wall=402838
Invalid bert_input shape:torch.Size([6, 550])
| epoch 078:  47000 / 49553 loss=3.874, nll_loss=2.212, ppl=4.63, wps=57142, ups=5, wpb=10100.462, bsz=618.833, num_updates=552856, lr=4.25299e-05, gnorm=0.880, clip=0.000, oom=0.000, loss_scale=4.000, wall=8738, train_wall=403000
| epoch 078:  48000 / 49553 loss=3.874, nll_loss=2.212, ppl=4.63, wps=57136, ups=5, wpb=10099.783, bsz=618.871, num_updates=553856, lr=4.24915e-05, gnorm=0.881, clip=0.000, oom=0.000, loss_scale=4.000, wall=8915, train_wall=403158
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 078:  49000 / 49553 loss=3.874, nll_loss=2.212, ppl=4.63, wps=57143, ups=5, wpb=10099.626, bsz=618.727, num_updates=554855, lr=4.24532e-05, gnorm=0.881, clip=0.000, oom=0.000, loss_scale=4.000, wall=9091, train_wall=403316
| epoch 078 | loss 3.874 | nll_loss 2.212 | ppl 4.63 | wps 57155 | ups 5 | wpb 10100.018 | bsz 618.669 | num_updates 555407 | lr 4.24321e-05 | gnorm 0.881 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 9187 | train_wall 403402
| epoch 078 | valid on 'valid' subset | loss 2.748 | nll_loss 0.928 | ppl 1.90 | num_updates 555407 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint78.pt (epoch 78 @ 555407 updates) (writing took 11.672491073608398 seconds)
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 079:   1000 / 49553 loss=3.858, nll_loss=2.194, ppl=4.58, wps=57342, ups=3, wpb=10068.259, bsz=616.328, num_updates=556407, lr=4.23939e-05, gnorm=0.884, clip=0.000, oom=0.000, loss_scale=2.000, wall=9494, train_wall=403561
| epoch 079:   2000 / 49553 loss=3.857, nll_loss=2.193, ppl=4.57, wps=57574, ups=4, wpb=10075.190, bsz=622.311, num_updates=557407, lr=4.23559e-05, gnorm=0.882, clip=0.000, oom=0.000, loss_scale=2.000, wall=9669, train_wall=403717
Invalid bert_input shape:torch.Size([6, 863])
| epoch 079:   3000 / 49553 loss=3.854, nll_loss=2.189, ppl=4.56, wps=57568, ups=5, wpb=10068.968, bsz=622.543, num_updates=558407, lr=4.23179e-05, gnorm=0.886, clip=0.000, oom=0.000, loss_scale=2.000, wall=9844, train_wall=403873
| epoch 079:   4000 / 49553 loss=3.855, nll_loss=2.191, ppl=4.56, wps=57320, ups=5, wpb=10096.906, bsz=620.057, num_updates=559407, lr=4.22801e-05, gnorm=0.884, clip=0.000, oom=0.000, loss_scale=2.000, wall=10023, train_wall=404034
| epoch 079:   5000 / 49553 loss=3.859, nll_loss=2.195, ppl=4.58, wps=57448, ups=5, wpb=10101.431, bsz=620.289, num_updates=560407, lr=4.22424e-05, gnorm=0.887, clip=0.000, oom=0.000, loss_scale=4.000, wall=10198, train_wall=404191
Invalid bert_input shape:torch.Size([4, 720])
| epoch 079:   6000 / 49553 loss=3.860, nll_loss=2.196, ppl=4.58, wps=57410, ups=5, wpb=10085.395, bsz=622.987, num_updates=561407, lr=4.22047e-05, gnorm=0.887, clip=0.000, oom=0.000, loss_scale=4.000, wall=10373, train_wall=404347
| epoch 079:   7000 / 49553 loss=3.863, nll_loss=2.199, ppl=4.59, wps=57308, ups=5, wpb=10084.070, bsz=622.957, num_updates=562407, lr=4.21672e-05, gnorm=0.889, clip=0.000, oom=0.000, loss_scale=4.000, wall=10551, train_wall=404507
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 079:   8000 / 49553 loss=3.862, nll_loss=2.198, ppl=4.59, wps=57208, ups=5, wpb=10082.484, bsz=621.334, num_updates=563406, lr=4.21298e-05, gnorm=0.889, clip=0.000, oom=0.000, loss_scale=2.000, wall=10729, train_wall=404667
| epoch 079:   9000 / 49553 loss=3.861, nll_loss=2.197, ppl=4.58, wps=57201, ups=5, wpb=10083.431, bsz=620.713, num_updates=564406, lr=4.20924e-05, gnorm=0.889, clip=0.000, oom=0.000, loss_scale=2.000, wall=10905, train_wall=404824
| epoch 079:  10000 / 49553 loss=3.860, nll_loss=2.196, ppl=4.58, wps=57207, ups=5, wpb=10078.811, bsz=620.854, num_updates=565406, lr=4.20552e-05, gnorm=0.889, clip=0.000, oom=0.000, loss_scale=2.000, wall=11080, train_wall=404982
Invalid bert_input shape:torch.Size([4, 1167])
| epoch 079:  11000 / 49553 loss=3.861, nll_loss=2.198, ppl=4.59, wps=57239, ups=5, wpb=10078.674, bsz=620.838, num_updates=566406, lr=4.20181e-05, gnorm=0.889, clip=0.000, oom=0.000, loss_scale=2.000, wall=11256, train_wall=405137
| epoch 079:  12000 / 49553 loss=3.863, nll_loss=2.199, ppl=4.59, wps=57283, ups=5, wpb=10082.332, bsz=619.568, num_updates=567406, lr=4.1981e-05, gnorm=0.889, clip=0.000, oom=0.000, loss_scale=4.000, wall=11431, train_wall=405295
Invalid bert_input shape:torch.Size([5, 614])
| epoch 079:  13000 / 49553 loss=3.864, nll_loss=2.200, ppl=4.60, wps=57302, ups=5, wpb=10084.802, bsz=619.392, num_updates=568406, lr=4.19441e-05, gnorm=0.890, clip=0.000, oom=0.000, loss_scale=4.000, wall=11607, train_wall=405452
Invalid bert_input shape:torch.Size([6, 555])
| epoch 079:  14000 / 49553 loss=3.863, nll_loss=2.200, ppl=4.59, wps=57281, ups=5, wpb=10089.559, bsz=618.618, num_updates=569406, lr=4.19072e-05, gnorm=0.889, clip=0.000, oom=0.000, loss_scale=4.000, wall=11785, train_wall=405612
| epoch 079:  15000 / 49553 loss=3.863, nll_loss=2.200, ppl=4.59, wps=57225, ups=5, wpb=10094.320, bsz=617.445, num_updates=570406, lr=4.18705e-05, gnorm=0.889, clip=0.000, oom=0.000, loss_scale=4.000, wall=11965, train_wall=405773
Invalid bert_input shape:torch.Size([6, 575])
| epoch 079:  16000 / 49553 loss=3.863, nll_loss=2.199, ppl=4.59, wps=57137, ups=5, wpb=10095.662, bsz=616.965, num_updates=571406, lr=4.18338e-05, gnorm=0.889, clip=0.000, oom=0.000, loss_scale=8.000, wall=12146, train_wall=405937
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 079:  17000 / 49553 loss=3.863, nll_loss=2.200, ppl=4.59, wps=57095, ups=5, wpb=10093.981, bsz=617.027, num_updates=572405, lr=4.17973e-05, gnorm=0.889, clip=0.000, oom=0.000, loss_scale=4.000, wall=12324, train_wall=406098
| epoch 079:  18000 / 49553 loss=3.863, nll_loss=2.200, ppl=4.60, wps=57058, ups=5, wpb=10093.016, bsz=617.412, num_updates=573405, lr=4.17608e-05, gnorm=0.890, clip=0.000, oom=0.000, loss_scale=4.000, wall=12502, train_wall=406257
| epoch 079:  19000 / 49553 loss=3.863, nll_loss=2.200, ppl=4.59, wps=57067, ups=5, wpb=10096.098, bsz=617.214, num_updates=574405, lr=4.17245e-05, gnorm=0.889, clip=0.000, oom=0.000, loss_scale=4.000, wall=12680, train_wall=406413
| epoch 079:  20000 / 49553 loss=3.865, nll_loss=2.201, ppl=4.60, wps=57063, ups=5, wpb=10095.895, bsz=617.197, num_updates=575405, lr=4.16882e-05, gnorm=0.890, clip=0.000, oom=0.000, loss_scale=4.000, wall=12857, train_wall=406565
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 079:  21000 / 49553 loss=3.865, nll_loss=2.202, ppl=4.60, wps=57032, ups=5, wpb=10098.550, bsz=617.046, num_updates=576404, lr=4.16521e-05, gnorm=0.890, clip=0.000, oom=0.000, loss_scale=4.000, wall=13037, train_wall=406718
| epoch 079:  22000 / 49553 loss=3.866, nll_loss=2.203, ppl=4.60, wps=57067, ups=5, wpb=10100.925, bsz=616.797, num_updates=577404, lr=4.1616e-05, gnorm=0.890, clip=0.000, oom=0.000, loss_scale=4.000, wall=13212, train_wall=406874
| epoch 079:  23000 / 49553 loss=3.867, nll_loss=2.204, ppl=4.61, wps=57066, ups=5, wpb=10102.365, bsz=616.997, num_updates=578404, lr=4.158e-05, gnorm=0.890, clip=0.000, oom=0.000, loss_scale=4.000, wall=13390, train_wall=407033
| epoch 079:  24000 / 49553 loss=3.867, nll_loss=2.204, ppl=4.61, wps=57030, ups=5, wpb=10100.941, bsz=617.807, num_updates=579404, lr=4.15441e-05, gnorm=0.890, clip=0.000, oom=0.000, loss_scale=4.000, wall=13569, train_wall=407193
Invalid bert_input shape:torch.Size([4, 858])
| epoch 079:  25000 / 49553 loss=3.866, nll_loss=2.203, ppl=4.61, wps=57007, ups=5, wpb=10100.902, bsz=617.997, num_updates=580404, lr=4.15083e-05, gnorm=0.890, clip=0.000, oom=0.000, loss_scale=8.000, wall=13748, train_wall=407352
Invalid bert_input shape:torch.Size([4, 776])
| epoch 079:  26000 / 49553 loss=3.866, nll_loss=2.203, ppl=4.61, wps=56993, ups=5, wpb=10099.603, bsz=617.712, num_updates=581404, lr=4.14726e-05, gnorm=0.890, clip=0.000, oom=0.000, loss_scale=8.000, wall=13926, train_wall=407505
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 079:  27000 / 49553 loss=3.867, nll_loss=2.204, ppl=4.61, wps=56961, ups=5, wpb=10098.198, bsz=617.484, num_updates=582403, lr=4.1437e-05, gnorm=0.890, clip=0.000, oom=0.000, loss_scale=4.000, wall=14105, train_wall=407657
| epoch 079:  28000 / 49553 loss=3.867, nll_loss=2.204, ppl=4.61, wps=56955, ups=5, wpb=10094.882, bsz=617.488, num_updates=583403, lr=4.14015e-05, gnorm=0.891, clip=0.000, oom=0.000, loss_scale=4.000, wall=14281, train_wall=407814
Invalid bert_input shape:torch.Size([3, 1160])
| epoch 079:  29000 / 49553 loss=3.867, nll_loss=2.205, ppl=4.61, wps=56939, ups=6, wpb=10093.247, bsz=617.693, num_updates=584403, lr=4.1366e-05, gnorm=0.891, clip=0.000, oom=0.000, loss_scale=4.000, wall=14459, train_wall=407974
| epoch 079:  30000 / 49553 loss=3.867, nll_loss=2.204, ppl=4.61, wps=56948, ups=6, wpb=10093.067, bsz=617.940, num_updates=585403, lr=4.13307e-05, gnorm=0.891, clip=0.000, oom=0.000, loss_scale=4.000, wall=14635, train_wall=408132
Invalid bert_input shape:torch.Size([5, 666])
Invalid bert_input shape:torch.Size([2, 1513])
Invalid bert_input shape:torch.Size([7, 600])
| epoch 079:  31000 / 49553 loss=3.867, nll_loss=2.204, ppl=4.61, wps=56958, ups=6, wpb=10091.346, bsz=617.720, num_updates=586403, lr=4.12954e-05, gnorm=0.891, clip=0.000, oom=0.000, loss_scale=8.000, wall=14810, train_wall=408290
| epoch 079:  32000 / 49553 loss=3.867, nll_loss=2.204, ppl=4.61, wps=56946, ups=6, wpb=10090.985, bsz=617.953, num_updates=587403, lr=4.12603e-05, gnorm=0.891, clip=0.000, oom=0.000, loss_scale=8.000, wall=14989, train_wall=408450
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 079:  33000 / 49553 loss=3.867, nll_loss=2.205, ppl=4.61, wps=56969, ups=6, wpb=10092.027, bsz=618.224, num_updates=588402, lr=4.12252e-05, gnorm=0.891, clip=0.000, oom=0.000, loss_scale=4.000, wall=15164, train_wall=408606
| epoch 079:  34000 / 49553 loss=3.867, nll_loss=2.205, ppl=4.61, wps=56988, ups=6, wpb=10091.716, bsz=618.316, num_updates=589402, lr=4.11902e-05, gnorm=0.892, clip=0.000, oom=0.000, loss_scale=4.000, wall=15339, train_wall=408763
Invalid bert_input shape:torch.Size([6, 546])
| epoch 079:  35000 / 49553 loss=3.868, nll_loss=2.206, ppl=4.61, wps=56992, ups=6, wpb=10090.088, bsz=618.393, num_updates=590402, lr=4.11553e-05, gnorm=0.892, clip=0.000, oom=0.000, loss_scale=4.000, wall=15515, train_wall=408920
Invalid bert_input shape:torch.Size([4, 823])
| epoch 079:  36000 / 49553 loss=3.868, nll_loss=2.205, ppl=4.61, wps=56952, ups=6, wpb=10089.372, bsz=618.498, num_updates=591402, lr=4.11205e-05, gnorm=0.892, clip=0.000, oom=0.000, loss_scale=4.000, wall=15695, train_wall=409081
| epoch 079:  37000 / 49553 loss=3.868, nll_loss=2.205, ppl=4.61, wps=56945, ups=6, wpb=10090.589, bsz=618.887, num_updates=592402, lr=4.10858e-05, gnorm=0.892, clip=0.000, oom=0.000, loss_scale=8.000, wall=15874, train_wall=409240
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 079:  38000 / 49553 loss=3.868, nll_loss=2.205, ppl=4.61, wps=56948, ups=6, wpb=10093.862, bsz=618.524, num_updates=593401, lr=4.10512e-05, gnorm=0.892, clip=0.000, oom=0.000, loss_scale=4.000, wall=16053, train_wall=409400
| epoch 079:  39000 / 49553 loss=3.868, nll_loss=2.206, ppl=4.61, wps=56931, ups=6, wpb=10095.452, bsz=618.278, num_updates=594401, lr=4.10167e-05, gnorm=0.892, clip=0.000, oom=0.000, loss_scale=4.000, wall=16233, train_wall=409561
| epoch 079:  40000 / 49553 loss=3.868, nll_loss=2.206, ppl=4.61, wps=56923, ups=6, wpb=10096.019, bsz=618.555, num_updates=595401, lr=4.09822e-05, gnorm=0.892, clip=0.000, oom=0.000, loss_scale=4.000, wall=16412, train_wall=409720
| epoch 079:  41000 / 49553 loss=3.868, nll_loss=2.206, ppl=4.61, wps=56910, ups=6, wpb=10095.990, bsz=618.679, num_updates=596401, lr=4.09478e-05, gnorm=0.892, clip=0.000, oom=0.000, loss_scale=4.000, wall=16591, train_wall=409880
| epoch 079:  42000 / 49553 loss=3.868, nll_loss=2.206, ppl=4.61, wps=56889, ups=6, wpb=10095.964, bsz=618.845, num_updates=597401, lr=4.09135e-05, gnorm=0.893, clip=0.000, oom=0.000, loss_scale=4.000, wall=16771, train_wall=410041
| epoch 079:  43000 / 49553 loss=3.869, nll_loss=2.206, ppl=4.61, wps=56912, ups=6, wpb=10096.690, bsz=618.704, num_updates=598401, lr=4.08793e-05, gnorm=0.893, clip=0.000, oom=0.000, loss_scale=8.000, wall=16946, train_wall=410198
| epoch 079:  44000 / 49553 loss=3.869, nll_loss=2.206, ppl=4.61, wps=56916, ups=6, wpb=10097.312, bsz=618.851, num_updates=599401, lr=4.08452e-05, gnorm=0.893, clip=0.000, oom=0.000, loss_scale=8.000, wall=17124, train_wall=410356
| epoch 079:  45000 / 49553 loss=3.869, nll_loss=2.206, ppl=4.62, wps=56909, ups=6, wpb=10099.075, bsz=618.860, num_updates=600401, lr=4.08112e-05, gnorm=0.893, clip=0.000, oom=0.000, loss_scale=8.000, wall=17303, train_wall=410516
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([7, 900])
Invalid bert_input shape:torch.Size([5, 627])
| epoch 079:  46000 / 49553 loss=3.869, nll_loss=2.206, ppl=4.62, wps=56899, ups=6, wpb=10099.098, bsz=618.844, num_updates=601400, lr=4.07773e-05, gnorm=0.893, clip=0.000, oom=0.000, loss_scale=4.000, wall=17482, train_wall=410676
| epoch 079:  47000 / 49553 loss=3.869, nll_loss=2.206, ppl=4.61, wps=56881, ups=6, wpb=10099.041, bsz=618.789, num_updates=602400, lr=4.07434e-05, gnorm=0.893, clip=0.000, oom=0.000, loss_scale=4.000, wall=17662, train_wall=410837
| epoch 079:  48000 / 49553 loss=3.869, nll_loss=2.206, ppl=4.62, wps=56885, ups=6, wpb=10099.570, bsz=618.902, num_updates=603400, lr=4.07096e-05, gnorm=0.893, clip=0.000, oom=0.000, loss_scale=4.000, wall=17840, train_wall=410996
Invalid bert_input shape:torch.Size([7, 573])
| epoch 079:  49000 / 49553 loss=3.870, nll_loss=2.207, ppl=4.62, wps=56907, ups=6, wpb=10099.149, bsz=618.855, num_updates=604400, lr=4.0676e-05, gnorm=0.893, clip=0.000, oom=0.000, loss_scale=4.000, wall=18014, train_wall=411152
| epoch 079 | loss 3.869 | nll_loss 2.207 | ppl 4.62 | wps 56922 | ups 6 | wpb 10099.929 | bsz 618.714 | num_updates 604952 | lr 4.06574e-05 | gnorm 0.893 | clip 0.000 | oom 0.000 | loss_scale 8.000 | wall 18110 | train_wall 411238
| epoch 079 | valid on 'valid' subset | loss 2.766 | nll_loss 0.951 | ppl 1.93 | num_updates 604952 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint79.pt (epoch 79 @ 604952 updates) (writing took 8.433289527893066 seconds)
| epoch 080:   1000 / 49553 loss=3.862, nll_loss=2.199, ppl=4.59, wps=56030, ups=3, wpb=10102.136, bsz=629.403, num_updates=605953, lr=4.06238e-05, gnorm=0.894, clip=0.000, oom=0.000, loss_scale=8.000, wall=18421, train_wall=411402
| epoch 080:   2000 / 49553 loss=3.860, nll_loss=2.197, ppl=4.58, wps=56249, ups=4, wpb=10089.321, bsz=619.402, num_updates=606953, lr=4.05903e-05, gnorm=0.896, clip=0.000, oom=0.000, loss_scale=8.000, wall=18600, train_wall=411562
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 080:   3000 / 49553 loss=3.865, nll_loss=2.202, ppl=4.60, wps=56458, ups=4, wpb=10104.341, bsz=619.256, num_updates=607952, lr=4.0557e-05, gnorm=0.895, clip=0.000, oom=0.000, loss_scale=4.000, wall=18778, train_wall=411723
| epoch 080:   4000 / 49553 loss=3.862, nll_loss=2.198, ppl=4.59, wps=56319, ups=5, wpb=10081.845, bsz=618.779, num_updates=608952, lr=4.05236e-05, gnorm=0.898, clip=0.000, oom=0.000, loss_scale=4.000, wall=18957, train_wall=411883
| epoch 080:   5000 / 49553 loss=3.860, nll_loss=2.197, ppl=4.58, wps=56414, ups=5, wpb=10087.990, bsz=619.012, num_updates=609952, lr=4.04904e-05, gnorm=0.898, clip=0.000, oom=0.000, loss_scale=4.000, wall=19135, train_wall=412043
| epoch 080:   6000 / 49553 loss=3.864, nll_loss=2.200, ppl=4.60, wps=56406, ups=5, wpb=10099.229, bsz=621.436, num_updates=610952, lr=4.04573e-05, gnorm=0.899, clip=0.000, oom=0.000, loss_scale=4.000, wall=19315, train_wall=412205
| epoch 080:   7000 / 49553 loss=3.862, nll_loss=2.199, ppl=4.59, wps=56348, ups=5, wpb=10097.861, bsz=621.584, num_updates=611952, lr=4.04242e-05, gnorm=0.901, clip=0.000, oom=0.000, loss_scale=8.000, wall=19495, train_wall=412366
| epoch 080:   8000 / 49553 loss=3.861, nll_loss=2.197, ppl=4.59, wps=56376, ups=5, wpb=10101.585, bsz=621.091, num_updates=612952, lr=4.03912e-05, gnorm=0.900, clip=0.000, oom=0.000, loss_scale=8.000, wall=19674, train_wall=412527
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 080:   9000 / 49553 loss=3.862, nll_loss=2.199, ppl=4.59, wps=56371, ups=5, wpb=10102.091, bsz=620.458, num_updates=613951, lr=4.03583e-05, gnorm=0.901, clip=0.000, oom=0.000, loss_scale=4.000, wall=19853, train_wall=412688
| epoch 080:  10000 / 49553 loss=3.861, nll_loss=2.198, ppl=4.59, wps=56317, ups=5, wpb=10092.517, bsz=621.606, num_updates=614951, lr=4.03255e-05, gnorm=0.902, clip=0.000, oom=0.000, loss_scale=4.000, wall=20033, train_wall=412848
| epoch 080:  11000 / 49553 loss=3.862, nll_loss=2.199, ppl=4.59, wps=56350, ups=5, wpb=10094.480, bsz=621.244, num_updates=615951, lr=4.02928e-05, gnorm=0.902, clip=0.000, oom=0.000, loss_scale=4.000, wall=20211, train_wall=413008
| epoch 080:  12000 / 49553 loss=3.863, nll_loss=2.200, ppl=4.59, wps=56328, ups=5, wpb=10092.433, bsz=620.889, num_updates=616951, lr=4.02601e-05, gnorm=0.902, clip=0.000, oom=0.000, loss_scale=4.000, wall=20391, train_wall=413168
| epoch 080:  13000 / 49553 loss=3.863, nll_loss=2.199, ppl=4.59, wps=56343, ups=5, wpb=10091.973, bsz=621.042, num_updates=617951, lr=4.02275e-05, gnorm=0.902, clip=0.000, oom=0.000, loss_scale=8.000, wall=20569, train_wall=413329
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 080:  14000 / 49553 loss=3.863, nll_loss=2.200, ppl=4.59, wps=56414, ups=5, wpb=10096.451, bsz=620.302, num_updates=618950, lr=4.0195e-05, gnorm=0.902, clip=0.000, oom=0.000, loss_scale=4.000, wall=20746, train_wall=413487
| epoch 080:  15000 / 49553 loss=3.862, nll_loss=2.199, ppl=4.59, wps=56408, ups=5, wpb=10097.747, bsz=620.844, num_updates=619950, lr=4.01626e-05, gnorm=0.902, clip=0.000, oom=0.000, loss_scale=4.000, wall=20926, train_wall=413647
| epoch 080:  16000 / 49553 loss=3.862, nll_loss=2.199, ppl=4.59, wps=56413, ups=5, wpb=10096.824, bsz=621.398, num_updates=620950, lr=4.01302e-05, gnorm=0.902, clip=0.000, oom=0.000, loss_scale=4.000, wall=21104, train_wall=413807
| epoch 080:  17000 / 49553 loss=3.863, nll_loss=2.200, ppl=4.60, wps=56430, ups=5, wpb=10096.581, bsz=620.820, num_updates=621950, lr=4.0098e-05, gnorm=0.902, clip=0.000, oom=0.000, loss_scale=4.000, wall=21282, train_wall=413967
| epoch 080:  18000 / 49553 loss=3.862, nll_loss=2.199, ppl=4.59, wps=56472, ups=5, wpb=10094.095, bsz=620.441, num_updates=622950, lr=4.00658e-05, gnorm=0.902, clip=0.000, oom=0.000, loss_scale=8.000, wall=21458, train_wall=414124
Invalid bert_input shape:torch.Size([5, 994])
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 080:  19000 / 49553 loss=3.861, nll_loss=2.197, ppl=4.59, wps=56530, ups=5, wpb=10092.292, bsz=620.267, num_updates=623949, lr=4.00337e-05, gnorm=0.902, clip=0.000, oom=0.000, loss_scale=4.000, wall=21632, train_wall=414280
| epoch 080:  20000 / 49553 loss=3.861, nll_loss=2.198, ppl=4.59, wps=56583, ups=5, wpb=10095.548, bsz=620.056, num_updates=624949, lr=4.00016e-05, gnorm=0.902, clip=0.000, oom=0.000, loss_scale=4.000, wall=21809, train_wall=414436
| epoch 080:  21000 / 49553 loss=3.862, nll_loss=2.198, ppl=4.59, wps=56587, ups=5, wpb=10093.973, bsz=619.794, num_updates=625949, lr=3.99697e-05, gnorm=0.903, clip=0.000, oom=0.000, loss_scale=4.000, wall=21986, train_wall=414594
Invalid bert_input shape:torch.Size([6, 1334])
| epoch 080:  22000 / 49553 loss=3.862, nll_loss=2.199, ppl=4.59, wps=56617, ups=5, wpb=10094.942, bsz=619.108, num_updates=626949, lr=3.99378e-05, gnorm=0.903, clip=0.000, oom=0.000, loss_scale=4.000, wall=22163, train_wall=414753
| epoch 080:  23000 / 49553 loss=3.862, nll_loss=2.199, ppl=4.59, wps=56681, ups=5, wpb=10097.765, bsz=619.141, num_updates=627949, lr=3.9906e-05, gnorm=0.903, clip=0.000, oom=0.000, loss_scale=8.000, wall=22338, train_wall=414908
Invalid bert_input shape:torch.Size([5, 869])
| epoch 080:  24000 / 49553 loss=3.863, nll_loss=2.200, ppl=4.59, wps=56718, ups=5, wpb=10099.701, bsz=619.017, num_updates=628949, lr=3.98742e-05, gnorm=0.904, clip=0.000, oom=0.000, loss_scale=8.000, wall=22514, train_wall=415065
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 080:  25000 / 49553 loss=3.864, nll_loss=2.201, ppl=4.60, wps=56762, ups=5, wpb=10100.942, bsz=618.984, num_updates=629948, lr=3.98426e-05, gnorm=0.904, clip=0.000, oom=0.000, loss_scale=4.000, wall=22689, train_wall=415222
| epoch 080:  26000 / 49553 loss=3.864, nll_loss=2.200, ppl=4.60, wps=56794, ups=5, wpb=10099.383, bsz=619.020, num_updates=630948, lr=3.9811e-05, gnorm=0.904, clip=0.000, oom=0.000, loss_scale=4.000, wall=22864, train_wall=415377
| epoch 080:  27000 / 49553 loss=3.863, nll_loss=2.200, ppl=4.60, wps=56799, ups=5, wpb=10095.926, bsz=619.143, num_updates=631948, lr=3.97795e-05, gnorm=0.904, clip=0.000, oom=0.000, loss_scale=4.000, wall=23039, train_wall=415535
Invalid bert_input shape:torch.Size([5, 729])
| epoch 080:  28000 / 49553 loss=3.863, nll_loss=2.200, ppl=4.60, wps=56828, ups=5, wpb=10095.616, bsz=618.982, num_updates=632948, lr=3.97481e-05, gnorm=0.904, clip=0.000, oom=0.000, loss_scale=4.000, wall=23214, train_wall=415690
| epoch 080:  29000 / 49553 loss=3.863, nll_loss=2.200, ppl=4.60, wps=56856, ups=5, wpb=10096.226, bsz=619.436, num_updates=633948, lr=3.97167e-05, gnorm=0.904, clip=0.000, oom=0.000, loss_scale=8.000, wall=23390, train_wall=415848
| epoch 080:  30000 / 49553 loss=3.863, nll_loss=2.200, ppl=4.60, wps=56885, ups=5, wpb=10097.589, bsz=619.539, num_updates=634948, lr=3.96854e-05, gnorm=0.904, clip=0.000, oom=0.000, loss_scale=8.000, wall=23565, train_wall=416004
| epoch 080:  31000 / 49553 loss=3.864, nll_loss=2.201, ppl=4.60, wps=56918, ups=6, wpb=10099.055, bsz=619.425, num_updates=635948, lr=3.96542e-05, gnorm=0.904, clip=0.000, oom=0.000, loss_scale=8.000, wall=23740, train_wall=416161
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([3, 1119])
| epoch 080:  32000 / 49553 loss=3.864, nll_loss=2.201, ppl=4.60, wps=56941, ups=6, wpb=10099.934, bsz=619.298, num_updates=636947, lr=3.96231e-05, gnorm=0.904, clip=0.000, oom=0.000, loss_scale=4.000, wall=23916, train_wall=416318
| epoch 080:  33000 / 49553 loss=3.864, nll_loss=2.201, ppl=4.60, wps=56955, ups=6, wpb=10099.516, bsz=618.881, num_updates=637947, lr=3.9592e-05, gnorm=0.904, clip=0.000, oom=0.000, loss_scale=4.000, wall=24092, train_wall=416476
| epoch 080:  34000 / 49553 loss=3.864, nll_loss=2.201, ppl=4.60, wps=56982, ups=6, wpb=10099.491, bsz=619.058, num_updates=638947, lr=3.9561e-05, gnorm=0.904, clip=0.000, oom=0.000, loss_scale=4.000, wall=24266, train_wall=416631
Invalid bert_input shape:torch.Size([5, 656])
| epoch 080:  35000 / 49553 loss=3.864, nll_loss=2.201, ppl=4.60, wps=56981, ups=6, wpb=10099.303, bsz=618.973, num_updates=639947, lr=3.95301e-05, gnorm=0.904, clip=0.000, oom=0.000, loss_scale=4.000, wall=24443, train_wall=416790
Invalid bert_input shape:torch.Size([4, 832])
| epoch 080:  36000 / 49553 loss=3.864, nll_loss=2.201, ppl=4.60, wps=56981, ups=6, wpb=10097.799, bsz=618.751, num_updates=640947, lr=3.94993e-05, gnorm=0.905, clip=0.000, oom=0.000, loss_scale=8.000, wall=24620, train_wall=416949
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 080:  37000 / 49553 loss=3.865, nll_loss=2.202, ppl=4.60, wps=56992, ups=6, wpb=10098.110, bsz=618.328, num_updates=641946, lr=3.94685e-05, gnorm=0.905, clip=0.000, oom=0.000, loss_scale=4.000, wall=24796, train_wall=417105
| epoch 080:  38000 / 49553 loss=3.864, nll_loss=2.202, ppl=4.60, wps=57005, ups=6, wpb=10097.467, bsz=618.451, num_updates=642946, lr=3.94378e-05, gnorm=0.905, clip=0.000, oom=0.000, loss_scale=4.000, wall=24971, train_wall=417261
| epoch 080:  39000 / 49553 loss=3.864, nll_loss=2.201, ppl=4.60, wps=57002, ups=6, wpb=10097.726, bsz=618.685, num_updates=643946, lr=3.94072e-05, gnorm=0.905, clip=0.000, oom=0.000, loss_scale=4.000, wall=25148, train_wall=417421
| epoch 080:  40000 / 49553 loss=3.865, nll_loss=2.202, ppl=4.60, wps=57025, ups=6, wpb=10099.818, bsz=618.334, num_updates=644946, lr=3.93766e-05, gnorm=0.905, clip=0.000, oom=0.000, loss_scale=4.000, wall=25324, train_wall=417578
| epoch 080:  41000 / 49553 loss=3.865, nll_loss=2.202, ppl=4.60, wps=57045, ups=6, wpb=10100.819, bsz=618.484, num_updates=645946, lr=3.93461e-05, gnorm=0.905, clip=0.000, oom=0.000, loss_scale=8.000, wall=25500, train_wall=417735
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 080:  42000 / 49553 loss=3.865, nll_loss=2.202, ppl=4.60, wps=57044, ups=6, wpb=10098.931, bsz=618.608, num_updates=646945, lr=3.93157e-05, gnorm=0.906, clip=0.000, oom=0.000, loss_scale=4.000, wall=25675, train_wall=417891
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 080:  43000 / 49553 loss=3.865, nll_loss=2.202, ppl=4.60, wps=57037, ups=6, wpb=10098.521, bsz=618.781, num_updates=647944, lr=3.92854e-05, gnorm=0.906, clip=0.000, oom=0.000, loss_scale=2.000, wall=25853, train_wall=418045
| epoch 080:  44000 / 49553 loss=3.865, nll_loss=2.202, ppl=4.60, wps=57047, ups=6, wpb=10098.395, bsz=618.817, num_updates=648944, lr=3.92551e-05, gnorm=0.906, clip=0.000, oom=0.000, loss_scale=2.000, wall=26028, train_wall=418202
Invalid bert_input shape:torch.Size([2, 1562])
| epoch 080:  45000 / 49553 loss=3.865, nll_loss=2.203, ppl=4.60, wps=57058, ups=6, wpb=10097.559, bsz=618.797, num_updates=649944, lr=3.92249e-05, gnorm=0.906, clip=0.000, oom=0.000, loss_scale=2.000, wall=26203, train_wall=418359
| epoch 080:  46000 / 49553 loss=3.865, nll_loss=2.203, ppl=4.60, wps=57073, ups=6, wpb=10097.189, bsz=618.886, num_updates=650944, lr=3.91948e-05, gnorm=0.906, clip=0.000, oom=0.000, loss_scale=2.000, wall=26378, train_wall=418516
Invalid bert_input shape:torch.Size([4, 760])
| epoch 080:  47000 / 49553 loss=3.865, nll_loss=2.203, ppl=4.60, wps=57088, ups=6, wpb=10098.438, bsz=618.911, num_updates=651944, lr=3.91647e-05, gnorm=0.906, clip=0.000, oom=0.000, loss_scale=4.000, wall=26553, train_wall=418673
Invalid bert_input shape:torch.Size([5, 907])
| epoch 080:  48000 / 49553 loss=3.866, nll_loss=2.203, ppl=4.60, wps=57115, ups=6, wpb=10100.227, bsz=618.636, num_updates=652944, lr=3.91347e-05, gnorm=0.906, clip=0.000, oom=0.000, loss_scale=4.000, wall=26728, train_wall=418831
| epoch 080:  49000 / 49553 loss=3.866, nll_loss=2.203, ppl=4.60, wps=57129, ups=6, wpb=10099.683, bsz=618.422, num_updates=653944, lr=3.91048e-05, gnorm=0.906, clip=0.000, oom=0.000, loss_scale=4.000, wall=26902, train_wall=418987
Invalid bert_input shape:torch.Size([6, 555])
| epoch 080 | loss 3.866 | nll_loss 2.203 | ppl 4.60 | wps 57131 | ups 6 | wpb 10099.879 | bsz 618.614 | num_updates 654496 | lr 3.90883e-05 | gnorm 0.906 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 26999 | train_wall 419074
| epoch 080 | valid on 'valid' subset | loss 2.753 | nll_loss 0.937 | ppl 1.91 | num_updates 654496 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint80.pt (epoch 80 @ 654496 updates) (writing took 11.633105993270874 seconds)
| epoch 081:   1000 / 49553 loss=3.838, nll_loss=2.171, ppl=4.50, wps=56356, ups=3, wpb=10105.357, bsz=624.215, num_updates=655497, lr=3.90584e-05, gnorm=0.912, clip=0.000, oom=0.000, loss_scale=4.000, wall=27320, train_wall=419227
Invalid bert_input shape:torch.Size([4, 843])
| epoch 081:   2000 / 49553 loss=3.845, nll_loss=2.180, ppl=4.53, wps=56991, ups=4, wpb=10101.325, bsz=624.871, num_updates=656497, lr=3.90287e-05, gnorm=0.911, clip=0.000, oom=0.000, loss_scale=8.000, wall=27495, train_wall=419383
| WARNING: overflow detected, setting loss scale to: 4.0
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 081:   3000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=56974, ups=4, wpb=10104.867, bsz=620.831, num_updates=657495, lr=3.8999e-05, gnorm=0.912, clip=0.000, oom=0.000, loss_scale=2.000, wall=27673, train_wall=419542
| epoch 081:   4000 / 49553 loss=3.851, nll_loss=2.186, ppl=4.55, wps=56705, ups=5, wpb=10091.818, bsz=621.001, num_updates=658495, lr=3.89694e-05, gnorm=0.914, clip=0.000, oom=0.000, loss_scale=2.000, wall=27853, train_wall=419702
| epoch 081:   5000 / 49553 loss=3.853, nll_loss=2.189, ppl=4.56, wps=56663, ups=5, wpb=10087.897, bsz=620.098, num_updates=659495, lr=3.89398e-05, gnorm=0.915, clip=0.000, oom=0.000, loss_scale=2.000, wall=28031, train_wall=419862
| epoch 081:   6000 / 49553 loss=3.856, nll_loss=2.192, ppl=4.57, wps=56698, ups=5, wpb=10102.364, bsz=618.263, num_updates=660495, lr=3.89104e-05, gnorm=0.913, clip=0.000, oom=0.000, loss_scale=2.000, wall=28210, train_wall=420023
Invalid bert_input shape:torch.Size([5, 602])
| epoch 081:   7000 / 49553 loss=3.856, nll_loss=2.192, ppl=4.57, wps=56620, ups=5, wpb=10095.657, bsz=620.417, num_updates=661495, lr=3.88809e-05, gnorm=0.913, clip=0.000, oom=0.000, loss_scale=4.000, wall=28389, train_wall=420183
Invalid bert_input shape:torch.Size([3, 1514])
Invalid bert_input shape:torch.Size([4, 721])
| epoch 081:   8000 / 49553 loss=3.855, nll_loss=2.191, ppl=4.57, wps=56620, ups=5, wpb=10099.961, bsz=619.620, num_updates=662495, lr=3.88516e-05, gnorm=0.914, clip=0.000, oom=0.000, loss_scale=4.000, wall=28568, train_wall=420344
Invalid bert_input shape:torch.Size([7, 865])
| epoch 081:   9000 / 49553 loss=3.855, nll_loss=2.191, ppl=4.57, wps=56676, ups=5, wpb=10099.673, bsz=619.781, num_updates=663495, lr=3.88223e-05, gnorm=0.914, clip=0.000, oom=0.000, loss_scale=4.000, wall=28744, train_wall=420499
| epoch 081:  10000 / 49553 loss=3.857, nll_loss=2.193, ppl=4.57, wps=56757, ups=5, wpb=10100.335, bsz=619.476, num_updates=664495, lr=3.87931e-05, gnorm=0.914, clip=0.000, oom=0.000, loss_scale=4.000, wall=28920, train_wall=420656
Invalid bert_input shape:torch.Size([4, 790])
| epoch 081:  11000 / 49553 loss=3.857, nll_loss=2.193, ppl=4.57, wps=56859, ups=5, wpb=10101.924, bsz=619.083, num_updates=665495, lr=3.87639e-05, gnorm=0.914, clip=0.000, oom=0.000, loss_scale=8.000, wall=29095, train_wall=420812
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([5, 674])
| epoch 081:  12000 / 49553 loss=3.856, nll_loss=2.192, ppl=4.57, wps=56822, ups=5, wpb=10099.778, bsz=618.866, num_updates=666494, lr=3.87348e-05, gnorm=0.914, clip=0.000, oom=0.000, loss_scale=4.000, wall=29273, train_wall=420972
| epoch 081:  13000 / 49553 loss=3.856, nll_loss=2.192, ppl=4.57, wps=56909, ups=5, wpb=10104.907, bsz=619.651, num_updates=667494, lr=3.87058e-05, gnorm=0.913, clip=0.000, oom=0.000, loss_scale=4.000, wall=29449, train_wall=421129
| epoch 081:  14000 / 49553 loss=3.856, nll_loss=2.192, ppl=4.57, wps=56971, ups=5, wpb=10104.522, bsz=619.795, num_updates=668494, lr=3.86769e-05, gnorm=0.914, clip=0.000, oom=0.000, loss_scale=4.000, wall=29624, train_wall=421285
| epoch 081:  15000 / 49553 loss=3.856, nll_loss=2.192, ppl=4.57, wps=56983, ups=5, wpb=10101.287, bsz=619.745, num_updates=669494, lr=3.8648e-05, gnorm=0.914, clip=0.000, oom=0.000, loss_scale=4.000, wall=29799, train_wall=421443
Invalid bert_input shape:torch.Size([6, 555])
| epoch 081:  16000 / 49553 loss=3.856, nll_loss=2.193, ppl=4.57, wps=57072, ups=5, wpb=10108.658, bsz=619.975, num_updates=670494, lr=3.86191e-05, gnorm=0.914, clip=0.000, oom=0.000, loss_scale=8.000, wall=29974, train_wall=421599
| epoch 081:  17000 / 49553 loss=3.857, nll_loss=2.193, ppl=4.57, wps=57014, ups=5, wpb=10110.041, bsz=620.791, num_updates=671494, lr=3.85904e-05, gnorm=0.914, clip=0.000, oom=0.000, loss_scale=8.000, wall=30155, train_wall=421761
Invalid bert_input shape:torch.Size([3, 1119])
| epoch 081:  18000 / 49553 loss=3.857, nll_loss=2.193, ppl=4.57, wps=56999, ups=5, wpb=10108.526, bsz=620.573, num_updates=672494, lr=3.85617e-05, gnorm=0.914, clip=0.000, oom=0.000, loss_scale=8.000, wall=30333, train_wall=421920
Invalid bert_input shape:torch.Size([7, 900])
| epoch 081:  19000 / 49553 loss=3.857, nll_loss=2.193, ppl=4.57, wps=57027, ups=5, wpb=10106.137, bsz=619.986, num_updates=673494, lr=3.8533e-05, gnorm=0.915, clip=0.000, oom=0.000, loss_scale=8.000, wall=30508, train_wall=422076
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 081:  20000 / 49553 loss=3.856, nll_loss=2.192, ppl=4.57, wps=57032, ups=5, wpb=10107.529, bsz=619.680, num_updates=674493, lr=3.85045e-05, gnorm=0.915, clip=0.000, oom=0.000, loss_scale=8.000, wall=30685, train_wall=422235
Invalid bert_input shape:torch.Size([8, 1356])
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 081:  21000 / 49553 loss=3.857, nll_loss=2.193, ppl=4.57, wps=57059, ups=5, wpb=10107.016, bsz=618.967, num_updates=675492, lr=3.8476e-05, gnorm=0.915, clip=0.000, oom=0.000, loss_scale=4.000, wall=30860, train_wall=422392
Invalid bert_input shape:torch.Size([3, 1184])
Invalid bert_input shape:torch.Size([5, 638])
| epoch 081:  22000 / 49553 loss=3.857, nll_loss=2.193, ppl=4.57, wps=57109, ups=5, wpb=10109.351, bsz=618.821, num_updates=676492, lr=3.84475e-05, gnorm=0.915, clip=0.000, oom=0.000, loss_scale=4.000, wall=31034, train_wall=422548
Invalid bert_input shape:torch.Size([3, 944])
| epoch 081:  23000 / 49553 loss=3.858, nll_loss=2.194, ppl=4.58, wps=57097, ups=5, wpb=10107.285, bsz=618.762, num_updates=677492, lr=3.84192e-05, gnorm=0.915, clip=0.000, oom=0.000, loss_scale=4.000, wall=31212, train_wall=422708
| epoch 081:  24000 / 49553 loss=3.858, nll_loss=2.195, ppl=4.58, wps=57052, ups=5, wpb=10104.746, bsz=618.323, num_updates=678492, lr=3.83908e-05, gnorm=0.916, clip=0.000, oom=0.000, loss_scale=4.000, wall=31391, train_wall=422869
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 081:  25000 / 49553 loss=3.859, nll_loss=2.195, ppl=4.58, wps=57035, ups=5, wpb=10104.667, bsz=618.045, num_updates=679491, lr=3.83626e-05, gnorm=0.916, clip=0.000, oom=0.000, loss_scale=2.000, wall=31569, train_wall=423029
| epoch 081:  26000 / 49553 loss=3.859, nll_loss=2.196, ppl=4.58, wps=57056, ups=5, wpb=10105.351, bsz=618.063, num_updates=680491, lr=3.83344e-05, gnorm=0.916, clip=0.000, oom=0.000, loss_scale=2.000, wall=31745, train_wall=423186
| epoch 081:  27000 / 49553 loss=3.860, nll_loss=2.196, ppl=4.58, wps=57059, ups=5, wpb=10107.531, bsz=618.330, num_updates=681491, lr=3.83063e-05, gnorm=0.916, clip=0.000, oom=0.000, loss_scale=2.000, wall=31923, train_wall=423345
| epoch 081:  28000 / 49553 loss=3.860, nll_loss=2.196, ppl=4.58, wps=57044, ups=5, wpb=10105.760, bsz=618.254, num_updates=682491, lr=3.82782e-05, gnorm=0.916, clip=0.000, oom=0.000, loss_scale=2.000, wall=32100, train_wall=423505
| epoch 081:  29000 / 49553 loss=3.861, nll_loss=2.197, ppl=4.59, wps=57073, ups=5, wpb=10106.567, bsz=617.906, num_updates=683491, lr=3.82502e-05, gnorm=0.916, clip=0.000, oom=0.000, loss_scale=4.000, wall=32275, train_wall=423662
| epoch 081:  30000 / 49553 loss=3.861, nll_loss=2.198, ppl=4.59, wps=57072, ups=6, wpb=10105.809, bsz=617.577, num_updates=684491, lr=3.82222e-05, gnorm=0.916, clip=0.000, oom=0.000, loss_scale=4.000, wall=32452, train_wall=423820
| epoch 081:  31000 / 49553 loss=3.861, nll_loss=2.197, ppl=4.59, wps=57077, ups=6, wpb=10101.244, bsz=617.390, num_updates=685491, lr=3.81943e-05, gnorm=0.916, clip=0.000, oom=0.000, loss_scale=4.000, wall=32626, train_wall=423976
Invalid bert_input shape:torch.Size([5, 666])
| epoch 081:  32000 / 49553 loss=3.861, nll_loss=2.198, ppl=4.59, wps=57100, ups=6, wpb=10101.958, bsz=617.414, num_updates=686491, lr=3.81665e-05, gnorm=0.916, clip=0.000, oom=0.000, loss_scale=4.000, wall=32801, train_wall=424134
| epoch 081:  33000 / 49553 loss=3.861, nll_loss=2.198, ppl=4.59, wps=57130, ups=6, wpb=10104.871, bsz=617.739, num_updates=687491, lr=3.81388e-05, gnorm=0.916, clip=0.000, oom=0.000, loss_scale=8.000, wall=32977, train_wall=424290
| epoch 081:  34000 / 49553 loss=3.862, nll_loss=2.199, ppl=4.59, wps=57145, ups=6, wpb=10103.682, bsz=618.058, num_updates=688491, lr=3.8111e-05, gnorm=0.917, clip=0.000, oom=0.000, loss_scale=8.000, wall=33151, train_wall=424446
| epoch 081:  35000 / 49553 loss=3.862, nll_loss=2.198, ppl=4.59, wps=57151, ups=6, wpb=10104.494, bsz=618.172, num_updates=689491, lr=3.80834e-05, gnorm=0.917, clip=0.000, oom=0.000, loss_scale=8.000, wall=33328, train_wall=424605
| epoch 081:  36000 / 49553 loss=3.862, nll_loss=2.199, ppl=4.59, wps=57165, ups=6, wpb=10103.907, bsz=618.201, num_updates=690491, lr=3.80558e-05, gnorm=0.917, clip=0.000, oom=0.000, loss_scale=8.000, wall=33503, train_wall=424759
Invalid bert_input shape:torch.Size([4, 782])
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 081:  37000 / 49553 loss=3.862, nll_loss=2.199, ppl=4.59, wps=57180, ups=6, wpb=10104.105, bsz=618.153, num_updates=691490, lr=3.80283e-05, gnorm=0.917, clip=0.000, oom=0.000, loss_scale=8.000, wall=33678, train_wall=424916
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 081:  38000 / 49553 loss=3.862, nll_loss=2.199, ppl=4.59, wps=57178, ups=6, wpb=10103.795, bsz=618.590, num_updates=692489, lr=3.80009e-05, gnorm=0.917, clip=0.000, oom=0.000, loss_scale=4.000, wall=33854, train_wall=425074
| epoch 081:  39000 / 49553 loss=3.862, nll_loss=2.199, ppl=4.59, wps=57188, ups=6, wpb=10103.816, bsz=618.759, num_updates=693489, lr=3.79735e-05, gnorm=0.917, clip=0.000, oom=0.000, loss_scale=4.000, wall=34030, train_wall=425230
| epoch 081:  40000 / 49553 loss=3.862, nll_loss=2.199, ppl=4.59, wps=57202, ups=6, wpb=10103.830, bsz=618.768, num_updates=694489, lr=3.79461e-05, gnorm=0.917, clip=0.000, oom=0.000, loss_scale=4.000, wall=34205, train_wall=425386
| epoch 081:  41000 / 49553 loss=3.862, nll_loss=2.199, ppl=4.59, wps=57168, ups=6, wpb=10103.982, bsz=618.786, num_updates=695489, lr=3.79188e-05, gnorm=0.917, clip=0.000, oom=0.000, loss_scale=4.000, wall=34386, train_wall=425549
| epoch 081:  42000 / 49553 loss=3.862, nll_loss=2.199, ppl=4.59, wps=57148, ups=6, wpb=10104.124, bsz=618.827, num_updates=696489, lr=3.78916e-05, gnorm=0.917, clip=0.000, oom=0.000, loss_scale=8.000, wall=34565, train_wall=425710
| epoch 081:  43000 / 49553 loss=3.862, nll_loss=2.200, ppl=4.59, wps=57133, ups=6, wpb=10104.545, bsz=618.518, num_updates=697489, lr=3.78644e-05, gnorm=0.917, clip=0.000, oom=0.000, loss_scale=8.000, wall=34745, train_wall=425871
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 081:  44000 / 49553 loss=3.862, nll_loss=2.200, ppl=4.59, wps=57102, ups=6, wpb=10103.209, bsz=618.654, num_updates=698488, lr=3.78373e-05, gnorm=0.917, clip=0.000, oom=0.000, loss_scale=4.000, wall=34924, train_wall=426032
| epoch 081:  45000 / 49553 loss=3.863, nll_loss=2.200, ppl=4.59, wps=57081, ups=6, wpb=10102.133, bsz=618.780, num_updates=699488, lr=3.78103e-05, gnorm=0.918, clip=0.000, oom=0.000, loss_scale=4.000, wall=35103, train_wall=426192
| epoch 081:  46000 / 49553 loss=3.862, nll_loss=2.200, ppl=4.59, wps=57075, ups=6, wpb=10101.790, bsz=618.711, num_updates=700488, lr=3.77833e-05, gnorm=0.918, clip=0.000, oom=0.000, loss_scale=4.000, wall=35281, train_wall=426351
| epoch 081:  47000 / 49553 loss=3.862, nll_loss=2.200, ppl=4.59, wps=57056, ups=6, wpb=10102.610, bsz=618.802, num_updates=701488, lr=3.77563e-05, gnorm=0.918, clip=0.000, oom=0.000, loss_scale=4.000, wall=35461, train_wall=426513
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 081:  48000 / 49553 loss=3.862, nll_loss=2.200, ppl=4.59, wps=57043, ups=6, wpb=10101.553, bsz=618.935, num_updates=702487, lr=3.77295e-05, gnorm=0.918, clip=0.000, oom=0.000, loss_scale=4.000, wall=35639, train_wall=426673
| epoch 081:  49000 / 49553 loss=3.862, nll_loss=2.200, ppl=4.59, wps=57027, ups=6, wpb=10100.588, bsz=618.852, num_updates=703487, lr=3.77027e-05, gnorm=0.918, clip=0.000, oom=0.000, loss_scale=4.000, wall=35818, train_wall=426833
| epoch 081 | loss 3.862 | nll_loss 2.199 | ppl 4.59 | wps 57017 | ups 6 | wpb 10100.128 | bsz 618.624 | num_updates 704039 | lr 3.76879e-05 | gnorm 0.918 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 35917 | train_wall 426922
| epoch 081 | valid on 'valid' subset | loss 2.762 | nll_loss 0.948 | ppl 1.93 | num_updates 704039 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint81.pt (epoch 81 @ 704039 updates) (writing took 9.07675838470459 seconds)
Invalid bert_input shape:torch.Size([2, 1203])
Invalid bert_input shape:torch.Size([4, 823])
| epoch 082:   1000 / 49553 loss=3.850, nll_loss=2.185, ppl=4.55, wps=56366, ups=3, wpb=10070.551, bsz=612.515, num_updates=705040, lr=3.76611e-05, gnorm=0.927, clip=0.000, oom=0.000, loss_scale=4.000, wall=36239, train_wall=427098
| epoch 082:   2000 / 49553 loss=3.851, nll_loss=2.187, ppl=4.55, wps=56647, ups=4, wpb=10080.320, bsz=620.090, num_updates=706040, lr=3.76344e-05, gnorm=0.926, clip=0.000, oom=0.000, loss_scale=4.000, wall=36417, train_wall=427256
| epoch 082:   3000 / 49553 loss=3.850, nll_loss=2.185, ppl=4.55, wps=56411, ups=4, wpb=10076.371, bsz=617.525, num_updates=707040, lr=3.76078e-05, gnorm=0.926, clip=0.000, oom=0.000, loss_scale=8.000, wall=36597, train_wall=427418
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 082:   4000 / 49553 loss=3.846, nll_loss=2.181, ppl=4.54, wps=56370, ups=5, wpb=10069.977, bsz=621.008, num_updates=708039, lr=3.75813e-05, gnorm=0.924, clip=0.000, oom=0.000, loss_scale=4.000, wall=36775, train_wall=427577
| epoch 082:   5000 / 49553 loss=3.848, nll_loss=2.183, ppl=4.54, wps=56504, ups=5, wpb=10084.796, bsz=619.224, num_updates=709039, lr=3.75548e-05, gnorm=0.924, clip=0.000, oom=0.000, loss_scale=4.000, wall=36953, train_wall=427737
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 082:   6000 / 49553 loss=3.852, nll_loss=2.188, ppl=4.56, wps=56690, ups=5, wpb=10100.918, bsz=617.735, num_updates=710038, lr=3.75283e-05, gnorm=0.925, clip=0.000, oom=0.000, loss_scale=2.000, wall=37129, train_wall=427895
Invalid bert_input shape:torch.Size([6, 547])
| epoch 082:   7000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=56873, ups=5, wpb=10102.405, bsz=618.076, num_updates=711038, lr=3.75019e-05, gnorm=0.924, clip=0.000, oom=0.000, loss_scale=2.000, wall=37304, train_wall=428051
| epoch 082:   8000 / 49553 loss=3.852, nll_loss=2.187, ppl=4.55, wps=57029, ups=5, wpb=10105.012, bsz=617.374, num_updates=712038, lr=3.74756e-05, gnorm=0.925, clip=0.000, oom=0.000, loss_scale=2.000, wall=37478, train_wall=428207
| epoch 082:   9000 / 49553 loss=3.853, nll_loss=2.189, ppl=4.56, wps=57100, ups=5, wpb=10113.722, bsz=616.953, num_updates=713038, lr=3.74493e-05, gnorm=0.926, clip=0.000, oom=0.000, loss_scale=2.000, wall=37654, train_wall=428365
| epoch 082:  10000 / 49553 loss=3.854, nll_loss=2.190, ppl=4.56, wps=57221, ups=5, wpb=10119.553, bsz=615.368, num_updates=714038, lr=3.74231e-05, gnorm=0.925, clip=0.000, oom=0.000, loss_scale=4.000, wall=37829, train_wall=428521
| epoch 082:  11000 / 49553 loss=3.855, nll_loss=2.191, ppl=4.57, wps=57139, ups=5, wpb=10115.938, bsz=615.638, num_updates=715038, lr=3.73969e-05, gnorm=0.926, clip=0.000, oom=0.000, loss_scale=4.000, wall=38008, train_wall=428681
| epoch 082:  12000 / 49553 loss=3.855, nll_loss=2.191, ppl=4.57, wps=57102, ups=5, wpb=10115.836, bsz=615.660, num_updates=716038, lr=3.73708e-05, gnorm=0.926, clip=0.000, oom=0.000, loss_scale=4.000, wall=38186, train_wall=428839
| epoch 082:  13000 / 49553 loss=3.855, nll_loss=2.191, ppl=4.57, wps=57096, ups=5, wpb=10113.455, bsz=615.961, num_updates=717038, lr=3.73447e-05, gnorm=0.927, clip=0.000, oom=0.000, loss_scale=4.000, wall=38363, train_wall=428997
Invalid bert_input shape:torch.Size([5, 817])
| epoch 082:  14000 / 49553 loss=3.855, nll_loss=2.191, ppl=4.57, wps=57026, ups=5, wpb=10106.817, bsz=616.438, num_updates=718038, lr=3.73187e-05, gnorm=0.928, clip=0.000, oom=0.000, loss_scale=4.000, wall=38542, train_wall=429157
| epoch 082:  15000 / 49553 loss=3.855, nll_loss=2.192, ppl=4.57, wps=57057, ups=5, wpb=10108.264, bsz=615.826, num_updates=719038, lr=3.72927e-05, gnorm=0.928, clip=0.000, oom=0.000, loss_scale=8.000, wall=38718, train_wall=429315
Invalid bert_input shape:torch.Size([4, 864])
| epoch 082:  16000 / 49553 loss=3.856, nll_loss=2.192, ppl=4.57, wps=57050, ups=5, wpb=10108.805, bsz=616.968, num_updates=720038, lr=3.72668e-05, gnorm=0.928, clip=0.000, oom=0.000, loss_scale=8.000, wall=38895, train_wall=429466
Invalid bert_input shape:torch.Size([7, 722])
| epoch 082:  17000 / 49553 loss=3.855, nll_loss=2.191, ppl=4.57, wps=57024, ups=5, wpb=10108.286, bsz=617.105, num_updates=721038, lr=3.7241e-05, gnorm=0.928, clip=0.000, oom=0.000, loss_scale=8.000, wall=39074, train_wall=429622
| epoch 082:  18000 / 49553 loss=3.855, nll_loss=2.191, ppl=4.57, wps=56943, ups=5, wpb=10108.429, bsz=617.695, num_updates=722038, lr=3.72152e-05, gnorm=0.928, clip=0.000, oom=0.000, loss_scale=8.000, wall=39256, train_wall=429785
Invalid bert_input shape:torch.Size([6, 546])
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 082:  19000 / 49553 loss=3.855, nll_loss=2.191, ppl=4.57, wps=56997, ups=5, wpb=10110.999, bsz=617.696, num_updates=723037, lr=3.71894e-05, gnorm=0.927, clip=0.000, oom=0.000, loss_scale=8.000, wall=39431, train_wall=429942
| epoch 082:  20000 / 49553 loss=3.856, nll_loss=2.192, ppl=4.57, wps=57027, ups=5, wpb=10110.024, bsz=617.680, num_updates=724037, lr=3.71638e-05, gnorm=0.928, clip=0.000, oom=0.000, loss_scale=8.000, wall=39606, train_wall=430098
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 082:  21000 / 49553 loss=3.856, nll_loss=2.193, ppl=4.57, wps=57040, ups=5, wpb=10109.458, bsz=618.060, num_updates=725036, lr=3.71381e-05, gnorm=0.928, clip=0.000, oom=0.000, loss_scale=4.000, wall=39782, train_wall=430255
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 082:  22000 / 49553 loss=3.857, nll_loss=2.193, ppl=4.57, wps=57060, ups=5, wpb=10107.131, bsz=618.471, num_updates=726035, lr=3.71126e-05, gnorm=0.928, clip=0.000, oom=0.000, loss_scale=2.000, wall=39957, train_wall=430411
Invalid bert_input shape:torch.Size([2, 1562])
| epoch 082:  23000 / 49553 loss=3.856, nll_loss=2.192, ppl=4.57, wps=57055, ups=5, wpb=10107.150, bsz=618.641, num_updates=727035, lr=3.70871e-05, gnorm=0.929, clip=0.000, oom=0.000, loss_scale=2.000, wall=40134, train_wall=430570
| epoch 082:  24000 / 49553 loss=3.856, nll_loss=2.192, ppl=4.57, wps=57025, ups=5, wpb=10108.386, bsz=618.813, num_updates=728035, lr=3.70616e-05, gnorm=0.929, clip=0.000, oom=0.000, loss_scale=2.000, wall=40314, train_wall=430731
Invalid bert_input shape:torch.Size([5, 638])
| epoch 082:  25000 / 49553 loss=3.856, nll_loss=2.192, ppl=4.57, wps=57007, ups=5, wpb=10107.990, bsz=618.774, num_updates=729035, lr=3.70361e-05, gnorm=0.929, clip=0.000, oom=0.000, loss_scale=2.000, wall=40493, train_wall=430891
| epoch 082:  26000 / 49553 loss=3.855, nll_loss=2.192, ppl=4.57, wps=56979, ups=5, wpb=10107.627, bsz=619.201, num_updates=730035, lr=3.70108e-05, gnorm=0.929, clip=0.000, oom=0.000, loss_scale=4.000, wall=40672, train_wall=431052
| epoch 082:  27000 / 49553 loss=3.856, nll_loss=2.192, ppl=4.57, wps=56963, ups=5, wpb=10105.905, bsz=619.164, num_updates=731035, lr=3.69855e-05, gnorm=0.929, clip=0.000, oom=0.000, loss_scale=4.000, wall=40850, train_wall=431211
Invalid bert_input shape:torch.Size([4, 790])
| epoch 082:  28000 / 49553 loss=3.856, nll_loss=2.193, ppl=4.57, wps=57001, ups=5, wpb=10105.977, bsz=618.960, num_updates=732035, lr=3.69602e-05, gnorm=0.929, clip=0.000, oom=0.000, loss_scale=4.000, wall=41024, train_wall=431368
| epoch 082:  29000 / 49553 loss=3.857, nll_loss=2.193, ppl=4.57, wps=56999, ups=5, wpb=10105.278, bsz=618.835, num_updates=733035, lr=3.6935e-05, gnorm=0.929, clip=0.000, oom=0.000, loss_scale=4.000, wall=41201, train_wall=431523
| WARNING: overflow detected, setting loss scale to: 4.0
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 082:  30000 / 49553 loss=3.857, nll_loss=2.193, ppl=4.57, wps=56985, ups=5, wpb=10105.781, bsz=619.144, num_updates=734033, lr=3.69098e-05, gnorm=0.929, clip=0.000, oom=0.000, loss_scale=2.000, wall=41380, train_wall=431675
Invalid bert_input shape:torch.Size([4, 837])
| epoch 082:  31000 / 49553 loss=3.858, nll_loss=2.194, ppl=4.58, wps=56960, ups=5, wpb=10103.030, bsz=618.834, num_updates=735033, lr=3.68847e-05, gnorm=0.930, clip=0.000, oom=0.000, loss_scale=2.000, wall=41558, train_wall=431833
| epoch 082:  32000 / 49553 loss=3.857, nll_loss=2.194, ppl=4.58, wps=56958, ups=5, wpb=10102.390, bsz=618.638, num_updates=736033, lr=3.68597e-05, gnorm=0.930, clip=0.000, oom=0.000, loss_scale=2.000, wall=41735, train_wall=431992
Invalid bert_input shape:torch.Size([3, 1119])
| epoch 082:  33000 / 49553 loss=3.858, nll_loss=2.194, ppl=4.58, wps=56979, ups=6, wpb=10102.121, bsz=618.467, num_updates=737033, lr=3.68346e-05, gnorm=0.930, clip=0.000, oom=0.000, loss_scale=2.000, wall=41910, train_wall=432148
Invalid bert_input shape:torch.Size([2, 1608])
| epoch 082:  34000 / 49553 loss=3.857, nll_loss=2.194, ppl=4.58, wps=56988, ups=6, wpb=10100.978, bsz=618.609, num_updates=738033, lr=3.68097e-05, gnorm=0.930, clip=0.000, oom=0.000, loss_scale=2.000, wall=42086, train_wall=432304
| epoch 082:  35000 / 49553 loss=3.858, nll_loss=2.194, ppl=4.58, wps=57003, ups=6, wpb=10099.771, bsz=618.873, num_updates=739033, lr=3.67848e-05, gnorm=0.930, clip=0.000, oom=0.000, loss_scale=4.000, wall=42261, train_wall=432459
Invalid bert_input shape:torch.Size([5, 907])
| epoch 082:  36000 / 49553 loss=3.858, nll_loss=2.195, ppl=4.58, wps=57017, ups=6, wpb=10099.369, bsz=618.945, num_updates=740033, lr=3.67599e-05, gnorm=0.930, clip=0.000, oom=0.000, loss_scale=4.000, wall=42436, train_wall=432616
Invalid bert_input shape:torch.Size([4, 859])
| epoch 082:  37000 / 49553 loss=3.858, nll_loss=2.195, ppl=4.58, wps=57030, ups=6, wpb=10098.824, bsz=619.100, num_updates=741033, lr=3.67351e-05, gnorm=0.930, clip=0.000, oom=0.000, loss_scale=4.000, wall=42611, train_wall=432773
| epoch 082:  38000 / 49553 loss=3.858, nll_loss=2.195, ppl=4.58, wps=57048, ups=6, wpb=10100.839, bsz=618.892, num_updates=742033, lr=3.67103e-05, gnorm=0.930, clip=0.000, oom=0.000, loss_scale=4.000, wall=42788, train_wall=432930
| epoch 082:  39000 / 49553 loss=3.858, nll_loss=2.195, ppl=4.58, wps=57040, ups=6, wpb=10099.341, bsz=619.072, num_updates=743033, lr=3.66856e-05, gnorm=0.931, clip=0.000, oom=0.000, loss_scale=8.000, wall=42965, train_wall=433088
| epoch 082:  40000 / 49553 loss=3.858, nll_loss=2.195, ppl=4.58, wps=57023, ups=6, wpb=10098.748, bsz=618.988, num_updates=744033, lr=3.6661e-05, gnorm=0.931, clip=0.000, oom=0.000, loss_scale=8.000, wall=43144, train_wall=433249
| epoch 082:  41000 / 49553 loss=3.858, nll_loss=2.195, ppl=4.58, wps=57022, ups=6, wpb=10098.359, bsz=618.856, num_updates=745033, lr=3.66364e-05, gnorm=0.931, clip=0.000, oom=0.000, loss_scale=8.000, wall=43320, train_wall=433407
| epoch 082:  42000 / 49553 loss=3.858, nll_loss=2.195, ppl=4.58, wps=57010, ups=6, wpb=10097.472, bsz=618.754, num_updates=746033, lr=3.66118e-05, gnorm=0.931, clip=0.000, oom=0.000, loss_scale=8.000, wall=43498, train_wall=433567
| WARNING: overflow detected, setting loss scale to: 8.0
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 082:  43000 / 49553 loss=3.858, nll_loss=2.195, ppl=4.58, wps=57016, ups=6, wpb=10099.180, bsz=618.749, num_updates=747031, lr=3.65873e-05, gnorm=0.931, clip=0.000, oom=0.000, loss_scale=4.000, wall=43676, train_wall=433725
| epoch 082:  44000 / 49553 loss=3.858, nll_loss=2.195, ppl=4.58, wps=57021, ups=6, wpb=10100.735, bsz=618.921, num_updates=748031, lr=3.65629e-05, gnorm=0.931, clip=0.000, oom=0.000, loss_scale=4.000, wall=43853, train_wall=433880
| epoch 082:  45000 / 49553 loss=3.859, nll_loss=2.196, ppl=4.58, wps=57045, ups=6, wpb=10101.099, bsz=618.786, num_updates=749031, lr=3.65384e-05, gnorm=0.931, clip=0.000, oom=0.000, loss_scale=4.000, wall=44027, train_wall=434036
| epoch 082:  46000 / 49553 loss=3.859, nll_loss=2.196, ppl=4.58, wps=57056, ups=6, wpb=10100.571, bsz=619.052, num_updates=750031, lr=3.65141e-05, gnorm=0.931, clip=0.000, oom=0.000, loss_scale=4.000, wall=44202, train_wall=434192
Invalid bert_input shape:torch.Size([2, 1513])
Invalid bert_input shape:torch.Size([4, 800])
| epoch 082:  47000 / 49553 loss=3.859, nll_loss=2.196, ppl=4.58, wps=57042, ups=6, wpb=10100.676, bsz=619.047, num_updates=751031, lr=3.64898e-05, gnorm=0.932, clip=0.000, oom=0.000, loss_scale=8.000, wall=44382, train_wall=434345
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 082:  48000 / 49553 loss=3.859, nll_loss=2.196, ppl=4.58, wps=57059, ups=6, wpb=10101.102, bsz=618.843, num_updates=752030, lr=3.64655e-05, gnorm=0.932, clip=0.000, oom=0.000, loss_scale=4.000, wall=44556, train_wall=434503
| epoch 082:  49000 / 49553 loss=3.859, nll_loss=2.196, ppl=4.58, wps=57065, ups=6, wpb=10099.476, bsz=618.596, num_updates=753030, lr=3.64413e-05, gnorm=0.932, clip=0.000, oom=0.000, loss_scale=4.000, wall=44731, train_wall=434660
| epoch 082 | loss 3.859 | nll_loss 2.196 | ppl 4.58 | wps 57073 | ups 6 | wpb 10099.901 | bsz 618.632 | num_updates 753582 | lr 3.6428e-05 | gnorm 0.932 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 44828 | train_wall 434746
| epoch 082 | valid on 'valid' subset | loss 2.748 | nll_loss 0.930 | ppl 1.90 | num_updates 753582 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint82.pt (epoch 82 @ 753582 updates) (writing took 9.067753076553345 seconds)
| epoch 083:   1000 / 49553 loss=3.864, nll_loss=2.202, ppl=4.60, wps=56693, ups=3, wpb=10114.419, bsz=611.437, num_updates=754583, lr=3.64038e-05, gnorm=0.943, clip=0.000, oom=0.000, loss_scale=4.000, wall=45141, train_wall=434906
| epoch 083:   2000 / 49553 loss=3.854, nll_loss=2.190, ppl=4.56, wps=57022, ups=4, wpb=10135.377, bsz=619.528, num_updates=755583, lr=3.63797e-05, gnorm=0.933, clip=0.000, oom=0.000, loss_scale=4.000, wall=45318, train_wall=435065
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 083:   3000 / 49553 loss=3.851, nll_loss=2.187, ppl=4.55, wps=56862, ups=4, wpb=10131.847, bsz=623.646, num_updates=756582, lr=3.63557e-05, gnorm=0.934, clip=0.000, oom=0.000, loss_scale=4.000, wall=45497, train_wall=435225
| epoch 083:   4000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=56935, ups=5, wpb=10131.684, bsz=622.092, num_updates=757582, lr=3.63317e-05, gnorm=0.933, clip=0.000, oom=0.000, loss_scale=4.000, wall=45674, train_wall=435384
| epoch 083:   5000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=57125, ups=5, wpb=10130.613, bsz=620.575, num_updates=758582, lr=3.63077e-05, gnorm=0.935, clip=0.000, oom=0.000, loss_scale=4.000, wall=45849, train_wall=435541
| epoch 083:   6000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=56958, ups=5, wpb=10121.757, bsz=623.452, num_updates=759582, lr=3.62838e-05, gnorm=0.936, clip=0.000, oom=0.000, loss_scale=4.000, wall=46028, train_wall=435700
| epoch 083:   7000 / 49553 loss=3.851, nll_loss=2.187, ppl=4.55, wps=56878, ups=5, wpb=10117.089, bsz=623.317, num_updates=760582, lr=3.62599e-05, gnorm=0.938, clip=0.000, oom=0.000, loss_scale=8.000, wall=46207, train_wall=435861
Invalid bert_input shape:torch.Size([4, 837])
| epoch 083:   8000 / 49553 loss=3.852, nll_loss=2.188, ppl=4.56, wps=56801, ups=5, wpb=10109.651, bsz=623.049, num_updates=761582, lr=3.62361e-05, gnorm=0.938, clip=0.000, oom=0.000, loss_scale=8.000, wall=46386, train_wall=436021
Invalid bert_input shape:torch.Size([4, 790])
| epoch 083:   9000 / 49553 loss=3.852, nll_loss=2.188, ppl=4.56, wps=56881, ups=5, wpb=10114.376, bsz=621.604, num_updates=762582, lr=3.62124e-05, gnorm=0.938, clip=0.000, oom=0.000, loss_scale=8.000, wall=46562, train_wall=436179
| epoch 083:  10000 / 49553 loss=3.853, nll_loss=2.189, ppl=4.56, wps=56992, ups=5, wpb=10113.804, bsz=621.093, num_updates=763582, lr=3.61886e-05, gnorm=0.938, clip=0.000, oom=0.000, loss_scale=8.000, wall=46737, train_wall=436336
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 083:  11000 / 49553 loss=3.853, nll_loss=2.189, ppl=4.56, wps=57031, ups=5, wpb=10108.698, bsz=621.807, num_updates=764581, lr=3.6165e-05, gnorm=0.938, clip=0.000, oom=0.000, loss_scale=8.000, wall=46912, train_wall=436493
| epoch 083:  12000 / 49553 loss=3.853, nll_loss=2.189, ppl=4.56, wps=57096, ups=5, wpb=10113.714, bsz=621.362, num_updates=765581, lr=3.61414e-05, gnorm=0.939, clip=0.000, oom=0.000, loss_scale=8.000, wall=47087, train_wall=436650
Invalid bert_input shape:torch.Size([6, 555])
| epoch 083:  13000 / 49553 loss=3.853, nll_loss=2.189, ppl=4.56, wps=57112, ups=5, wpb=10106.745, bsz=621.469, num_updates=766581, lr=3.61178e-05, gnorm=0.939, clip=0.000, oom=0.000, loss_scale=8.000, wall=47262, train_wall=436806
| epoch 083:  14000 / 49553 loss=3.853, nll_loss=2.190, ppl=4.56, wps=57124, ups=5, wpb=10107.131, bsz=620.817, num_updates=767581, lr=3.60942e-05, gnorm=0.939, clip=0.000, oom=0.000, loss_scale=8.000, wall=47439, train_wall=436963
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([4, 864])
| epoch 083:  15000 / 49553 loss=3.854, nll_loss=2.190, ppl=4.56, wps=57083, ups=5, wpb=10109.678, bsz=620.460, num_updates=768580, lr=3.60708e-05, gnorm=0.939, clip=0.000, oom=0.000, loss_scale=4.000, wall=47618, train_wall=437115
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 083:  16000 / 49553 loss=3.853, nll_loss=2.189, ppl=4.56, wps=57072, ups=5, wpb=10113.528, bsz=620.625, num_updates=769579, lr=3.60474e-05, gnorm=0.939, clip=0.000, oom=0.000, loss_scale=2.000, wall=47797, train_wall=437269
| epoch 083:  17000 / 49553 loss=3.853, nll_loss=2.189, ppl=4.56, wps=57095, ups=5, wpb=10114.054, bsz=620.640, num_updates=770579, lr=3.6024e-05, gnorm=0.940, clip=0.000, oom=0.000, loss_scale=2.000, wall=47973, train_wall=437425
| epoch 083:  18000 / 49553 loss=3.853, nll_loss=2.190, ppl=4.56, wps=57113, ups=5, wpb=10112.601, bsz=620.341, num_updates=771579, lr=3.60006e-05, gnorm=0.940, clip=0.000, oom=0.000, loss_scale=2.000, wall=48149, train_wall=437581
Invalid bert_input shape:torch.Size([5, 869])
| epoch 083:  19000 / 49553 loss=3.853, nll_loss=2.189, ppl=4.56, wps=57105, ups=5, wpb=10109.742, bsz=619.995, num_updates=772579, lr=3.59773e-05, gnorm=0.940, clip=0.000, oom=0.000, loss_scale=2.000, wall=48325, train_wall=437740
Invalid bert_input shape:torch.Size([6, 1334])
| epoch 083:  20000 / 49553 loss=3.854, nll_loss=2.190, ppl=4.56, wps=57076, ups=5, wpb=10107.144, bsz=620.171, num_updates=773579, lr=3.5954e-05, gnorm=0.940, clip=0.000, oom=0.000, loss_scale=2.000, wall=48503, train_wall=437899
| epoch 083:  21000 / 49553 loss=3.854, nll_loss=2.190, ppl=4.56, wps=57056, ups=5, wpb=10109.703, bsz=620.343, num_updates=774579, lr=3.59308e-05, gnorm=0.940, clip=0.000, oom=0.000, loss_scale=4.000, wall=48682, train_wall=438059
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 083:  22000 / 49553 loss=3.854, nll_loss=2.190, ppl=4.56, wps=57022, ups=5, wpb=10107.986, bsz=619.781, num_updates=775578, lr=3.59077e-05, gnorm=0.941, clip=0.000, oom=0.000, loss_scale=2.000, wall=48861, train_wall=438220
| epoch 083:  23000 / 49553 loss=3.854, nll_loss=2.190, ppl=4.56, wps=57052, ups=5, wpb=10108.697, bsz=620.225, num_updates=776578, lr=3.58845e-05, gnorm=0.941, clip=0.000, oom=0.000, loss_scale=2.000, wall=49037, train_wall=438378
| epoch 083:  24000 / 49553 loss=3.854, nll_loss=2.191, ppl=4.56, wps=57070, ups=5, wpb=10108.757, bsz=620.231, num_updates=777578, lr=3.58615e-05, gnorm=0.941, clip=0.000, oom=0.000, loss_scale=2.000, wall=49212, train_wall=438535
| epoch 083:  25000 / 49553 loss=3.854, nll_loss=2.190, ppl=4.56, wps=57100, ups=5, wpb=10109.505, bsz=620.432, num_updates=778578, lr=3.58384e-05, gnorm=0.941, clip=0.000, oom=0.000, loss_scale=2.000, wall=49388, train_wall=438692
| epoch 083:  26000 / 49553 loss=3.855, nll_loss=2.191, ppl=4.57, wps=57134, ups=5, wpb=10111.554, bsz=620.337, num_updates=779578, lr=3.58154e-05, gnorm=0.941, clip=0.000, oom=0.000, loss_scale=4.000, wall=49563, train_wall=438848
| epoch 083:  27000 / 49553 loss=3.855, nll_loss=2.191, ppl=4.57, wps=57159, ups=5, wpb=10111.652, bsz=620.305, num_updates=780578, lr=3.57925e-05, gnorm=0.941, clip=0.000, oom=0.000, loss_scale=4.000, wall=49738, train_wall=439005
Invalid bert_input shape:torch.Size([6, 546])
| epoch 083:  28000 / 49553 loss=3.855, nll_loss=2.192, ppl=4.57, wps=57178, ups=6, wpb=10111.596, bsz=620.233, num_updates=781578, lr=3.57696e-05, gnorm=0.941, clip=0.000, oom=0.000, loss_scale=4.000, wall=49913, train_wall=439162
| epoch 083:  29000 / 49553 loss=3.855, nll_loss=2.192, ppl=4.57, wps=57193, ups=6, wpb=10109.867, bsz=620.409, num_updates=782578, lr=3.57467e-05, gnorm=0.942, clip=0.000, oom=0.000, loss_scale=4.000, wall=50088, train_wall=439318
Invalid bert_input shape:torch.Size([3, 1514])
| epoch 083:  30000 / 49553 loss=3.855, nll_loss=2.192, ppl=4.57, wps=57196, ups=6, wpb=10107.013, bsz=620.338, num_updates=783578, lr=3.57239e-05, gnorm=0.942, clip=0.000, oom=0.000, loss_scale=8.000, wall=50263, train_wall=439474
| epoch 083:  31000 / 49553 loss=3.855, nll_loss=2.192, ppl=4.57, wps=57231, ups=6, wpb=10109.235, bsz=620.407, num_updates=784578, lr=3.57011e-05, gnorm=0.942, clip=0.000, oom=0.000, loss_scale=8.000, wall=50437, train_wall=439631
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 083:  32000 / 49553 loss=3.856, nll_loss=2.192, ppl=4.57, wps=57228, ups=6, wpb=10106.236, bsz=620.500, num_updates=785577, lr=3.56784e-05, gnorm=0.942, clip=0.000, oom=0.000, loss_scale=4.000, wall=50612, train_wall=439787
Invalid bert_input shape:torch.Size([6, 784])
Invalid bert_input shape:torch.Size([2, 1513])
| epoch 083:  33000 / 49553 loss=3.855, nll_loss=2.192, ppl=4.57, wps=57232, ups=6, wpb=10105.927, bsz=620.232, num_updates=786577, lr=3.56557e-05, gnorm=0.942, clip=0.000, oom=0.000, loss_scale=4.000, wall=50788, train_wall=439945
| epoch 083:  34000 / 49553 loss=3.855, nll_loss=2.192, ppl=4.57, wps=57254, ups=6, wpb=10107.887, bsz=620.001, num_updates=787577, lr=3.56331e-05, gnorm=0.942, clip=0.000, oom=0.000, loss_scale=4.000, wall=50964, train_wall=440103
| epoch 083:  35000 / 49553 loss=3.855, nll_loss=2.192, ppl=4.57, wps=57239, ups=6, wpb=10109.375, bsz=619.752, num_updates=788577, lr=3.56105e-05, gnorm=0.942, clip=0.000, oom=0.000, loss_scale=4.000, wall=51143, train_wall=440264
| epoch 083:  36000 / 49553 loss=3.855, nll_loss=2.192, ppl=4.57, wps=57228, ups=6, wpb=10109.048, bsz=619.826, num_updates=789577, lr=3.55879e-05, gnorm=0.942, clip=0.000, oom=0.000, loss_scale=8.000, wall=51320, train_wall=440423
| epoch 083:  37000 / 49553 loss=3.856, nll_loss=2.192, ppl=4.57, wps=57241, ups=6, wpb=10109.197, bsz=619.738, num_updates=790577, lr=3.55654e-05, gnorm=0.943, clip=0.000, oom=0.000, loss_scale=8.000, wall=51496, train_wall=440579
Invalid bert_input shape:torch.Size([4, 832])
| epoch 083:  38000 / 49553 loss=3.856, nll_loss=2.193, ppl=4.57, wps=57245, ups=6, wpb=10108.196, bsz=619.586, num_updates=791577, lr=3.55429e-05, gnorm=0.943, clip=0.000, oom=0.000, loss_scale=8.000, wall=51671, train_wall=440736
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 083:  39000 / 49553 loss=3.856, nll_loss=2.193, ppl=4.57, wps=57262, ups=6, wpb=10108.546, bsz=619.219, num_updates=792576, lr=3.55205e-05, gnorm=0.943, clip=0.000, oom=0.000, loss_scale=4.000, wall=51846, train_wall=440892
| epoch 083:  40000 / 49553 loss=3.856, nll_loss=2.193, ppl=4.57, wps=57261, ups=6, wpb=10106.809, bsz=619.157, num_updates=793576, lr=3.54982e-05, gnorm=0.943, clip=0.000, oom=0.000, loss_scale=4.000, wall=52021, train_wall=441049
Invalid bert_input shape:torch.Size([5, 636])
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 083:  41000 / 49553 loss=3.856, nll_loss=2.192, ppl=4.57, wps=57255, ups=6, wpb=10104.370, bsz=619.309, num_updates=794575, lr=3.54758e-05, gnorm=0.943, clip=0.000, oom=0.000, loss_scale=2.000, wall=52197, train_wall=441205
| epoch 083:  42000 / 49553 loss=3.856, nll_loss=2.193, ppl=4.57, wps=57279, ups=6, wpb=10106.119, bsz=619.169, num_updates=795575, lr=3.54535e-05, gnorm=0.943, clip=0.000, oom=0.000, loss_scale=2.000, wall=52371, train_wall=441361
| WARNING: overflow detected, setting loss scale to: 1.0
| epoch 083:  43000 / 49553 loss=3.856, nll_loss=2.193, ppl=4.57, wps=57290, ups=6, wpb=10105.857, bsz=619.039, num_updates=796574, lr=3.54313e-05, gnorm=0.944, clip=0.000, oom=0.000, loss_scale=1.000, wall=52546, train_wall=441517
| epoch 083:  44000 / 49553 loss=3.856, nll_loss=2.193, ppl=4.57, wps=57293, ups=6, wpb=10104.515, bsz=618.877, num_updates=797574, lr=3.54091e-05, gnorm=0.944, clip=0.000, oom=0.000, loss_scale=1.000, wall=52721, train_wall=441673
Invalid bert_input shape:torch.Size([6, 528])
| epoch 083:  45000 / 49553 loss=3.856, nll_loss=2.193, ppl=4.57, wps=57297, ups=6, wpb=10103.007, bsz=618.966, num_updates=798574, lr=3.53869e-05, gnorm=0.944, clip=0.000, oom=0.000, loss_scale=1.000, wall=52895, train_wall=441829
| epoch 083:  46000 / 49553 loss=3.856, nll_loss=2.193, ppl=4.57, wps=57301, ups=6, wpb=10102.728, bsz=618.775, num_updates=799574, lr=3.53648e-05, gnorm=0.944, clip=0.000, oom=0.000, loss_scale=1.000, wall=53071, train_wall=441986
| epoch 083:  47000 / 49553 loss=3.856, nll_loss=2.193, ppl=4.57, wps=57303, ups=6, wpb=10102.270, bsz=618.780, num_updates=800574, lr=3.53427e-05, gnorm=0.945, clip=0.000, oom=0.000, loss_scale=2.000, wall=53247, train_wall=442142
| epoch 083:  48000 / 49553 loss=3.856, nll_loss=2.193, ppl=4.57, wps=57293, ups=6, wpb=10102.005, bsz=618.815, num_updates=801574, lr=3.53206e-05, gnorm=0.945, clip=0.000, oom=0.000, loss_scale=2.000, wall=53424, train_wall=442295
| epoch 083:  49000 / 49553 loss=3.857, nll_loss=2.193, ppl=4.57, wps=57293, ups=6, wpb=10101.203, bsz=618.501, num_updates=802574, lr=3.52986e-05, gnorm=0.945, clip=0.000, oom=0.000, loss_scale=2.000, wall=53600, train_wall=442453
| epoch 083 | loss 3.857 | nll_loss 2.193 | ppl 4.57 | wps 57289 | ups 6 | wpb 10099.972 | bsz 618.665 | num_updates 803126 | lr 3.52865e-05 | gnorm 0.945 | clip 0.000 | oom 0.000 | loss_scale 2.000 | wall 53697 | train_wall 442539
| epoch 083 | valid on 'valid' subset | loss 2.764 | nll_loss 0.947 | ppl 1.93 | num_updates 803126 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint83.pt (epoch 83 @ 803126 updates) (writing took 19.463279962539673 seconds)
| epoch 084:   1000 / 49553 loss=3.836, nll_loss=2.170, ppl=4.50, wps=56523, ups=3, wpb=10102.637, bsz=630.385, num_updates=804127, lr=3.52645e-05, gnorm=0.944, clip=0.000, oom=0.000, loss_scale=2.000, wall=54020, train_wall=442698
| epoch 084:   2000 / 49553 loss=3.845, nll_loss=2.180, ppl=4.53, wps=56749, ups=4, wpb=10065.439, bsz=616.591, num_updates=805127, lr=3.52426e-05, gnorm=0.954, clip=0.000, oom=0.000, loss_scale=4.000, wall=54196, train_wall=442856
Invalid bert_input shape:torch.Size([6, 528])
| epoch 084:   3000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=56991, ups=4, wpb=10050.631, bsz=617.535, num_updates=806127, lr=3.52207e-05, gnorm=0.955, clip=0.000, oom=0.000, loss_scale=4.000, wall=54370, train_wall=443011
| epoch 084:   4000 / 49553 loss=3.846, nll_loss=2.182, ppl=4.54, wps=57198, ups=5, wpb=10063.204, bsz=616.955, num_updates=807127, lr=3.51989e-05, gnorm=0.953, clip=0.000, oom=0.000, loss_scale=4.000, wall=54545, train_wall=443168
| epoch 084:   5000 / 49553 loss=3.846, nll_loss=2.181, ppl=4.54, wps=57298, ups=5, wpb=10075.882, bsz=615.911, num_updates=808127, lr=3.51771e-05, gnorm=0.953, clip=0.000, oom=0.000, loss_scale=4.000, wall=54720, train_wall=443326
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 084:   6000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=57251, ups=5, wpb=10076.802, bsz=616.422, num_updates=809126, lr=3.51554e-05, gnorm=0.954, clip=0.000, oom=0.000, loss_scale=4.000, wall=54897, train_wall=443484
Invalid bert_input shape:torch.Size([5, 627])
| epoch 084:   7000 / 49553 loss=3.847, nll_loss=2.182, ppl=4.54, wps=57303, ups=5, wpb=10076.881, bsz=617.274, num_updates=810126, lr=3.51337e-05, gnorm=0.954, clip=0.000, oom=0.000, loss_scale=4.000, wall=55072, train_wall=443640
Invalid bert_input shape:torch.Size([5, 994])
Invalid bert_input shape:torch.Size([7, 573])
| epoch 084:   8000 / 49553 loss=3.847, nll_loss=2.182, ppl=4.54, wps=57320, ups=5, wpb=10083.850, bsz=618.475, num_updates=811126, lr=3.5112e-05, gnorm=0.954, clip=0.000, oom=0.000, loss_scale=4.000, wall=55248, train_wall=443797
| epoch 084:   9000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=57196, ups=5, wpb=10086.496, bsz=619.157, num_updates=812126, lr=3.50904e-05, gnorm=0.954, clip=0.000, oom=0.000, loss_scale=4.000, wall=55428, train_wall=443948
Invalid bert_input shape:torch.Size([7, 840])
| epoch 084:  10000 / 49553 loss=3.848, nll_loss=2.184, ppl=4.54, wps=57113, ups=5, wpb=10087.365, bsz=619.843, num_updates=813126, lr=3.50688e-05, gnorm=0.954, clip=0.000, oom=0.000, loss_scale=4.000, wall=55607, train_wall=444101
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 084:  11000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=57146, ups=5, wpb=10089.651, bsz=620.828, num_updates=814125, lr=3.50473e-05, gnorm=0.955, clip=0.000, oom=0.000, loss_scale=4.000, wall=55783, train_wall=444258
| epoch 084:  12000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=57182, ups=5, wpb=10087.019, bsz=621.251, num_updates=815125, lr=3.50258e-05, gnorm=0.955, clip=0.000, oom=0.000, loss_scale=4.000, wall=55958, train_wall=444414
Invalid bert_input shape:torch.Size([5, 729])
| epoch 084:  13000 / 49553 loss=3.848, nll_loss=2.184, ppl=4.54, wps=57235, ups=5, wpb=10090.965, bsz=621.521, num_updates=816125, lr=3.50043e-05, gnorm=0.955, clip=0.000, oom=0.000, loss_scale=4.000, wall=56133, train_wall=444571
| epoch 084:  14000 / 49553 loss=3.848, nll_loss=2.184, ppl=4.54, wps=57297, ups=5, wpb=10096.106, bsz=621.657, num_updates=817125, lr=3.49829e-05, gnorm=0.954, clip=0.000, oom=0.000, loss_scale=4.000, wall=56308, train_wall=444728
| epoch 084:  15000 / 49553 loss=3.848, nll_loss=2.184, ppl=4.54, wps=57339, ups=5, wpb=10097.776, bsz=621.229, num_updates=818125, lr=3.49615e-05, gnorm=0.954, clip=0.000, oom=0.000, loss_scale=8.000, wall=56482, train_wall=444885
| epoch 084:  16000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=57386, ups=5, wpb=10099.346, bsz=620.629, num_updates=819125, lr=3.49402e-05, gnorm=0.954, clip=0.000, oom=0.000, loss_scale=8.000, wall=56657, train_wall=445041
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 084:  17000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=57406, ups=5, wpb=10100.827, bsz=619.925, num_updates=820124, lr=3.49189e-05, gnorm=0.954, clip=0.000, oom=0.000, loss_scale=4.000, wall=56832, train_wall=445198
| epoch 084:  18000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=57419, ups=5, wpb=10101.285, bsz=619.848, num_updates=821124, lr=3.48976e-05, gnorm=0.954, clip=0.000, oom=0.000, loss_scale=4.000, wall=57007, train_wall=445354
Invalid bert_input shape:torch.Size([3, 1160])
| epoch 084:  19000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=57420, ups=5, wpb=10099.162, bsz=620.280, num_updates=822124, lr=3.48764e-05, gnorm=0.955, clip=0.000, oom=0.000, loss_scale=4.000, wall=57182, train_wall=445510
| epoch 084:  20000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=57438, ups=5, wpb=10099.872, bsz=620.144, num_updates=823124, lr=3.48552e-05, gnorm=0.955, clip=0.000, oom=0.000, loss_scale=4.000, wall=57357, train_wall=445667
Invalid bert_input shape:torch.Size([2, 1608])
| epoch 084:  21000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=57466, ups=5, wpb=10105.159, bsz=619.841, num_updates=824124, lr=3.4834e-05, gnorm=0.955, clip=0.000, oom=0.000, loss_scale=8.000, wall=57533, train_wall=445824
Invalid bert_input shape:torch.Size([4, 760])
Invalid bert_input shape:torch.Size([6, 863])
| epoch 084:  22000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=57481, ups=5, wpb=10105.723, bsz=619.606, num_updates=825124, lr=3.48129e-05, gnorm=0.955, clip=0.000, oom=0.000, loss_scale=8.000, wall=57708, train_wall=445981
| epoch 084:  23000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=57483, ups=5, wpb=10104.932, bsz=619.112, num_updates=826124, lr=3.47918e-05, gnorm=0.955, clip=0.000, oom=0.000, loss_scale=8.000, wall=57884, train_wall=446138
Invalid bert_input shape:torch.Size([5, 638])
| epoch 084:  24000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=57412, ups=5, wpb=10102.998, bsz=619.319, num_updates=827124, lr=3.47708e-05, gnorm=0.955, clip=0.000, oom=0.000, loss_scale=8.000, wall=58064, train_wall=446300
| WARNING: overflow detected, setting loss scale to: 8.0
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 084:  25000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=57413, ups=6, wpb=10102.356, bsz=619.526, num_updates=828122, lr=3.47498e-05, gnorm=0.955, clip=0.000, oom=0.000, loss_scale=4.000, wall=58239, train_wall=446456
| epoch 084:  26000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=57412, ups=6, wpb=10099.651, bsz=619.467, num_updates=829122, lr=3.47289e-05, gnorm=0.955, clip=0.000, oom=0.000, loss_scale=4.000, wall=58414, train_wall=446613
Invalid bert_input shape:torch.Size([4, 1167])
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 084:  27000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=57373, ups=6, wpb=10100.356, bsz=619.187, num_updates=830121, lr=3.4708e-05, gnorm=0.955, clip=0.000, oom=0.000, loss_scale=2.000, wall=58593, train_wall=446772
Invalid bert_input shape:torch.Size([7, 722])
| epoch 084:  28000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=57341, ups=6, wpb=10100.144, bsz=619.233, num_updates=831121, lr=3.46871e-05, gnorm=0.955, clip=0.000, oom=0.000, loss_scale=2.000, wall=58772, train_wall=446932
| epoch 084:  29000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=57326, ups=6, wpb=10097.998, bsz=619.471, num_updates=832121, lr=3.46662e-05, gnorm=0.956, clip=0.000, oom=0.000, loss_scale=2.000, wall=58948, train_wall=447090
Invalid bert_input shape:torch.Size([3, 1514])
| epoch 084:  30000 / 49553 loss=3.850, nll_loss=2.187, ppl=4.55, wps=57313, ups=6, wpb=10097.837, bsz=619.688, num_updates=833121, lr=3.46454e-05, gnorm=0.956, clip=0.000, oom=0.000, loss_scale=2.000, wall=59126, train_wall=447248
| epoch 084:  31000 / 49553 loss=3.850, nll_loss=2.187, ppl=4.55, wps=57280, ups=6, wpb=10097.715, bsz=620.000, num_updates=834121, lr=3.46247e-05, gnorm=0.956, clip=0.000, oom=0.000, loss_scale=4.000, wall=59305, train_wall=447409
| epoch 084:  32000 / 49553 loss=3.851, nll_loss=2.187, ppl=4.55, wps=57270, ups=6, wpb=10097.224, bsz=620.295, num_updates=835121, lr=3.46039e-05, gnorm=0.956, clip=0.000, oom=0.000, loss_scale=4.000, wall=59482, train_wall=447563
Invalid bert_input shape:torch.Size([2, 1562])
| epoch 084:  33000 / 49553 loss=3.851, nll_loss=2.187, ppl=4.55, wps=57220, ups=6, wpb=10095.398, bsz=620.353, num_updates=836121, lr=3.45832e-05, gnorm=0.957, clip=0.000, oom=0.000, loss_scale=4.000, wall=59662, train_wall=447715
| epoch 084:  34000 / 49553 loss=3.851, nll_loss=2.187, ppl=4.55, wps=57232, ups=6, wpb=10094.831, bsz=620.281, num_updates=837121, lr=3.45626e-05, gnorm=0.957, clip=0.000, oom=0.000, loss_scale=4.000, wall=59837, train_wall=447872
| epoch 084:  35000 / 49553 loss=3.851, nll_loss=2.187, ppl=4.55, wps=57220, ups=6, wpb=10094.597, bsz=620.312, num_updates=838121, lr=3.45419e-05, gnorm=0.957, clip=0.000, oom=0.000, loss_scale=8.000, wall=60015, train_wall=448031
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 084:  36000 / 49553 loss=3.851, nll_loss=2.188, ppl=4.56, wps=57166, ups=6, wpb=10093.338, bsz=619.920, num_updates=839120, lr=3.45214e-05, gnorm=0.958, clip=0.000, oom=0.000, loss_scale=4.000, wall=60196, train_wall=448194
| epoch 084:  37000 / 49553 loss=3.852, nll_loss=2.189, ppl=4.56, wps=57151, ups=6, wpb=10093.550, bsz=619.779, num_updates=840120, lr=3.45008e-05, gnorm=0.958, clip=0.000, oom=0.000, loss_scale=4.000, wall=60375, train_wall=448355
| epoch 084:  38000 / 49553 loss=3.852, nll_loss=2.189, ppl=4.56, wps=57175, ups=6, wpb=10094.219, bsz=619.271, num_updates=841120, lr=3.44803e-05, gnorm=0.958, clip=0.000, oom=0.000, loss_scale=4.000, wall=60549, train_wall=448511
| epoch 084:  39000 / 49553 loss=3.853, nll_loss=2.189, ppl=4.56, wps=57194, ups=6, wpb=10096.912, bsz=619.403, num_updates=842120, lr=3.44598e-05, gnorm=0.958, clip=0.000, oom=0.000, loss_scale=4.000, wall=60725, train_wall=448669
| epoch 084:  40000 / 49553 loss=3.853, nll_loss=2.189, ppl=4.56, wps=57212, ups=6, wpb=10098.313, bsz=619.196, num_updates=843120, lr=3.44394e-05, gnorm=0.958, clip=0.000, oom=0.000, loss_scale=8.000, wall=60900, train_wall=448825
| epoch 084:  41000 / 49553 loss=3.853, nll_loss=2.189, ppl=4.56, wps=57219, ups=6, wpb=10098.973, bsz=619.156, num_updates=844120, lr=3.4419e-05, gnorm=0.958, clip=0.000, oom=0.000, loss_scale=8.000, wall=61076, train_wall=448982
Invalid bert_input shape:torch.Size([6, 550])
| epoch 084:  42000 / 49553 loss=3.853, nll_loss=2.189, ppl=4.56, wps=57208, ups=6, wpb=10099.423, bsz=619.381, num_updates=845120, lr=3.43986e-05, gnorm=0.958, clip=0.000, oom=0.000, loss_scale=8.000, wall=61255, train_wall=449140
| epoch 084:  43000 / 49553 loss=3.853, nll_loss=2.189, ppl=4.56, wps=57219, ups=6, wpb=10099.257, bsz=619.157, num_updates=846120, lr=3.43783e-05, gnorm=0.958, clip=0.000, oom=0.000, loss_scale=8.000, wall=61429, train_wall=449298
Invalid bert_input shape:torch.Size([5, 602])
Invalid bert_input shape:torch.Size([8, 844])
| epoch 084:  44000 / 49553 loss=3.853, nll_loss=2.190, ppl=4.56, wps=57197, ups=6, wpb=10098.484, bsz=619.048, num_updates=847120, lr=3.4358e-05, gnorm=0.959, clip=0.000, oom=0.000, loss_scale=16.000, wall=61608, train_wall=449459
| WARNING: overflow detected, setting loss scale to: 8.0
Invalid bert_input shape:torch.Size([4, 720])
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 084:  45000 / 49553 loss=3.853, nll_loss=2.190, ppl=4.56, wps=57177, ups=6, wpb=10098.689, bsz=619.046, num_updates=848118, lr=3.43378e-05, gnorm=0.959, clip=0.000, oom=0.000, loss_scale=4.000, wall=61788, train_wall=449620
| epoch 084:  46000 / 49553 loss=3.854, nll_loss=2.190, ppl=4.56, wps=57194, ups=6, wpb=10099.589, bsz=618.978, num_updates=849118, lr=3.43175e-05, gnorm=0.959, clip=0.000, oom=0.000, loss_scale=4.000, wall=61962, train_wall=449777
| epoch 084:  47000 / 49553 loss=3.854, nll_loss=2.191, ppl=4.57, wps=57196, ups=6, wpb=10097.975, bsz=618.828, num_updates=850118, lr=3.42973e-05, gnorm=0.959, clip=0.000, oom=0.000, loss_scale=4.000, wall=62137, train_wall=449933
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 084:  48000 / 49553 loss=3.854, nll_loss=2.191, ppl=4.57, wps=57197, ups=6, wpb=10097.677, bsz=618.904, num_updates=851117, lr=3.42772e-05, gnorm=0.960, clip=0.000, oom=0.000, loss_scale=2.000, wall=62313, train_wall=450091
| epoch 084:  49000 / 49553 loss=3.855, nll_loss=2.191, ppl=4.57, wps=57219, ups=6, wpb=10100.017, bsz=618.784, num_updates=852117, lr=3.42571e-05, gnorm=0.960, clip=0.000, oom=0.000, loss_scale=2.000, wall=62489, train_wall=450248
| epoch 084 | loss 3.855 | nll_loss 2.192 | ppl 4.57 | wps 57221 | ups 6 | wpb 10099.921 | bsz 618.653 | num_updates 852669 | lr 3.4246e-05 | gnorm 0.960 | clip 0.000 | oom 0.000 | loss_scale 2.000 | wall 62586 | train_wall 450334
| epoch 084 | valid on 'valid' subset | loss 2.745 | nll_loss 0.927 | ppl 1.90 | num_updates 852669 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint84.pt (epoch 84 @ 852669 updates) (writing took 14.237682104110718 seconds)
Invalid bert_input shape:torch.Size([5, 602])
| epoch 085:   1000 / 49553 loss=3.854, nll_loss=2.191, ppl=4.57, wps=57825, ups=3, wpb=10156.443, bsz=627.485, num_updates=853670, lr=3.42259e-05, gnorm=0.959, clip=0.000, oom=0.000, loss_scale=2.000, wall=62900, train_wall=450491
| epoch 085:   2000 / 49553 loss=3.845, nll_loss=2.181, ppl=4.53, wps=57634, ups=4, wpb=10109.096, bsz=620.859, num_updates=854670, lr=3.42059e-05, gnorm=0.965, clip=0.000, oom=0.000, loss_scale=4.000, wall=63075, train_wall=450647
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 085:   3000 / 49553 loss=3.846, nll_loss=2.182, ppl=4.54, wps=57421, ups=5, wpb=10078.230, bsz=617.038, num_updates=855669, lr=3.41859e-05, gnorm=0.965, clip=0.000, oom=0.000, loss_scale=2.000, wall=63250, train_wall=450805
Invalid bert_input shape:torch.Size([7, 840])
| epoch 085:   4000 / 49553 loss=3.848, nll_loss=2.184, ppl=4.55, wps=57415, ups=5, wpb=10083.614, bsz=618.090, num_updates=856669, lr=3.41659e-05, gnorm=0.967, clip=0.000, oom=0.000, loss_scale=2.000, wall=63426, train_wall=450962
Invalid bert_input shape:torch.Size([5, 795])
| epoch 085:   5000 / 49553 loss=3.846, nll_loss=2.182, ppl=4.54, wps=57507, ups=5, wpb=10083.006, bsz=617.422, num_updates=857669, lr=3.4146e-05, gnorm=0.967, clip=0.000, oom=0.000, loss_scale=2.000, wall=63600, train_wall=451119
Invalid bert_input shape:torch.Size([7, 865])
| epoch 085:   6000 / 49553 loss=3.847, nll_loss=2.182, ppl=4.54, wps=57532, ups=5, wpb=10084.132, bsz=618.497, num_updates=858669, lr=3.41261e-05, gnorm=0.967, clip=0.000, oom=0.000, loss_scale=2.000, wall=63775, train_wall=451275
Invalid bert_input shape:torch.Size([6, 863])
| epoch 085:   7000 / 49553 loss=3.848, nll_loss=2.184, ppl=4.54, wps=57470, ups=5, wpb=10074.300, bsz=618.843, num_updates=859669, lr=3.41063e-05, gnorm=0.967, clip=0.000, oom=0.000, loss_scale=4.000, wall=63951, train_wall=451432
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 085:   8000 / 49553 loss=3.848, nll_loss=2.184, ppl=4.54, wps=57532, ups=5, wpb=10076.918, bsz=617.921, num_updates=860668, lr=3.40865e-05, gnorm=0.968, clip=0.000, oom=0.000, loss_scale=2.000, wall=64125, train_wall=451588
Invalid bert_input shape:torch.Size([6, 546])
Invalid bert_input shape:torch.Size([6, 575])
| epoch 085:   9000 / 49553 loss=3.848, nll_loss=2.183, ppl=4.54, wps=57557, ups=5, wpb=10076.956, bsz=617.891, num_updates=861668, lr=3.40667e-05, gnorm=0.968, clip=0.000, oom=0.000, loss_scale=2.000, wall=64299, train_wall=451744
| epoch 085:  10000 / 49553 loss=3.846, nll_loss=2.182, ppl=4.54, wps=57553, ups=5, wpb=10082.899, bsz=618.184, num_updates=862668, lr=3.40469e-05, gnorm=0.967, clip=0.000, oom=0.000, loss_scale=2.000, wall=64476, train_wall=451902
Invalid bert_input shape:torch.Size([5, 704])
| epoch 085:  11000 / 49553 loss=3.848, nll_loss=2.184, ppl=4.54, wps=57562, ups=5, wpb=10082.901, bsz=619.264, num_updates=863668, lr=3.40272e-05, gnorm=0.968, clip=0.000, oom=0.000, loss_scale=2.000, wall=64650, train_wall=452058
| epoch 085:  12000 / 49553 loss=3.848, nll_loss=2.184, ppl=4.54, wps=57603, ups=5, wpb=10094.567, bsz=618.324, num_updates=864668, lr=3.40075e-05, gnorm=0.967, clip=0.000, oom=0.000, loss_scale=2.000, wall=64827, train_wall=452215
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 085:  13000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=57528, ups=5, wpb=10099.127, bsz=618.816, num_updates=865667, lr=3.39879e-05, gnorm=0.967, clip=0.000, oom=0.000, loss_scale=2.000, wall=65006, train_wall=452375
| epoch 085:  14000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=57533, ups=5, wpb=10100.606, bsz=618.864, num_updates=866667, lr=3.39683e-05, gnorm=0.968, clip=0.000, oom=0.000, loss_scale=2.000, wall=65181, train_wall=452532
| epoch 085:  15000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=57535, ups=5, wpb=10100.065, bsz=617.857, num_updates=867667, lr=3.39487e-05, gnorm=0.969, clip=0.000, oom=0.000, loss_scale=2.000, wall=65357, train_wall=452690
| epoch 085:  16000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=57534, ups=5, wpb=10098.887, bsz=617.749, num_updates=868667, lr=3.39292e-05, gnorm=0.969, clip=0.000, oom=0.000, loss_scale=2.000, wall=65532, train_wall=452847
Invalid bert_input shape:torch.Size([6, 528])
| epoch 085:  17000 / 49553 loss=3.849, nll_loss=2.186, ppl=4.55, wps=57552, ups=5, wpb=10098.049, bsz=618.142, num_updates=869667, lr=3.39097e-05, gnorm=0.969, clip=0.000, oom=0.000, loss_scale=2.000, wall=65706, train_wall=453004
Invalid bert_input shape:torch.Size([7, 790])
| epoch 085:  18000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=57487, ups=5, wpb=10098.221, bsz=617.996, num_updates=870667, lr=3.38902e-05, gnorm=0.970, clip=0.000, oom=0.000, loss_scale=4.000, wall=65885, train_wall=453165
| epoch 085:  19000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=57438, ups=5, wpb=10097.310, bsz=618.334, num_updates=871667, lr=3.38707e-05, gnorm=0.970, clip=0.000, oom=0.000, loss_scale=4.000, wall=66064, train_wall=453324
Invalid bert_input shape:torch.Size([4, 837])
| epoch 085:  20000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=57449, ups=5, wpb=10096.266, bsz=618.242, num_updates=872667, lr=3.38513e-05, gnorm=0.970, clip=0.000, oom=0.000, loss_scale=4.000, wall=66238, train_wall=453479
| epoch 085:  21000 / 49553 loss=3.850, nll_loss=2.187, ppl=4.55, wps=57445, ups=5, wpb=10095.898, bsz=618.867, num_updates=873667, lr=3.3832e-05, gnorm=0.971, clip=0.000, oom=0.000, loss_scale=4.000, wall=66414, train_wall=453635
Invalid bert_input shape:torch.Size([4, 832])
Invalid bert_input shape:torch.Size([5, 655])
| epoch 085:  22000 / 49553 loss=3.850, nll_loss=2.187, ppl=4.55, wps=57438, ups=5, wpb=10094.827, bsz=619.713, num_updates=874667, lr=3.38126e-05, gnorm=0.971, clip=0.000, oom=0.000, loss_scale=8.000, wall=66590, train_wall=453792
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 085:  23000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=57450, ups=6, wpb=10096.845, bsz=619.980, num_updates=875666, lr=3.37933e-05, gnorm=0.971, clip=0.000, oom=0.000, loss_scale=4.000, wall=66766, train_wall=453949
| epoch 085:  24000 / 49553 loss=3.849, nll_loss=2.186, ppl=4.55, wps=57412, ups=6, wpb=10093.977, bsz=619.775, num_updates=876666, lr=3.3774e-05, gnorm=0.971, clip=0.000, oom=0.000, loss_scale=4.000, wall=66943, train_wall=454107
Invalid bert_input shape:torch.Size([4, 831])
| epoch 085:  25000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=57406, ups=6, wpb=10092.856, bsz=619.643, num_updates=877666, lr=3.37548e-05, gnorm=0.971, clip=0.000, oom=0.000, loss_scale=4.000, wall=67119, train_wall=454264
| epoch 085:  26000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=57355, ups=6, wpb=10090.685, bsz=619.322, num_updates=878666, lr=3.37356e-05, gnorm=0.971, clip=0.000, oom=0.000, loss_scale=4.000, wall=67298, train_wall=454425
Invalid bert_input shape:torch.Size([6, 555])
| epoch 085:  27000 / 49553 loss=3.850, nll_loss=2.187, ppl=4.55, wps=57328, ups=6, wpb=10091.223, bsz=618.933, num_updates=879666, lr=3.37164e-05, gnorm=0.971, clip=0.000, oom=0.000, loss_scale=4.000, wall=67476, train_wall=454586
| epoch 085:  28000 / 49553 loss=3.850, nll_loss=2.187, ppl=4.55, wps=57278, ups=6, wpb=10089.322, bsz=618.493, num_updates=880666, lr=3.36972e-05, gnorm=0.972, clip=0.000, oom=0.000, loss_scale=8.000, wall=67655, train_wall=454738
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 085:  29000 / 49553 loss=3.851, nll_loss=2.187, ppl=4.55, wps=57241, ups=6, wpb=10091.853, bsz=618.359, num_updates=881665, lr=3.36781e-05, gnorm=0.972, clip=0.000, oom=0.000, loss_scale=4.000, wall=67836, train_wall=454890
Invalid bert_input shape:torch.Size([6, 589])
| epoch 085:  30000 / 49553 loss=3.851, nll_loss=2.188, ppl=4.56, wps=57257, ups=6, wpb=10092.287, bsz=618.673, num_updates=882665, lr=3.36591e-05, gnorm=0.972, clip=0.000, oom=0.000, loss_scale=4.000, wall=68011, train_wall=455047
| epoch 085:  31000 / 49553 loss=3.851, nll_loss=2.188, ppl=4.56, wps=57252, ups=6, wpb=10094.674, bsz=618.674, num_updates=883665, lr=3.364e-05, gnorm=0.972, clip=0.000, oom=0.000, loss_scale=4.000, wall=68189, train_wall=455200
| epoch 085:  32000 / 49553 loss=3.851, nll_loss=2.188, ppl=4.56, wps=57219, ups=6, wpb=10094.394, bsz=618.752, num_updates=884665, lr=3.3621e-05, gnorm=0.972, clip=0.000, oom=0.000, loss_scale=4.000, wall=68368, train_wall=455351
Invalid bert_input shape:torch.Size([5, 638])
| epoch 085:  33000 / 49553 loss=3.851, nll_loss=2.188, ppl=4.56, wps=57203, ups=6, wpb=10093.382, bsz=618.758, num_updates=885665, lr=3.3602e-05, gnorm=0.972, clip=0.000, oom=0.000, loss_scale=8.000, wall=68546, train_wall=455510
Invalid bert_input shape:torch.Size([4, 800])
| epoch 085:  34000 / 49553 loss=3.851, nll_loss=2.187, ppl=4.55, wps=57190, ups=6, wpb=10093.733, bsz=618.906, num_updates=886665, lr=3.35831e-05, gnorm=0.972, clip=0.000, oom=0.000, loss_scale=8.000, wall=68724, train_wall=455669
Invalid bert_input shape:torch.Size([5, 674])
| epoch 085:  35000 / 49553 loss=3.851, nll_loss=2.188, ppl=4.56, wps=57193, ups=6, wpb=10093.332, bsz=619.081, num_updates=887665, lr=3.35641e-05, gnorm=0.972, clip=0.000, oom=0.000, loss_scale=8.000, wall=68900, train_wall=455827
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 085:  36000 / 49553 loss=3.851, nll_loss=2.188, ppl=4.56, wps=57193, ups=6, wpb=10093.263, bsz=618.455, num_updates=888664, lr=3.35453e-05, gnorm=0.972, clip=0.000, oom=0.000, loss_scale=4.000, wall=69076, train_wall=455985
| epoch 085:  37000 / 49553 loss=3.852, nll_loss=2.188, ppl=4.56, wps=57192, ups=6, wpb=10096.184, bsz=618.366, num_updates=889664, lr=3.35264e-05, gnorm=0.973, clip=0.000, oom=0.000, loss_scale=4.000, wall=69255, train_wall=456145
Invalid bert_input shape:torch.Size([5, 644])
Invalid bert_input shape:torch.Size([8, 844])
| epoch 085:  38000 / 49553 loss=3.852, nll_loss=2.189, ppl=4.56, wps=57175, ups=6, wpb=10096.685, bsz=618.218, num_updates=890664, lr=3.35076e-05, gnorm=0.972, clip=0.000, oom=0.000, loss_scale=4.000, wall=69433, train_wall=456305
| epoch 085:  39000 / 49553 loss=3.852, nll_loss=2.188, ppl=4.56, wps=57157, ups=6, wpb=10097.141, bsz=618.337, num_updates=891664, lr=3.34888e-05, gnorm=0.973, clip=0.000, oom=0.000, loss_scale=4.000, wall=69612, train_wall=456465
| epoch 085:  40000 / 49553 loss=3.852, nll_loss=2.189, ppl=4.56, wps=57172, ups=6, wpb=10098.152, bsz=618.279, num_updates=892664, lr=3.347e-05, gnorm=0.973, clip=0.000, oom=0.000, loss_scale=4.000, wall=69788, train_wall=456621
| epoch 085:  41000 / 49553 loss=3.852, nll_loss=2.189, ppl=4.56, wps=57182, ups=6, wpb=10098.601, bsz=618.411, num_updates=893664, lr=3.34513e-05, gnorm=0.973, clip=0.000, oom=0.000, loss_scale=8.000, wall=69964, train_wall=456777
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 085:  42000 / 49553 loss=3.852, nll_loss=2.189, ppl=4.56, wps=57201, ups=6, wpb=10099.789, bsz=617.868, num_updates=894663, lr=3.34326e-05, gnorm=0.973, clip=0.000, oom=0.000, loss_scale=4.000, wall=70138, train_wall=456934
| epoch 085:  43000 / 49553 loss=3.852, nll_loss=2.189, ppl=4.56, wps=57212, ups=6, wpb=10099.145, bsz=617.990, num_updates=895663, lr=3.34139e-05, gnorm=0.973, clip=0.000, oom=0.000, loss_scale=4.000, wall=70313, train_wall=457091
| epoch 085:  44000 / 49553 loss=3.852, nll_loss=2.189, ppl=4.56, wps=57216, ups=6, wpb=10099.379, bsz=618.309, num_updates=896663, lr=3.33953e-05, gnorm=0.973, clip=0.000, oom=0.000, loss_scale=4.000, wall=70489, train_wall=457248
| epoch 085:  45000 / 49553 loss=3.853, nll_loss=2.190, ppl=4.56, wps=57233, ups=6, wpb=10101.019, bsz=618.259, num_updates=897663, lr=3.33767e-05, gnorm=0.973, clip=0.000, oom=0.000, loss_scale=4.000, wall=70665, train_wall=457405
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 085:  46000 / 49553 loss=3.853, nll_loss=2.190, ppl=4.56, wps=57231, ups=6, wpb=10100.978, bsz=618.290, num_updates=898662, lr=3.33581e-05, gnorm=0.974, clip=0.000, oom=0.000, loss_scale=2.000, wall=70841, train_wall=457563
Invalid bert_input shape:torch.Size([4, 790])
| epoch 085:  47000 / 49553 loss=3.853, nll_loss=2.190, ppl=4.56, wps=57202, ups=6, wpb=10100.316, bsz=618.265, num_updates=899662, lr=3.33396e-05, gnorm=0.974, clip=0.000, oom=0.000, loss_scale=2.000, wall=71021, train_wall=457725
| epoch 085:  48000 / 49553 loss=3.853, nll_loss=2.190, ppl=4.56, wps=57180, ups=6, wpb=10098.862, bsz=618.422, num_updates=900662, lr=3.33211e-05, gnorm=0.974, clip=0.000, oom=0.000, loss_scale=2.000, wall=71200, train_wall=457885
Invalid bert_input shape:torch.Size([3, 1160])
| epoch 085:  49000 / 49553 loss=3.852, nll_loss=2.189, ppl=4.56, wps=57173, ups=6, wpb=10100.270, bsz=618.570, num_updates=901662, lr=3.33026e-05, gnorm=0.974, clip=0.000, oom=0.000, loss_scale=2.000, wall=71379, train_wall=458045
| epoch 085 | loss 3.852 | nll_loss 2.189 | ppl 4.56 | wps 57164 | ups 6 | wpb 10099.986 | bsz 618.656 | num_updates 902214 | lr 3.32924e-05 | gnorm 0.974 | clip 0.000 | oom 0.000 | loss_scale 2.000 | wall 71478 | train_wall 458133
| epoch 085 | valid on 'valid' subset | loss 2.755 | nll_loss 0.936 | ppl 1.91 | num_updates 902214 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint85.pt (epoch 85 @ 902214 updates) (writing took 9.459999561309814 seconds)
| epoch 086:   1000 / 49553 loss=3.837, nll_loss=2.172, ppl=4.51, wps=57330, ups=3, wpb=10064.651, bsz=619.668, num_updates=903215, lr=3.3274e-05, gnorm=0.989, clip=0.000, oom=0.000, loss_scale=4.000, wall=71786, train_wall=458291
| epoch 086:   2000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=56765, ups=4, wpb=10056.602, bsz=606.508, num_updates=904215, lr=3.32556e-05, gnorm=0.991, clip=0.000, oom=0.000, loss_scale=4.000, wall=71965, train_wall=458451
Invalid bert_input shape:torch.Size([4, 1167])
| epoch 086:   3000 / 49553 loss=3.844, nll_loss=2.179, ppl=4.53, wps=56624, ups=5, wpb=10061.696, bsz=605.883, num_updates=905215, lr=3.32372e-05, gnorm=0.988, clip=0.000, oom=0.000, loss_scale=4.000, wall=72143, train_wall=458612
| epoch 086:   4000 / 49553 loss=3.845, nll_loss=2.180, ppl=4.53, wps=56560, ups=5, wpb=10070.069, bsz=609.949, num_updates=906215, lr=3.32188e-05, gnorm=0.989, clip=0.000, oom=0.000, loss_scale=4.000, wall=72322, train_wall=458773
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 086:   5000 / 49553 loss=3.842, nll_loss=2.177, ppl=4.52, wps=56795, ups=5, wpb=10077.686, bsz=609.705, num_updates=907214, lr=3.32005e-05, gnorm=0.986, clip=0.000, oom=0.000, loss_scale=4.000, wall=72497, train_wall=458930
| epoch 086:   6000 / 49553 loss=3.839, nll_loss=2.174, ppl=4.51, wps=56806, ups=5, wpb=10084.122, bsz=611.945, num_updates=908214, lr=3.31823e-05, gnorm=0.985, clip=0.000, oom=0.000, loss_scale=4.000, wall=72675, train_wall=459084
| epoch 086:   7000 / 49553 loss=3.840, nll_loss=2.176, ppl=4.52, wps=56889, ups=5, wpb=10081.238, bsz=613.192, num_updates=909214, lr=3.3164e-05, gnorm=0.986, clip=0.000, oom=0.000, loss_scale=4.000, wall=72850, train_wall=459241
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 086:   8000 / 49553 loss=3.842, nll_loss=2.177, ppl=4.52, wps=56960, ups=5, wpb=10097.871, bsz=612.382, num_updates=910213, lr=3.31458e-05, gnorm=0.985, clip=0.000, oom=0.000, loss_scale=2.000, wall=73028, train_wall=459400
| epoch 086:   9000 / 49553 loss=3.845, nll_loss=2.180, ppl=4.53, wps=56886, ups=5, wpb=10099.701, bsz=613.591, num_updates=911213, lr=3.31276e-05, gnorm=0.985, clip=0.000, oom=0.000, loss_scale=2.000, wall=73208, train_wall=459560
| epoch 086:  10000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=56842, ups=5, wpb=10096.834, bsz=613.755, num_updates=912213, lr=3.31094e-05, gnorm=0.986, clip=0.000, oom=0.000, loss_scale=2.000, wall=73386, train_wall=459719
| epoch 086:  11000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=56837, ups=5, wpb=10094.302, bsz=614.043, num_updates=913213, lr=3.30913e-05, gnorm=0.985, clip=0.000, oom=0.000, loss_scale=2.000, wall=73563, train_wall=459873
Invalid bert_input shape:torch.Size([3, 1160])
| epoch 086:  12000 / 49553 loss=3.846, nll_loss=2.182, ppl=4.54, wps=56821, ups=5, wpb=10090.578, bsz=614.395, num_updates=914213, lr=3.30732e-05, gnorm=0.985, clip=0.000, oom=0.000, loss_scale=4.000, wall=73741, train_wall=460030
| epoch 086:  13000 / 49553 loss=3.846, nll_loss=2.182, ppl=4.54, wps=56787, ups=5, wpb=10086.769, bsz=615.513, num_updates=915213, lr=3.30551e-05, gnorm=0.986, clip=0.000, oom=0.000, loss_scale=4.000, wall=73919, train_wall=460182
| WARNING: overflow detected, setting loss scale to: 2.0
Invalid bert_input shape:torch.Size([4, 843])
| epoch 086:  14000 / 49553 loss=3.845, nll_loss=2.181, ppl=4.53, wps=56765, ups=5, wpb=10087.329, bsz=616.337, num_updates=916212, lr=3.30371e-05, gnorm=0.986, clip=0.000, oom=0.000, loss_scale=2.000, wall=74098, train_wall=460334
Invalid bert_input shape:torch.Size([5, 907])
| epoch 086:  15000 / 49553 loss=3.845, nll_loss=2.181, ppl=4.53, wps=56707, ups=5, wpb=10084.480, bsz=616.993, num_updates=917212, lr=3.30191e-05, gnorm=0.986, clip=0.000, oom=0.000, loss_scale=2.000, wall=74277, train_wall=460487
Invalid bert_input shape:torch.Size([2, 1513])
| epoch 086:  16000 / 49553 loss=3.845, nll_loss=2.181, ppl=4.53, wps=56680, ups=5, wpb=10079.480, bsz=617.454, num_updates=918212, lr=3.30011e-05, gnorm=0.987, clip=0.000, oom=0.000, loss_scale=2.000, wall=74455, train_wall=460639
| epoch 086:  17000 / 49553 loss=3.845, nll_loss=2.181, ppl=4.53, wps=56692, ups=5, wpb=10081.467, bsz=617.975, num_updates=919212, lr=3.29832e-05, gnorm=0.987, clip=0.000, oom=0.000, loss_scale=2.000, wall=74633, train_wall=460791
Invalid bert_input shape:torch.Size([4, 832])
| epoch 086:  18000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=56693, ups=5, wpb=10085.185, bsz=617.776, num_updates=920212, lr=3.29652e-05, gnorm=0.987, clip=0.000, oom=0.000, loss_scale=4.000, wall=74812, train_wall=460944
| epoch 086:  19000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=56690, ups=5, wpb=10083.327, bsz=618.529, num_updates=921212, lr=3.29473e-05, gnorm=0.987, clip=0.000, oom=0.000, loss_scale=4.000, wall=74989, train_wall=461100
Invalid bert_input shape:torch.Size([6, 575])
| epoch 086:  20000 / 49553 loss=3.848, nll_loss=2.184, ppl=4.54, wps=56673, ups=5, wpb=10083.758, bsz=618.405, num_updates=922212, lr=3.29295e-05, gnorm=0.988, clip=0.000, oom=0.000, loss_scale=4.000, wall=75168, train_wall=461261
| epoch 086:  21000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=56656, ups=5, wpb=10085.874, bsz=618.604, num_updates=923212, lr=3.29116e-05, gnorm=0.988, clip=0.000, oom=0.000, loss_scale=4.000, wall=75348, train_wall=461422
Invalid bert_input shape:torch.Size([8, 844])
| epoch 086:  22000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=56665, ups=5, wpb=10089.069, bsz=618.486, num_updates=924212, lr=3.28938e-05, gnorm=0.988, clip=0.000, oom=0.000, loss_scale=8.000, wall=75527, train_wall=461581
| epoch 086:  23000 / 49553 loss=3.848, nll_loss=2.185, ppl=4.55, wps=56645, ups=5, wpb=10088.588, bsz=618.819, num_updates=925212, lr=3.2876e-05, gnorm=0.988, clip=0.000, oom=0.000, loss_scale=8.000, wall=75706, train_wall=461741
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 086:  24000 / 49553 loss=3.848, nll_loss=2.185, ppl=4.55, wps=56643, ups=5, wpb=10090.879, bsz=619.216, num_updates=926211, lr=3.28583e-05, gnorm=0.987, clip=0.000, oom=0.000, loss_scale=4.000, wall=75885, train_wall=461894
| epoch 086:  25000 / 49553 loss=3.848, nll_loss=2.185, ppl=4.55, wps=56631, ups=5, wpb=10090.860, bsz=618.848, num_updates=927211, lr=3.28406e-05, gnorm=0.988, clip=0.000, oom=0.000, loss_scale=4.000, wall=76064, train_wall=462046
| epoch 086:  26000 / 49553 loss=3.848, nll_loss=2.185, ppl=4.55, wps=56632, ups=5, wpb=10094.280, bsz=618.373, num_updates=928211, lr=3.28229e-05, gnorm=0.988, clip=0.000, oom=0.000, loss_scale=4.000, wall=76244, train_wall=462202
| epoch 086:  27000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=56606, ups=5, wpb=10094.683, bsz=618.330, num_updates=929211, lr=3.28052e-05, gnorm=0.988, clip=0.000, oom=0.000, loss_scale=4.000, wall=76424, train_wall=462363
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 086:  28000 / 49553 loss=3.848, nll_loss=2.185, ppl=4.55, wps=56633, ups=5, wpb=10095.190, bsz=618.510, num_updates=930210, lr=3.27876e-05, gnorm=0.988, clip=0.000, oom=0.000, loss_scale=4.000, wall=76600, train_wall=462520
Invalid bert_input shape:torch.Size([5, 636])
Invalid bert_input shape:torch.Size([6, 1334])
| epoch 086:  29000 / 49553 loss=3.848, nll_loss=2.185, ppl=4.55, wps=56675, ups=5, wpb=10096.422, bsz=618.668, num_updates=931210, lr=3.277e-05, gnorm=0.988, clip=0.000, oom=0.000, loss_scale=4.000, wall=76775, train_wall=462677
| epoch 086:  30000 / 49553 loss=3.848, nll_loss=2.185, ppl=4.55, wps=56676, ups=5, wpb=10096.240, bsz=618.987, num_updates=932210, lr=3.27524e-05, gnorm=0.988, clip=0.000, oom=0.000, loss_scale=4.000, wall=76953, train_wall=462835
Invalid bert_input shape:torch.Size([6, 878])
| epoch 086:  31000 / 49553 loss=3.848, nll_loss=2.185, ppl=4.55, wps=56672, ups=5, wpb=10096.700, bsz=618.926, num_updates=933210, lr=3.27348e-05, gnorm=0.988, clip=0.000, oom=0.000, loss_scale=4.000, wall=77132, train_wall=462995
| epoch 086:  32000 / 49553 loss=3.848, nll_loss=2.185, ppl=4.55, wps=56653, ups=5, wpb=10097.164, bsz=618.990, num_updates=934210, lr=3.27173e-05, gnorm=0.988, clip=0.000, oom=0.000, loss_scale=8.000, wall=77313, train_wall=463157
| epoch 086:  33000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=56639, ups=5, wpb=10093.063, bsz=618.996, num_updates=935210, lr=3.26998e-05, gnorm=0.989, clip=0.000, oom=0.000, loss_scale=8.000, wall=77490, train_wall=463316
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 086:  34000 / 49553 loss=3.848, nll_loss=2.185, ppl=4.55, wps=56642, ups=5, wpb=10095.098, bsz=618.607, num_updates=936209, lr=3.26824e-05, gnorm=0.989, clip=0.000, oom=0.000, loss_scale=4.000, wall=77669, train_wall=463476
Invalid bert_input shape:torch.Size([6, 595])
| epoch 086:  35000 / 49553 loss=3.849, nll_loss=2.185, ppl=4.55, wps=56637, ups=5, wpb=10096.426, bsz=618.610, num_updates=937209, lr=3.26649e-05, gnorm=0.989, clip=0.000, oom=0.000, loss_scale=4.000, wall=77848, train_wall=463637
| epoch 086:  36000 / 49553 loss=3.849, nll_loss=2.186, ppl=4.55, wps=56642, ups=5, wpb=10096.788, bsz=619.072, num_updates=938209, lr=3.26475e-05, gnorm=0.989, clip=0.000, oom=0.000, loss_scale=4.000, wall=78026, train_wall=463796
Invalid bert_input shape:torch.Size([5, 869])
Invalid bert_input shape:torch.Size([2, 1203])
| epoch 086:  37000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=56653, ups=6, wpb=10096.307, bsz=619.081, num_updates=939209, lr=3.26301e-05, gnorm=0.989, clip=0.000, oom=0.000, loss_scale=4.000, wall=78203, train_wall=463953
| epoch 086:  38000 / 49553 loss=3.850, nll_loss=2.186, ppl=4.55, wps=56663, ups=6, wpb=10096.214, bsz=618.819, num_updates=940209, lr=3.26128e-05, gnorm=0.989, clip=0.000, oom=0.000, loss_scale=8.000, wall=78380, train_wall=464111
Invalid bert_input shape:torch.Size([6, 784])
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([3, 1119])
| epoch 086:  39000 / 49553 loss=3.850, nll_loss=2.187, ppl=4.55, wps=56695, ups=6, wpb=10096.667, bsz=618.810, num_updates=941208, lr=3.25955e-05, gnorm=0.989, clip=0.000, oom=0.000, loss_scale=4.000, wall=78554, train_wall=464267
Invalid bert_input shape:torch.Size([5, 616])
| epoch 086:  40000 / 49553 loss=3.850, nll_loss=2.187, ppl=4.55, wps=56692, ups=6, wpb=10095.098, bsz=618.642, num_updates=942208, lr=3.25782e-05, gnorm=0.989, clip=0.000, oom=0.000, loss_scale=4.000, wall=78732, train_wall=464426
Invalid bert_input shape:torch.Size([4, 782])
| epoch 086:  41000 / 49553 loss=3.850, nll_loss=2.187, ppl=4.55, wps=56704, ups=6, wpb=10095.359, bsz=618.537, num_updates=943208, lr=3.25609e-05, gnorm=0.989, clip=0.000, oom=0.000, loss_scale=4.000, wall=78908, train_wall=464582
| epoch 086:  42000 / 49553 loss=3.850, nll_loss=2.187, ppl=4.55, wps=56728, ups=6, wpb=10097.381, bsz=618.660, num_updates=944208, lr=3.25436e-05, gnorm=0.989, clip=0.000, oom=0.000, loss_scale=4.000, wall=79085, train_wall=464739
| epoch 086:  43000 / 49553 loss=3.850, nll_loss=2.187, ppl=4.55, wps=56746, ups=6, wpb=10096.947, bsz=618.748, num_updates=945208, lr=3.25264e-05, gnorm=0.989, clip=0.000, oom=0.000, loss_scale=8.000, wall=79260, train_wall=464895
| epoch 086:  44000 / 49553 loss=3.850, nll_loss=2.187, ppl=4.55, wps=56768, ups=6, wpb=10098.471, bsz=618.498, num_updates=946208, lr=3.25092e-05, gnorm=0.989, clip=0.000, oom=0.000, loss_scale=8.000, wall=79436, train_wall=465054
Invalid bert_input shape:torch.Size([7, 865])
Invalid bert_input shape:torch.Size([7, 790])
| epoch 086:  45000 / 49553 loss=3.849, nll_loss=2.186, ppl=4.55, wps=56786, ups=6, wpb=10097.541, bsz=618.709, num_updates=947208, lr=3.24921e-05, gnorm=0.989, clip=0.000, oom=0.000, loss_scale=8.000, wall=79611, train_wall=465211
| epoch 086:  46000 / 49553 loss=3.849, nll_loss=2.186, ppl=4.55, wps=56807, ups=6, wpb=10098.323, bsz=618.608, num_updates=948208, lr=3.24749e-05, gnorm=0.989, clip=0.000, oom=0.000, loss_scale=8.000, wall=79786, train_wall=465368
Invalid bert_input shape:torch.Size([5, 994])
| epoch 086:  47000 / 49553 loss=3.849, nll_loss=2.186, ppl=4.55, wps=56797, ups=6, wpb=10097.785, bsz=618.600, num_updates=949208, lr=3.24578e-05, gnorm=0.990, clip=0.000, oom=0.000, loss_scale=8.000, wall=79965, train_wall=465528
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 086:  48000 / 49553 loss=3.849, nll_loss=2.186, ppl=4.55, wps=56802, ups=6, wpb=10098.461, bsz=618.634, num_updates=950207, lr=3.24408e-05, gnorm=0.990, clip=0.000, oom=0.000, loss_scale=8.000, wall=80142, train_wall=465687
| epoch 086:  49000 / 49553 loss=3.849, nll_loss=2.186, ppl=4.55, wps=56812, ups=6, wpb=10098.839, bsz=618.563, num_updates=951207, lr=3.24237e-05, gnorm=0.990, clip=0.000, oom=0.000, loss_scale=8.000, wall=80319, train_wall=465846
| epoch 086 | loss 3.849 | nll_loss 2.186 | ppl 4.55 | wps 56817 | ups 6 | wpb 10099.992 | bsz 618.646 | num_updates 951759 | lr 3.24143e-05 | gnorm 0.990 | clip 0.000 | oom 0.000 | loss_scale 8.000 | wall 80417 | train_wall 465934
| epoch 086 | valid on 'valid' subset | loss 2.752 | nll_loss 0.935 | ppl 1.91 | num_updates 951759 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint86.pt (epoch 86 @ 951759 updates) (writing took 10.613651514053345 seconds)
| epoch 087:   1000 / 49553 loss=3.838, nll_loss=2.173, ppl=4.51, wps=57277, ups=3, wpb=10054.064, bsz=610.166, num_updates=952760, lr=3.23973e-05, gnorm=0.999, clip=0.000, oom=0.000, loss_scale=8.000, wall=80729, train_wall=466092
Invalid bert_input shape:torch.Size([5, 692])
| epoch 087:   2000 / 49553 loss=3.839, nll_loss=2.174, ppl=4.51, wps=56611, ups=4, wpb=10060.595, bsz=609.267, num_updates=953760, lr=3.23803e-05, gnorm=0.999, clip=0.000, oom=0.000, loss_scale=16.000, wall=80909, train_wall=466253
Invalid bert_input shape:torch.Size([5, 795])
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 087:   3000 / 49553 loss=3.838, nll_loss=2.174, ppl=4.51, wps=56373, ups=4, wpb=10059.812, bsz=615.314, num_updates=954759, lr=3.23633e-05, gnorm=0.999, clip=0.000, oom=0.000, loss_scale=8.000, wall=81089, train_wall=466415
| epoch 087:   4000 / 49553 loss=3.839, nll_loss=2.175, ppl=4.51, wps=56456, ups=5, wpb=10082.853, bsz=615.616, num_updates=955759, lr=3.23464e-05, gnorm=0.999, clip=0.000, oom=0.000, loss_scale=8.000, wall=81268, train_wall=466576
| epoch 087:   5000 / 49553 loss=3.842, nll_loss=2.178, ppl=4.53, wps=56671, ups=5, wpb=10092.449, bsz=617.390, num_updates=956759, lr=3.23295e-05, gnorm=0.998, clip=0.000, oom=0.000, loss_scale=8.000, wall=81444, train_wall=466733
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 087:   6000 / 49553 loss=3.845, nll_loss=2.182, ppl=4.54, wps=56789, ups=5, wpb=10089.811, bsz=618.746, num_updates=957758, lr=3.23126e-05, gnorm=0.999, clip=0.000, oom=0.000, loss_scale=4.000, wall=81619, train_wall=466891
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 087:   7000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=56979, ups=5, wpb=10094.667, bsz=617.346, num_updates=958757, lr=3.22958e-05, gnorm=0.999, clip=0.000, oom=0.000, loss_scale=2.000, wall=81793, train_wall=467048
| epoch 087:   8000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57012, ups=5, wpb=10088.624, bsz=617.811, num_updates=959757, lr=3.22789e-05, gnorm=0.999, clip=0.000, oom=0.000, loss_scale=2.000, wall=81969, train_wall=467204
Invalid bert_input shape:torch.Size([4, 823])
Invalid bert_input shape:torch.Size([5, 636])
| epoch 087:   9000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57089, ups=5, wpb=10096.286, bsz=617.575, num_updates=960757, lr=3.22621e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=2.000, wall=82145, train_wall=467362
| epoch 087:  10000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57091, ups=5, wpb=10098.429, bsz=617.977, num_updates=961757, lr=3.22454e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=2.000, wall=82322, train_wall=467521
Invalid bert_input shape:torch.Size([5, 701])
| epoch 087:  11000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57165, ups=5, wpb=10103.468, bsz=617.184, num_updates=962757, lr=3.22286e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=2.000, wall=82497, train_wall=467678
| epoch 087:  12000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57219, ups=5, wpb=10105.458, bsz=617.144, num_updates=963757, lr=3.22119e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=4.000, wall=82672, train_wall=467836
| epoch 087:  13000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57326, ups=5, wpb=10116.551, bsz=615.982, num_updates=964757, lr=3.21952e-05, gnorm=0.999, clip=0.000, oom=0.000, loss_scale=4.000, wall=82847, train_wall=467992
| epoch 087:  14000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=57368, ups=5, wpb=10119.290, bsz=616.305, num_updates=965757, lr=3.21785e-05, gnorm=0.999, clip=0.000, oom=0.000, loss_scale=4.000, wall=83022, train_wall=468149
| epoch 087:  15000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57352, ups=5, wpb=10113.608, bsz=616.404, num_updates=966757, lr=3.21619e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=4.000, wall=83198, train_wall=468306
Invalid bert_input shape:torch.Size([6, 896])
Invalid bert_input shape:torch.Size([7, 865])
| epoch 087:  16000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=57303, ups=5, wpb=10114.956, bsz=616.020, num_updates=967757, lr=3.21453e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=8.000, wall=83377, train_wall=468468
| epoch 087:  17000 / 49553 loss=3.846, nll_loss=2.182, ppl=4.54, wps=57315, ups=5, wpb=10114.473, bsz=616.597, num_updates=968757, lr=3.21287e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=8.000, wall=83553, train_wall=468624
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 087:  18000 / 49553 loss=3.846, nll_loss=2.182, ppl=4.54, wps=57327, ups=5, wpb=10114.748, bsz=616.957, num_updates=969756, lr=3.21121e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=4.000, wall=83729, train_wall=468781
| epoch 087:  19000 / 49553 loss=3.846, nll_loss=2.182, ppl=4.54, wps=57293, ups=5, wpb=10115.907, bsz=617.712, num_updates=970756, lr=3.20956e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=4.000, wall=83908, train_wall=468932
| WARNING: overflow detected, setting loss scale to: 2.0
Invalid bert_input shape:torch.Size([6, 546])
| epoch 087:  20000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57308, ups=5, wpb=10116.673, bsz=617.889, num_updates=971755, lr=3.20791e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=2.000, wall=84083, train_wall=469089
| epoch 087:  21000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57316, ups=5, wpb=10113.695, bsz=618.040, num_updates=972755, lr=3.20626e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=2.000, wall=84258, train_wall=469246
| epoch 087:  22000 / 49553 loss=3.846, nll_loss=2.182, ppl=4.54, wps=57337, ups=5, wpb=10113.936, bsz=617.988, num_updates=973755, lr=3.20461e-05, gnorm=1.001, clip=0.000, oom=0.000, loss_scale=2.000, wall=84433, train_wall=469402
| epoch 087:  23000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57341, ups=5, wpb=10114.778, bsz=617.593, num_updates=974755, lr=3.20297e-05, gnorm=1.001, clip=0.000, oom=0.000, loss_scale=2.000, wall=84610, train_wall=469561
| epoch 087:  24000 / 49553 loss=3.845, nll_loss=2.182, ppl=4.54, wps=57299, ups=5, wpb=10112.423, bsz=617.498, num_updates=975755, lr=3.20132e-05, gnorm=1.001, clip=0.000, oom=0.000, loss_scale=4.000, wall=84788, train_wall=469721
| epoch 087:  25000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57307, ups=5, wpb=10113.679, bsz=617.496, num_updates=976755, lr=3.19968e-05, gnorm=1.002, clip=0.000, oom=0.000, loss_scale=4.000, wall=84965, train_wall=469879
| epoch 087:  26000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57262, ups=6, wpb=10110.247, bsz=618.077, num_updates=977755, lr=3.19805e-05, gnorm=1.002, clip=0.000, oom=0.000, loss_scale=4.000, wall=85143, train_wall=470039
| epoch 087:  27000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57234, ups=6, wpb=10108.140, bsz=618.635, num_updates=978755, lr=3.19641e-05, gnorm=1.002, clip=0.000, oom=0.000, loss_scale=4.000, wall=85321, train_wall=470198
Invalid bert_input shape:torch.Size([5, 616])
| epoch 087:  28000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57217, ups=6, wpb=10108.241, bsz=618.643, num_updates=979755, lr=3.19478e-05, gnorm=1.003, clip=0.000, oom=0.000, loss_scale=8.000, wall=85499, train_wall=470358
| WARNING: overflow detected, setting loss scale to: 4.0
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 087:  29000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=57165, ups=6, wpb=10109.107, bsz=618.743, num_updates=980753, lr=3.19316e-05, gnorm=1.003, clip=0.000, oom=0.000, loss_scale=2.000, wall=85681, train_wall=470521
Invalid bert_input shape:torch.Size([5, 703])
| epoch 087:  30000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=57169, ups=6, wpb=10108.009, bsz=619.025, num_updates=981753, lr=3.19153e-05, gnorm=1.003, clip=0.000, oom=0.000, loss_scale=2.000, wall=85857, train_wall=470679
Invalid bert_input shape:torch.Size([4, 843])
| epoch 087:  31000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57191, ups=6, wpb=10107.450, bsz=618.806, num_updates=982753, lr=3.18991e-05, gnorm=1.003, clip=0.000, oom=0.000, loss_scale=2.000, wall=86031, train_wall=470834
| epoch 087:  32000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57181, ups=6, wpb=10106.493, bsz=618.824, num_updates=983753, lr=3.18828e-05, gnorm=1.003, clip=0.000, oom=0.000, loss_scale=2.000, wall=86208, train_wall=470990
| distributed init (rank 3): tcp://localhost:17955
| distributed init (rank 0): tcp://localhost:17955
| distributed init (rank 2): tcp://localhost:17955
| distributed init (rank 1): tcp://localhost:17955
| initialized host r16g05.bullx as rank 3
| initialized host r16g05.bullx as rank 0
| initialized host r16g05.bullx as rank 1
| initialized host r16g05.bullx as rank 2
Namespace(activation_dropout=0.0, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, arch='transformer_vaswani_wmt_en_de_big', attention_dropout=0.0, bert_first=True, bert_gates=[1, 1, 1, 1, 1, 1], bert_model_name='/scratch/project_2003453/bert-base-finnish-uncased-v1', bert_output_layer=-1, bert_ratio=1.0, bucket_cap_mb=25, clip_norm=25, cpu=False, criterion='label_smoothed_cross_entropy', curriculum=0, data='/scratch/project_2003453/bertnmt_data', dataset_impl='cached', ddp_backend='c10d', decoder_attention_heads=16, decoder_embed_dim=1024, decoder_embed_path=None, decoder_ffn_embed_dim=4096, decoder_input_dim=1024, decoder_layers=6, decoder_learned_pos=False, decoder_no_bert=False, decoder_normalize_before=False, decoder_output_dim=1024, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method='tcp://localhost:17955', distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=4, dropout=0.3, encoder_attention_heads=16, encoder_bert_dropout=True, encoder_bert_dropout_ratio=0.5, encoder_bert_mixup=False, encoder_embed_dim=1024, encoder_embed_path=None, encoder_ffn_embed_dim=4096, encoder_layers=6, encoder_learned_pos=False, encoder_normalize_before=False, encoder_ratio=1.0, find_unused_parameters=False, finetune_bert=False, fix_batches_to_gpus=False, fp16=True, fp16_init_scale=128, fp16_scale_tolerance=0.0, fp16_scale_window=None, keep_interval_updates=-1, keep_last_epochs=-1, label_smoothing=0.1, lazy_load=False, left_pad_source='True', left_pad_target='False', log_format=None, log_interval=1000, lr=[0.0005], lr_scheduler='inverse_sqrt', mask_cls_sep=False, max_epoch=0, max_sentences=None, max_sentences_valid=None, max_source_positions=1024, max_target_positions=1024, max_tokens=3584, max_update=0, memory_efficient_fp16=False, min_loss_scale=0.0001, min_lr=1e-09, no_epoch_checkpoints=False, no_progress_bar=False, no_save=False, no_token_positional_embeddings=False, num_workers=0, optimizer='adam', optimizer_overrides='{}', raw_text=False, required_batch_size_multiple=8, reset_dataloader=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='/scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv', save_interval=1, save_interval_updates=0, seed=1, sentence_avg=False, share_all_embeddings=True, share_decoder_input_output_embed=False, skip_invalid_size_inputs_valid_test=False, source_lang='fi', target_lang='sv', task='translation', tbmf_wrapper=False, tensorboard_logdir='', threshold_loss_scale=None, train_subset='train', update_freq=[1], upsample_primary=1, user_dir=None, valid_subset='valid', validate_interval=1, warmup_from_nmt=False, warmup_init_lr=1e-07, warmup_nmt_file='checkpoint_nmt.pt', warmup_updates=4000, weight_decay=0.0001)
| [fi] dictionary: 37752 types
| [sv] dictionary: 37752 types
| /scratch/project_2003453/bertnmt_data valid fi-sv 5000 examples
bert_gates [True, True, True, True, True, True]
TransformerModel(
  (encoder): TransformerEncoder(
    (embed_tokens): Embedding(37752, 1024, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (decoder): TransformerDecoder(
    (embed_tokens): Embedding(37752, 1024, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (4): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (5): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (bert_encoder): BertModel(
    (embeddings): BertEmbeddings(
      (word_embeddings): Embedding(50101, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): BertEncoder(
      (layer): ModuleList(
        (0): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
)
| model transformer_vaswani_wmt_en_de_big, criterion LabelSmoothedCrossEntropyCriterion
| num. model params: 361579008 (num. trained: 237060096)
| training on 4 GPUs
| max tokens per GPU = 3584 and max sentences per GPU = None
| loaded checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint_last.pt (epoch 86 @ 951759 updates)
| loading train data for epoch 86
| /scratch/project_2003453/bertnmt_data train fi-sv 30659795 examples
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 087:   1000 / 49553 loss=3.840, nll_loss=2.175, ppl=4.52, wps=56773, ups=2, wpb=10052.326, bsz=610.064, num_updates=952759, lr=3.23973e-05, gnorm=1.001, clip=0.000, oom=0.000, loss_scale=4.000, wall=652, train_wall=466125
Invalid bert_input shape:torch.Size([5, 692])
| epoch 087:   2000 / 49553 loss=3.838, nll_loss=2.174, ppl=4.51, wps=57114, ups=2, wpb=10059.729, bsz=609.216, num_updates=953759, lr=3.23803e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=4.000, wall=827, train_wall=466281
Invalid bert_input shape:torch.Size([5, 795])
| epoch 087:   3000 / 49553 loss=3.837, nll_loss=2.172, ppl=4.51, wps=57104, ups=3, wpb=10059.983, bsz=615.349, num_updates=954759, lr=3.23633e-05, gnorm=0.998, clip=0.000, oom=0.000, loss_scale=4.000, wall=1003, train_wall=466438
| epoch 087:   4000 / 49553 loss=3.838, nll_loss=2.174, ppl=4.51, wps=57307, ups=3, wpb=10082.981, bsz=615.642, num_updates=955759, lr=3.23464e-05, gnorm=0.998, clip=0.000, oom=0.000, loss_scale=4.000, wall=1178, train_wall=466594
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 087:   5000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57438, ups=4, wpb=10092.964, bsz=617.274, num_updates=956758, lr=3.23295e-05, gnorm=0.998, clip=0.000, oom=0.000, loss_scale=2.000, wall=1353, train_wall=466751
| epoch 087:   6000 / 49553 loss=3.845, nll_loss=2.181, ppl=4.53, wps=57317, ups=4, wpb=10089.915, bsz=618.706, num_updates=957758, lr=3.23126e-05, gnorm=0.999, clip=0.000, oom=0.000, loss_scale=2.000, wall=1531, train_wall=466907
| epoch 087:   7000 / 49553 loss=3.846, nll_loss=2.182, ppl=4.54, wps=57393, ups=4, wpb=10094.663, bsz=617.405, num_updates=958758, lr=3.22958e-05, gnorm=0.999, clip=0.000, oom=0.000, loss_scale=2.000, wall=1705, train_wall=467062
| epoch 087:   8000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=57432, ups=4, wpb=10088.621, bsz=617.863, num_updates=959758, lr=3.22789e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=2.000, wall=1880, train_wall=467217
Invalid bert_input shape:torch.Size([4, 823])
Invalid bert_input shape:torch.Size([5, 636])
| epoch 087:   9000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57350, ups=4, wpb=10096.283, bsz=617.621, num_updates=960758, lr=3.22621e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=4.000, wall=2059, train_wall=467377
| epoch 087:  10000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=57337, ups=4, wpb=10098.426, bsz=618.019, num_updates=961758, lr=3.22454e-05, gnorm=1.001, clip=0.000, oom=0.000, loss_scale=4.000, wall=2236, train_wall=467534
Invalid bert_input shape:torch.Size([5, 701])
| epoch 087:  11000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57326, ups=5, wpb=10103.464, bsz=617.222, num_updates=962758, lr=3.22286e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=4.000, wall=2413, train_wall=467687
| epoch 087:  12000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57317, ups=5, wpb=10105.454, bsz=617.179, num_updates=963758, lr=3.22119e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=4.000, wall=2590, train_wall=467843
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 087:  13000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57388, ups=5, wpb=10116.636, bsz=616.014, num_updates=964757, lr=3.21952e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=4.000, wall=2766, train_wall=468000
| epoch 087:  14000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57409, ups=5, wpb=10119.369, bsz=616.335, num_updates=965757, lr=3.21785e-05, gnorm=0.999, clip=0.000, oom=0.000, loss_scale=4.000, wall=2942, train_wall=468157
| epoch 087:  15000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=57382, ups=5, wpb=10113.682, bsz=616.432, num_updates=966757, lr=3.21619e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=4.000, wall=3118, train_wall=468314
Invalid bert_input shape:torch.Size([6, 896])
Invalid bert_input shape:torch.Size([7, 865])
| epoch 087:  16000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57420, ups=5, wpb=10115.025, bsz=616.046, num_updates=967757, lr=3.21453e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=4.000, wall=3293, train_wall=468471
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 087:  17000 / 49553 loss=3.846, nll_loss=2.182, ppl=4.54, wps=57436, ups=5, wpb=10114.447, bsz=616.625, num_updates=968756, lr=3.21287e-05, gnorm=1.000, clip=0.000, oom=0.000, loss_scale=4.000, wall=3468, train_wall=468626
| epoch 087:  18000 / 49553 loss=3.846, nll_loss=2.182, ppl=4.54, wps=57369, ups=5, wpb=10114.819, bsz=616.996, num_updates=969756, lr=3.21121e-05, gnorm=1.001, clip=0.000, oom=0.000, loss_scale=4.000, wall=3648, train_wall=468787
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 087:  19000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57315, ups=5, wpb=10116.055, bsz=617.729, num_updates=970755, lr=3.20956e-05, gnorm=1.001, clip=0.000, oom=0.000, loss_scale=2.000, wall=3827, train_wall=468947
Invalid bert_input shape:torch.Size([6, 546])
| epoch 087:  20000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=57301, ups=5, wpb=10116.773, bsz=617.918, num_updates=971755, lr=3.20791e-05, gnorm=1.001, clip=0.000, oom=0.000, loss_scale=2.000, wall=4005, train_wall=469106
| epoch 087:  21000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57295, ups=5, wpb=10113.790, bsz=618.067, num_updates=972755, lr=3.20626e-05, gnorm=1.001, clip=0.000, oom=0.000, loss_scale=2.000, wall=4181, train_wall=469262
| epoch 087:  22000 / 49553 loss=3.846, nll_loss=2.182, ppl=4.54, wps=57278, ups=5, wpb=10114.026, bsz=618.015, num_updates=973755, lr=3.20461e-05, gnorm=1.001, clip=0.000, oom=0.000, loss_scale=2.000, wall=4358, train_wall=469422
| epoch 087:  23000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57304, ups=5, wpb=10114.864, bsz=617.618, num_updates=974755, lr=3.20297e-05, gnorm=1.002, clip=0.000, oom=0.000, loss_scale=4.000, wall=4534, train_wall=469579
| epoch 087:  24000 / 49553 loss=3.845, nll_loss=2.182, ppl=4.54, wps=57308, ups=5, wpb=10112.506, bsz=617.522, num_updates=975755, lr=3.20132e-05, gnorm=1.002, clip=0.000, oom=0.000, loss_scale=4.000, wall=4709, train_wall=469735
| epoch 087:  25000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57331, ups=5, wpb=10113.758, bsz=617.519, num_updates=976755, lr=3.19968e-05, gnorm=1.002, clip=0.000, oom=0.000, loss_scale=4.000, wall=4884, train_wall=469892
| epoch 087:  26000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57333, ups=5, wpb=10110.324, bsz=618.099, num_updates=977755, lr=3.19805e-05, gnorm=1.002, clip=0.000, oom=0.000, loss_scale=4.000, wall=5059, train_wall=470048
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 087:  27000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57336, ups=5, wpb=10108.314, bsz=618.632, num_updates=978754, lr=3.19642e-05, gnorm=1.003, clip=0.000, oom=0.000, loss_scale=4.000, wall=5234, train_wall=470203
Invalid bert_input shape:torch.Size([5, 616])
| epoch 087:  28000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57350, ups=5, wpb=10108.409, bsz=618.640, num_updates=979754, lr=3.19478e-05, gnorm=1.003, clip=0.000, oom=0.000, loss_scale=4.000, wall=5409, train_wall=470360
| epoch 087:  29000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57367, ups=5, wpb=10109.239, bsz=618.770, num_updates=980754, lr=3.19315e-05, gnorm=1.003, clip=0.000, oom=0.000, loss_scale=4.000, wall=5584, train_wall=470517
Invalid bert_input shape:torch.Size([5, 703])
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 087:  30000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=57365, ups=5, wpb=10108.169, bsz=619.044, num_updates=981753, lr=3.19153e-05, gnorm=1.003, clip=0.000, oom=0.000, loss_scale=2.000, wall=5760, train_wall=470673
Invalid bert_input shape:torch.Size([4, 843])
| epoch 087:  31000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57387, ups=5, wpb=10107.604, bsz=618.825, num_updates=982753, lr=3.18991e-05, gnorm=1.003, clip=0.000, oom=0.000, loss_scale=2.000, wall=5933, train_wall=470828
| epoch 087:  32000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=57376, ups=5, wpb=10106.643, bsz=618.842, num_updates=983753, lr=3.18828e-05, gnorm=1.003, clip=0.000, oom=0.000, loss_scale=2.000, wall=6110, train_wall=470987
Invalid bert_input shape:torch.Size([6, 784])
| epoch 087:  33000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57355, ups=5, wpb=10109.162, bsz=619.408, num_updates=984753, lr=3.18666e-05, gnorm=1.003, clip=0.000, oom=0.000, loss_scale=2.000, wall=6290, train_wall=471147
| epoch 087:  34000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57325, ups=5, wpb=10108.003, bsz=619.138, num_updates=985753, lr=3.18505e-05, gnorm=1.003, clip=0.000, oom=0.000, loss_scale=4.000, wall=6469, train_wall=471308
| epoch 087:  35000 / 49553 loss=3.846, nll_loss=2.183, ppl=4.54, wps=57324, ups=5, wpb=10107.399, bsz=619.043, num_updates=986753, lr=3.18343e-05, gnorm=1.003, clip=0.000, oom=0.000, loss_scale=4.000, wall=6645, train_wall=471465
| epoch 087:  36000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=57335, ups=5, wpb=10107.392, bsz=618.818, num_updates=987753, lr=3.18182e-05, gnorm=1.003, clip=0.000, oom=0.000, loss_scale=4.000, wall=6820, train_wall=471621
Invalid bert_input shape:torch.Size([6, 547])
| epoch 087:  37000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57345, ups=5, wpb=10106.395, bsz=618.628, num_updates=988753, lr=3.18021e-05, gnorm=1.004, clip=0.000, oom=0.000, loss_scale=4.000, wall=6994, train_wall=471777
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 087:  38000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=57345, ups=5, wpb=10104.882, bsz=618.971, num_updates=989752, lr=3.17861e-05, gnorm=1.004, clip=0.000, oom=0.000, loss_scale=2.000, wall=7169, train_wall=471934
Invalid bert_input shape:torch.Size([4, 790])
| epoch 087:  39000 / 49553 loss=3.847, nll_loss=2.183, ppl=4.54, wps=57350, ups=5, wpb=10104.007, bsz=618.767, num_updates=990752, lr=3.177e-05, gnorm=1.004, clip=0.000, oom=0.000, loss_scale=2.000, wall=7344, train_wall=472090
| epoch 087:  40000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57362, ups=5, wpb=10102.743, bsz=619.033, num_updates=991752, lr=3.1754e-05, gnorm=1.004, clip=0.000, oom=0.000, loss_scale=2.000, wall=7518, train_wall=472245
| epoch 087:  41000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57360, ups=5, wpb=10100.947, bsz=619.039, num_updates=992752, lr=3.1738e-05, gnorm=1.004, clip=0.000, oom=0.000, loss_scale=2.000, wall=7693, train_wall=472402
Invalid bert_input shape:torch.Size([5, 950])
| epoch 087:  42000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57344, ups=5, wpb=10101.511, bsz=618.914, num_updates=993752, lr=3.1722e-05, gnorm=1.004, clip=0.000, oom=0.000, loss_scale=4.000, wall=7872, train_wall=472561
| epoch 087:  43000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57352, ups=5, wpb=10101.622, bsz=618.495, num_updates=994752, lr=3.17061e-05, gnorm=1.005, clip=0.000, oom=0.000, loss_scale=4.000, wall=8047, train_wall=472718
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 087:  44000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57354, ups=5, wpb=10102.135, bsz=618.432, num_updates=995751, lr=3.16902e-05, gnorm=1.005, clip=0.000, oom=0.000, loss_scale=2.000, wall=8223, train_wall=472876
Invalid bert_input shape:torch.Size([8, 1356])
| epoch 087:  45000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.55, wps=57358, ups=5, wpb=10103.295, bsz=618.551, num_updates=996751, lr=3.16743e-05, gnorm=1.005, clip=0.000, oom=0.000, loss_scale=2.000, wall=8400, train_wall=473034
| epoch 087:  46000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57376, ups=5, wpb=10103.588, bsz=618.392, num_updates=997751, lr=3.16584e-05, gnorm=1.005, clip=0.000, oom=0.000, loss_scale=2.000, wall=8573, train_wall=473190
| epoch 087:  47000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57379, ups=5, wpb=10102.734, bsz=618.441, num_updates=998751, lr=3.16425e-05, gnorm=1.005, clip=0.000, oom=0.000, loss_scale=2.000, wall=8748, train_wall=473346
Invalid bert_input shape:torch.Size([6, 878])
Invalid bert_input shape:torch.Size([6, 566])
| epoch 087:  48000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57367, ups=5, wpb=10100.891, bsz=618.474, num_updates=999751, lr=3.16267e-05, gnorm=1.006, clip=0.000, oom=0.000, loss_scale=4.000, wall=8925, train_wall=473504
| epoch 087:  49000 / 49553 loss=3.847, nll_loss=2.184, ppl=4.54, wps=57369, ups=5, wpb=10099.879, bsz=618.749, num_updates=1.00075e+06, lr=3.16109e-05, gnorm=1.006, clip=0.000, oom=0.000, loss_scale=4.000, wall=9100, train_wall=473660
| epoch 087 | loss 3.847 | nll_loss 2.184 | ppl 4.54 | wps 57360 | ups 5 | wpb 10100.082 | bsz 618.663 | num_updates 1.0013e+06 | lr 3.16022e-05 | gnorm 1.006 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 9198 | train_wall 473749
| epoch 087 | valid on 'valid' subset | loss 2.755 | nll_loss 0.942 | ppl 1.92 | num_updates 1.0013e+06 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint87.pt (epoch 87 @ 1001303 updates) (writing took 11.326627254486084 seconds)
Invalid bert_input shape:torch.Size([3, 1514])
Invalid bert_input shape:torch.Size([4, 790])
| epoch 088:   1000 / 49553 loss=3.811, nll_loss=2.143, ppl=4.42, wps=56927, ups=3, wpb=10038.439, bsz=612.260, num_updates=1.0023e+06, lr=3.15864e-05, gnorm=1.007, clip=0.000, oom=0.000, loss_scale=4.000, wall=9506, train_wall=473904
| epoch 088:   2000 / 49553 loss=3.817, nll_loss=2.150, ppl=4.44, wps=56690, ups=4, wpb=10034.758, bsz=615.887, num_updates=1.0033e+06, lr=3.15707e-05, gnorm=1.009, clip=0.000, oom=0.000, loss_scale=4.000, wall=9684, train_wall=474063
| epoch 088:   3000 / 49553 loss=3.827, nll_loss=2.161, ppl=4.47, wps=56581, ups=5, wpb=10043.315, bsz=617.057, num_updates=1.0043e+06, lr=3.15549e-05, gnorm=1.014, clip=0.000, oom=0.000, loss_scale=8.000, wall=9862, train_wall=474223
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 088:   4000 / 49553 loss=3.832, nll_loss=2.168, ppl=4.49, wps=56610, ups=5, wpb=10067.075, bsz=617.256, num_updates=1.0053e+06, lr=3.15393e-05, gnorm=1.015, clip=0.000, oom=0.000, loss_scale=4.000, wall=10041, train_wall=474382
Invalid bert_input shape:torch.Size([6, 896])
| epoch 088:   5000 / 49553 loss=3.833, nll_loss=2.168, ppl=4.49, wps=56842, ups=5, wpb=10068.316, bsz=617.831, num_updates=1.0063e+06, lr=3.15236e-05, gnorm=1.014, clip=0.000, oom=0.000, loss_scale=4.000, wall=10215, train_wall=474538
Invalid bert_input shape:torch.Size([7, 900])
| epoch 088:   6000 / 49553 loss=3.832, nll_loss=2.167, ppl=4.49, wps=56976, ups=5, wpb=10071.430, bsz=618.175, num_updates=1.0073e+06, lr=3.15079e-05, gnorm=1.014, clip=0.000, oom=0.000, loss_scale=4.000, wall=10390, train_wall=474694
| epoch 088:   7000 / 49553 loss=3.830, nll_loss=2.165, ppl=4.48, wps=56768, ups=5, wpb=10068.115, bsz=617.702, num_updates=1.0083e+06, lr=3.14923e-05, gnorm=1.014, clip=0.000, oom=0.000, loss_scale=4.000, wall=10571, train_wall=474856
| epoch 088:   8000 / 49553 loss=3.832, nll_loss=2.167, ppl=4.49, wps=56783, ups=5, wpb=10073.221, bsz=618.522, num_updates=1.0093e+06, lr=3.14767e-05, gnorm=1.014, clip=0.000, oom=0.000, loss_scale=8.000, wall=10749, train_wall=475016
Invalid bert_input shape:torch.Size([7, 600])
| epoch 088:   9000 / 49553 loss=3.833, nll_loss=2.168, ppl=4.50, wps=56774, ups=5, wpb=10072.295, bsz=617.411, num_updates=1.0103e+06, lr=3.14611e-05, gnorm=1.015, clip=0.000, oom=0.000, loss_scale=8.000, wall=10926, train_wall=475176
Invalid bert_input shape:torch.Size([5, 666])
Invalid bert_input shape:torch.Size([2, 1562])
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 088:  10000 / 49553 loss=3.833, nll_loss=2.168, ppl=4.49, wps=56888, ups=5, wpb=10084.289, bsz=618.934, num_updates=1.0113e+06, lr=3.14456e-05, gnorm=1.014, clip=0.000, oom=0.000, loss_scale=4.000, wall=11102, train_wall=475331
| epoch 088:  11000 / 49553 loss=3.832, nll_loss=2.167, ppl=4.49, wps=56969, ups=5, wpb=10082.590, bsz=618.430, num_updates=1.0123e+06, lr=3.143e-05, gnorm=1.014, clip=0.000, oom=0.000, loss_scale=4.000, wall=11276, train_wall=475486
| epoch 088:  12000 / 49553 loss=3.833, nll_loss=2.168, ppl=4.49, wps=56876, ups=5, wpb=10079.969, bsz=618.720, num_updates=1.0133e+06, lr=3.14145e-05, gnorm=1.015, clip=0.000, oom=0.000, loss_scale=4.000, wall=11456, train_wall=475639
| epoch 088:  13000 / 49553 loss=3.833, nll_loss=2.168, ppl=4.49, wps=56931, ups=5, wpb=10079.383, bsz=619.130, num_updates=1.0143e+06, lr=3.1399e-05, gnorm=1.015, clip=0.000, oom=0.000, loss_scale=4.000, wall=11631, train_wall=475796
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 088:  14000 / 49553 loss=3.834, nll_loss=2.169, ppl=4.50, wps=57019, ups=5, wpb=10084.557, bsz=618.562, num_updates=1.0153e+06, lr=3.13836e-05, gnorm=1.015, clip=0.000, oom=0.000, loss_scale=4.000, wall=11805, train_wall=475953
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 088:  15000 / 49553 loss=3.835, nll_loss=2.171, ppl=4.50, wps=57073, ups=5, wpb=10087.630, bsz=618.435, num_updates=1.0163e+06, lr=3.13682e-05, gnorm=1.016, clip=0.000, oom=0.000, loss_scale=2.000, wall=11980, train_wall=476110
| epoch 088:  16000 / 49553 loss=3.837, nll_loss=2.173, ppl=4.51, wps=57135, ups=5, wpb=10092.667, bsz=618.026, num_updates=1.0173e+06, lr=3.13527e-05, gnorm=1.016, clip=0.000, oom=0.000, loss_scale=2.000, wall=12155, train_wall=476267
| epoch 088:  17000 / 49553 loss=3.838, nll_loss=2.174, ppl=4.51, wps=57177, ups=5, wpb=10096.035, bsz=618.131, num_updates=1.0183e+06, lr=3.13373e-05, gnorm=1.016, clip=0.000, oom=0.000, loss_scale=2.000, wall=12331, train_wall=476423
| epoch 088:  18000 / 49553 loss=3.838, nll_loss=2.174, ppl=4.51, wps=57187, ups=5, wpb=10092.854, bsz=618.288, num_updates=1.0193e+06, lr=3.1322e-05, gnorm=1.017, clip=0.000, oom=0.000, loss_scale=2.000, wall=12506, train_wall=476580
| epoch 088:  19000 / 49553 loss=3.838, nll_loss=2.174, ppl=4.51, wps=57189, ups=5, wpb=10090.778, bsz=618.339, num_updates=1.0203e+06, lr=3.13066e-05, gnorm=1.017, clip=0.000, oom=0.000, loss_scale=4.000, wall=12682, train_wall=476736
| epoch 088:  20000 / 49553 loss=3.838, nll_loss=2.174, ppl=4.51, wps=57188, ups=5, wpb=10089.429, bsz=618.383, num_updates=1.0213e+06, lr=3.12913e-05, gnorm=1.017, clip=0.000, oom=0.000, loss_scale=4.000, wall=12858, train_wall=476890
| epoch 088:  21000 / 49553 loss=3.838, nll_loss=2.174, ppl=4.51, wps=57206, ups=5, wpb=10091.348, bsz=618.532, num_updates=1.0223e+06, lr=3.1276e-05, gnorm=1.017, clip=0.000, oom=0.000, loss_scale=4.000, wall=13034, train_wall=477047
| epoch 088:  22000 / 49553 loss=3.838, nll_loss=2.174, ppl=4.51, wps=57214, ups=5, wpb=10088.628, bsz=618.753, num_updates=1.0233e+06, lr=3.12607e-05, gnorm=1.018, clip=0.000, oom=0.000, loss_scale=4.000, wall=13208, train_wall=477204
| epoch 088:  23000 / 49553 loss=3.838, nll_loss=2.174, ppl=4.51, wps=57233, ups=5, wpb=10087.276, bsz=618.865, num_updates=1.0243e+06, lr=3.12454e-05, gnorm=1.018, clip=0.000, oom=0.000, loss_scale=8.000, wall=13383, train_wall=477359
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([5, 602])
Invalid bert_input shape:torch.Size([4, 843])
Invalid bert_input shape:torch.Size([5, 1524])
| epoch 088:  24000 / 49553 loss=3.838, nll_loss=2.174, ppl=4.51, wps=57237, ups=6, wpb=10088.062, bsz=619.185, num_updates=1.0253e+06, lr=3.12302e-05, gnorm=1.018, clip=0.000, oom=0.000, loss_scale=4.000, wall=13559, train_wall=477517
| epoch 088:  25000 / 49553 loss=3.839, nll_loss=2.175, ppl=4.52, wps=57262, ups=6, wpb=10090.462, bsz=619.118, num_updates=1.0263e+06, lr=3.1215e-05, gnorm=1.018, clip=0.000, oom=0.000, loss_scale=4.000, wall=13734, train_wall=477674
| epoch 088:  26000 / 49553 loss=3.839, nll_loss=2.175, ppl=4.52, wps=57288, ups=6, wpb=10091.859, bsz=619.074, num_updates=1.0273e+06, lr=3.11998e-05, gnorm=1.018, clip=0.000, oom=0.000, loss_scale=4.000, wall=13909, train_wall=477830
| epoch 088:  27000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57279, ups=6, wpb=10090.834, bsz=619.155, num_updates=1.0283e+06, lr=3.11846e-05, gnorm=1.019, clip=0.000, oom=0.000, loss_scale=4.000, wall=14086, train_wall=477988
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 088:  28000 / 49553 loss=3.840, nll_loss=2.176, ppl=4.52, wps=57303, ups=6, wpb=10092.717, bsz=619.222, num_updates=1.0293e+06, lr=3.11695e-05, gnorm=1.019, clip=0.000, oom=0.000, loss_scale=4.000, wall=14260, train_wall=478144
| epoch 088:  29000 / 49553 loss=3.841, nll_loss=2.178, ppl=4.52, wps=57297, ups=6, wpb=10092.239, bsz=619.280, num_updates=1.0303e+06, lr=3.11543e-05, gnorm=1.019, clip=0.000, oom=0.000, loss_scale=4.000, wall=14437, train_wall=478298
| epoch 088:  30000 / 49553 loss=3.842, nll_loss=2.178, ppl=4.53, wps=57267, ups=6, wpb=10093.908, bsz=618.847, num_updates=1.0313e+06, lr=3.11392e-05, gnorm=1.019, clip=0.000, oom=0.000, loss_scale=4.000, wall=14617, train_wall=478452
| epoch 088:  31000 / 49553 loss=3.842, nll_loss=2.178, ppl=4.53, wps=57245, ups=6, wpb=10093.297, bsz=618.899, num_updates=1.0323e+06, lr=3.11241e-05, gnorm=1.019, clip=0.000, oom=0.000, loss_scale=4.000, wall=14795, train_wall=478605
Invalid bert_input shape:torch.Size([5, 729])
| epoch 088:  32000 / 49553 loss=3.841, nll_loss=2.178, ppl=4.52, wps=57225, ups=6, wpb=10091.894, bsz=619.170, num_updates=1.0333e+06, lr=3.11091e-05, gnorm=1.019, clip=0.000, oom=0.000, loss_scale=4.000, wall=14972, train_wall=478764
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 088:  33000 / 49553 loss=3.842, nll_loss=2.178, ppl=4.53, wps=57248, ups=6, wpb=10095.079, bsz=619.126, num_updates=1.0343e+06, lr=3.10941e-05, gnorm=1.019, clip=0.000, oom=0.000, loss_scale=4.000, wall=15148, train_wall=478921
Invalid bert_input shape:torch.Size([4, 858])
| epoch 088:  34000 / 49553 loss=3.843, nll_loss=2.179, ppl=4.53, wps=57269, ups=6, wpb=10096.343, bsz=618.729, num_updates=1.0353e+06, lr=3.1079e-05, gnorm=1.019, clip=0.000, oom=0.000, loss_scale=4.000, wall=15323, train_wall=479077
| epoch 088:  35000 / 49553 loss=3.843, nll_loss=2.179, ppl=4.53, wps=57286, ups=6, wpb=10097.030, bsz=618.900, num_updates=1.0363e+06, lr=3.1064e-05, gnorm=1.019, clip=0.000, oom=0.000, loss_scale=4.000, wall=15498, train_wall=479232
| epoch 088:  36000 / 49553 loss=3.843, nll_loss=2.179, ppl=4.53, wps=57262, ups=6, wpb=10097.240, bsz=619.399, num_updates=1.0373e+06, lr=3.10491e-05, gnorm=1.019, clip=0.000, oom=0.000, loss_scale=4.000, wall=15677, train_wall=479385
| epoch 088:  37000 / 49553 loss=3.843, nll_loss=2.180, ppl=4.53, wps=57254, ups=6, wpb=10096.611, bsz=619.238, num_updates=1.0383e+06, lr=3.10341e-05, gnorm=1.020, clip=0.000, oom=0.000, loss_scale=8.000, wall=15854, train_wall=479541
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 088:  38000 / 49553 loss=3.843, nll_loss=2.180, ppl=4.53, wps=57263, ups=6, wpb=10095.314, bsz=619.155, num_updates=1.0393e+06, lr=3.10192e-05, gnorm=1.020, clip=0.000, oom=0.000, loss_scale=4.000, wall=16028, train_wall=479697
| epoch 088:  39000 / 49553 loss=3.843, nll_loss=2.180, ppl=4.53, wps=57268, ups=6, wpb=10096.216, bsz=619.215, num_updates=1.0403e+06, lr=3.10043e-05, gnorm=1.020, clip=0.000, oom=0.000, loss_scale=4.000, wall=16204, train_wall=479854
| epoch 088:  40000 / 49553 loss=3.843, nll_loss=2.180, ppl=4.53, wps=57286, ups=6, wpb=10098.031, bsz=619.291, num_updates=1.0413e+06, lr=3.09894e-05, gnorm=1.020, clip=0.000, oom=0.000, loss_scale=4.000, wall=16379, train_wall=480011
| epoch 088:  41000 / 49553 loss=3.844, nll_loss=2.180, ppl=4.53, wps=57291, ups=6, wpb=10099.229, bsz=619.168, num_updates=1.0423e+06, lr=3.09745e-05, gnorm=1.020, clip=0.000, oom=0.000, loss_scale=4.000, wall=16556, train_wall=480169
| epoch 088:  42000 / 49553 loss=3.844, nll_loss=2.181, ppl=4.53, wps=57293, ups=6, wpb=10099.741, bsz=619.121, num_updates=1.0433e+06, lr=3.09597e-05, gnorm=1.020, clip=0.000, oom=0.000, loss_scale=8.000, wall=16732, train_wall=480325
Invalid bert_input shape:torch.Size([6, 863])
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 088:  43000 / 49553 loss=3.844, nll_loss=2.181, ppl=4.54, wps=57302, ups=6, wpb=10100.107, bsz=618.925, num_updates=1.0443e+06, lr=3.09449e-05, gnorm=1.020, clip=0.000, oom=0.000, loss_scale=4.000, wall=16908, train_wall=480482
| WARNING: overflow detected, setting loss scale to: 2.0
Invalid bert_input shape:torch.Size([5, 795])
Invalid bert_input shape:torch.Size([7, 722])
Invalid bert_input shape:torch.Size([3, 1184])
| epoch 088:  44000 / 49553 loss=3.844, nll_loss=2.181, ppl=4.54, wps=57299, ups=6, wpb=10098.984, bsz=618.812, num_updates=1.04529e+06, lr=3.09301e-05, gnorm=1.020, clip=0.000, oom=0.000, loss_scale=2.000, wall=17083, train_wall=480639
| epoch 088:  45000 / 49553 loss=3.845, nll_loss=2.181, ppl=4.54, wps=57312, ups=6, wpb=10099.070, bsz=618.950, num_updates=1.04629e+06, lr=3.09153e-05, gnorm=1.021, clip=0.000, oom=0.000, loss_scale=2.000, wall=17258, train_wall=480795
Invalid bert_input shape:torch.Size([5, 655])
| epoch 088:  46000 / 49553 loss=3.845, nll_loss=2.181, ppl=4.54, wps=57317, ups=6, wpb=10097.563, bsz=619.002, num_updates=1.04729e+06, lr=3.09005e-05, gnorm=1.021, clip=0.000, oom=0.000, loss_scale=2.000, wall=17432, train_wall=480951
| epoch 088:  47000 / 49553 loss=3.844, nll_loss=2.181, ppl=4.54, wps=57314, ups=6, wpb=10097.611, bsz=618.960, num_updates=1.04829e+06, lr=3.08858e-05, gnorm=1.021, clip=0.000, oom=0.000, loss_scale=2.000, wall=17609, train_wall=481108
Invalid bert_input shape:torch.Size([4, 1167])
| epoch 088:  48000 / 49553 loss=3.845, nll_loss=2.181, ppl=4.54, wps=57318, ups=6, wpb=10098.126, bsz=618.761, num_updates=1.04929e+06, lr=3.08711e-05, gnorm=1.021, clip=0.000, oom=0.000, loss_scale=4.000, wall=17785, train_wall=481266
| epoch 088:  49000 / 49553 loss=3.845, nll_loss=2.182, ppl=4.54, wps=57322, ups=6, wpb=10099.405, bsz=618.658, num_updates=1.05029e+06, lr=3.08564e-05, gnorm=1.021, clip=0.000, oom=0.000, loss_scale=4.000, wall=17961, train_wall=481424
| epoch 088 | loss 3.845 | nll_loss 2.182 | ppl 4.54 | wps 57310 | ups 6 | wpb 10099.799 | bsz 618.654 | num_updates 1.05085e+06 | lr 3.08482e-05 | gnorm 1.021 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 18061 | train_wall 481513
| epoch 088 | valid on 'valid' subset | loss 2.740 | nll_loss 0.920 | ppl 1.89 | num_updates 1.05085e+06 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint88.pt (epoch 88 @ 1050846 updates) (writing took 7.433200836181641 seconds)
| epoch 089:   1000 / 49553 loss=3.820, nll_loss=2.153, ppl=4.45, wps=55996, ups=3, wpb=10069.403, bsz=610.365, num_updates=1.05185e+06, lr=3.08336e-05, gnorm=1.027, clip=0.000, oom=0.000, loss_scale=4.000, wall=18378, train_wall=481677
| epoch 089:   2000 / 49553 loss=3.829, nll_loss=2.164, ppl=4.48, wps=56491, ups=4, wpb=10082.111, bsz=615.102, num_updates=1.05285e+06, lr=3.08189e-05, gnorm=1.030, clip=0.000, oom=0.000, loss_scale=4.000, wall=18555, train_wall=481834
Invalid bert_input shape:torch.Size([7, 600])
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 089:   3000 / 49553 loss=3.834, nll_loss=2.169, ppl=4.50, wps=56694, ups=4, wpb=10084.498, bsz=619.907, num_updates=1.05385e+06, lr=3.08043e-05, gnorm=1.031, clip=0.000, oom=0.000, loss_scale=4.000, wall=18732, train_wall=481990
| epoch 089:   4000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=56961, ups=5, wpb=10096.646, bsz=619.330, num_updates=1.05485e+06, lr=3.07897e-05, gnorm=1.032, clip=0.000, oom=0.000, loss_scale=4.000, wall=18907, train_wall=482146
| epoch 089:   5000 / 49553 loss=3.839, nll_loss=2.175, ppl=4.52, wps=57190, ups=5, wpb=10111.786, bsz=621.163, num_updates=1.05585e+06, lr=3.07751e-05, gnorm=1.029, clip=0.000, oom=0.000, loss_scale=4.000, wall=19082, train_wall=482302
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 089:   6000 / 49553 loss=3.842, nll_loss=2.178, ppl=4.53, wps=57284, ups=5, wpb=10107.194, bsz=618.795, num_updates=1.05684e+06, lr=3.07606e-05, gnorm=1.030, clip=0.000, oom=0.000, loss_scale=2.000, wall=19257, train_wall=482457
Invalid bert_input shape:torch.Size([5, 666])
| epoch 089:   7000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57342, ups=5, wpb=10106.029, bsz=618.774, num_updates=1.05784e+06, lr=3.0746e-05, gnorm=1.031, clip=0.000, oom=0.000, loss_scale=2.000, wall=19432, train_wall=482612
Invalid bert_input shape:torch.Size([4, 790])
| epoch 089:   8000 / 49553 loss=3.842, nll_loss=2.178, ppl=4.53, wps=57432, ups=5, wpb=10110.394, bsz=617.778, num_updates=1.05884e+06, lr=3.07315e-05, gnorm=1.031, clip=0.000, oom=0.000, loss_scale=2.000, wall=19606, train_wall=482768
| epoch 089:   9000 / 49553 loss=3.842, nll_loss=2.178, ppl=4.53, wps=57398, ups=5, wpb=10103.247, bsz=617.620, num_updates=1.05984e+06, lr=3.0717e-05, gnorm=1.032, clip=0.000, oom=0.000, loss_scale=2.000, wall=19782, train_wall=482921
| epoch 089:  10000 / 49553 loss=3.840, nll_loss=2.176, ppl=4.52, wps=57421, ups=5, wpb=10103.581, bsz=617.519, num_updates=1.06084e+06, lr=3.07025e-05, gnorm=1.032, clip=0.000, oom=0.000, loss_scale=4.000, wall=19958, train_wall=483078
| epoch 089:  11000 / 49553 loss=3.840, nll_loss=2.176, ppl=4.52, wps=57415, ups=5, wpb=10098.158, bsz=618.430, num_updates=1.06184e+06, lr=3.06881e-05, gnorm=1.032, clip=0.000, oom=0.000, loss_scale=4.000, wall=20133, train_wall=483234
Invalid bert_input shape:torch.Size([6, 896])
| epoch 089:  12000 / 49553 loss=3.839, nll_loss=2.175, ppl=4.52, wps=57306, ups=5, wpb=10098.120, bsz=618.942, num_updates=1.06284e+06, lr=3.06736e-05, gnorm=1.031, clip=0.000, oom=0.000, loss_scale=4.000, wall=20313, train_wall=483394
| epoch 089:  13000 / 49553 loss=3.839, nll_loss=2.175, ppl=4.51, wps=57240, ups=5, wpb=10098.545, bsz=619.236, num_updates=1.06384e+06, lr=3.06592e-05, gnorm=1.031, clip=0.000, oom=0.000, loss_scale=4.000, wall=20492, train_wall=483553
| epoch 089:  14000 / 49553 loss=3.839, nll_loss=2.175, ppl=4.52, wps=57269, ups=5, wpb=10100.730, bsz=619.197, num_updates=1.06484e+06, lr=3.06448e-05, gnorm=1.031, clip=0.000, oom=0.000, loss_scale=8.000, wall=20667, train_wall=483709
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 089:  15000 / 49553 loss=3.840, nll_loss=2.176, ppl=4.52, wps=57259, ups=5, wpb=10096.465, bsz=619.579, num_updates=1.06584e+06, lr=3.06304e-05, gnorm=1.032, clip=0.000, oom=0.000, loss_scale=4.000, wall=20843, train_wall=483865
Invalid bert_input shape:torch.Size([4, 758])
| epoch 089:  16000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57285, ups=5, wpb=10095.184, bsz=618.933, num_updates=1.06684e+06, lr=3.06161e-05, gnorm=1.033, clip=0.000, oom=0.000, loss_scale=4.000, wall=21018, train_wall=484021
| epoch 089:  17000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57301, ups=5, wpb=10093.802, bsz=618.105, num_updates=1.06784e+06, lr=3.06017e-05, gnorm=1.033, clip=0.000, oom=0.000, loss_scale=4.000, wall=21193, train_wall=484178
| epoch 089:  18000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57231, ups=5, wpb=10095.385, bsz=618.504, num_updates=1.06884e+06, lr=3.05874e-05, gnorm=1.033, clip=0.000, oom=0.000, loss_scale=4.000, wall=21373, train_wall=484339
Invalid bert_input shape:torch.Size([5, 674])
| epoch 089:  19000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57206, ups=5, wpb=10094.811, bsz=618.139, num_updates=1.06984e+06, lr=3.05731e-05, gnorm=1.033, clip=0.000, oom=0.000, loss_scale=8.000, wall=21551, train_wall=484498
| epoch 089:  20000 / 49553 loss=3.839, nll_loss=2.176, ppl=4.52, wps=57230, ups=5, wpb=10095.756, bsz=618.346, num_updates=1.07084e+06, lr=3.05588e-05, gnorm=1.033, clip=0.000, oom=0.000, loss_scale=8.000, wall=21726, train_wall=484655
Invalid bert_input shape:torch.Size([5, 907])
Invalid bert_input shape:torch.Size([4, 720])
| epoch 089:  21000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57210, ups=5, wpb=10096.964, bsz=618.061, num_updates=1.07184e+06, lr=3.05446e-05, gnorm=1.033, clip=0.000, oom=0.000, loss_scale=8.000, wall=21904, train_wall=484809
| epoch 089:  22000 / 49553 loss=3.840, nll_loss=2.176, ppl=4.52, wps=57179, ups=5, wpb=10096.721, bsz=617.981, num_updates=1.07284e+06, lr=3.05303e-05, gnorm=1.033, clip=0.000, oom=0.000, loss_scale=8.000, wall=22083, train_wall=484968
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 089:  23000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57199, ups=5, wpb=10096.815, bsz=618.165, num_updates=1.07384e+06, lr=3.05161e-05, gnorm=1.033, clip=0.000, oom=0.000, loss_scale=8.000, wall=22258, train_wall=485125
| WARNING: overflow detected, setting loss scale to: 4.0
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 089:  24000 / 49553 loss=3.841, nll_loss=2.178, ppl=4.52, wps=57185, ups=5, wpb=10094.900, bsz=618.083, num_updates=1.07484e+06, lr=3.0502e-05, gnorm=1.034, clip=0.000, oom=0.000, loss_scale=2.000, wall=22434, train_wall=485282
Invalid bert_input shape:torch.Size([4, 843])
| epoch 089:  25000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57222, ups=5, wpb=10095.701, bsz=618.069, num_updates=1.07584e+06, lr=3.04878e-05, gnorm=1.034, clip=0.000, oom=0.000, loss_scale=2.000, wall=22608, train_wall=485438
| epoch 089:  26000 / 49553 loss=3.841, nll_loss=2.178, ppl=4.52, wps=57218, ups=6, wpb=10096.131, bsz=618.001, num_updates=1.07684e+06, lr=3.04736e-05, gnorm=1.034, clip=0.000, oom=0.000, loss_scale=2.000, wall=22785, train_wall=485591
Invalid bert_input shape:torch.Size([5, 627])
Invalid bert_input shape:torch.Size([7, 900])
| epoch 089:  27000 / 49553 loss=3.841, nll_loss=2.178, ppl=4.52, wps=57188, ups=6, wpb=10095.766, bsz=618.301, num_updates=1.07784e+06, lr=3.04595e-05, gnorm=1.034, clip=0.000, oom=0.000, loss_scale=2.000, wall=22964, train_wall=485743
Invalid bert_input shape:torch.Size([5, 656])
| epoch 089:  28000 / 49553 loss=3.841, nll_loss=2.178, ppl=4.52, wps=57163, ups=6, wpb=10095.966, bsz=618.226, num_updates=1.07884e+06, lr=3.04454e-05, gnorm=1.034, clip=0.000, oom=0.000, loss_scale=4.000, wall=23143, train_wall=485894
| epoch 089:  29000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57157, ups=6, wpb=10095.430, bsz=617.916, num_updates=1.07984e+06, lr=3.04313e-05, gnorm=1.034, clip=0.000, oom=0.000, loss_scale=4.000, wall=23320, train_wall=486049
Invalid bert_input shape:torch.Size([6, 863])
| epoch 089:  30000 / 49553 loss=3.841, nll_loss=2.178, ppl=4.52, wps=57166, ups=6, wpb=10094.409, bsz=617.707, num_updates=1.08084e+06, lr=3.04172e-05, gnorm=1.034, clip=0.000, oom=0.000, loss_scale=4.000, wall=23495, train_wall=486206
| epoch 089:  31000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57196, ups=6, wpb=10094.788, bsz=617.614, num_updates=1.08184e+06, lr=3.04031e-05, gnorm=1.034, clip=0.000, oom=0.000, loss_scale=4.000, wall=23669, train_wall=486361
| epoch 089:  32000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57214, ups=6, wpb=10094.188, bsz=617.629, num_updates=1.08284e+06, lr=3.03891e-05, gnorm=1.035, clip=0.000, oom=0.000, loss_scale=8.000, wall=23843, train_wall=486517
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([5, 701])
| epoch 089:  33000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57232, ups=6, wpb=10094.995, bsz=618.058, num_updates=1.08384e+06, lr=3.03751e-05, gnorm=1.035, clip=0.000, oom=0.000, loss_scale=4.000, wall=24018, train_wall=486674
| epoch 089:  34000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57256, ups=6, wpb=10096.837, bsz=618.107, num_updates=1.08484e+06, lr=3.03611e-05, gnorm=1.035, clip=0.000, oom=0.000, loss_scale=4.000, wall=24193, train_wall=486830
Invalid bert_input shape:torch.Size([5, 869])
| epoch 089:  35000 / 49553 loss=3.841, nll_loss=2.178, ppl=4.52, wps=57253, ups=6, wpb=10096.253, bsz=617.876, num_updates=1.08584e+06, lr=3.03471e-05, gnorm=1.035, clip=0.000, oom=0.000, loss_scale=4.000, wall=24369, train_wall=486988
Invalid bert_input shape:torch.Size([5, 692])
| epoch 089:  36000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57241, ups=6, wpb=10095.907, bsz=617.865, num_updates=1.08684e+06, lr=3.03331e-05, gnorm=1.035, clip=0.000, oom=0.000, loss_scale=4.000, wall=24547, train_wall=487147
| epoch 089:  37000 / 49553 loss=3.841, nll_loss=2.178, ppl=4.52, wps=57225, ups=6, wpb=10095.749, bsz=617.539, num_updates=1.08784e+06, lr=3.03192e-05, gnorm=1.035, clip=0.000, oom=0.000, loss_scale=8.000, wall=24725, train_wall=487307
| epoch 089:  38000 / 49553 loss=3.841, nll_loss=2.178, ppl=4.53, wps=57213, ups=6, wpb=10096.513, bsz=617.685, num_updates=1.08884e+06, lr=3.03053e-05, gnorm=1.035, clip=0.000, oom=0.000, loss_scale=8.000, wall=24903, train_wall=487466
| epoch 089:  39000 / 49553 loss=3.842, nll_loss=2.179, ppl=4.53, wps=57226, ups=6, wpb=10097.232, bsz=617.864, num_updates=1.08984e+06, lr=3.02913e-05, gnorm=1.036, clip=0.000, oom=0.000, loss_scale=8.000, wall=25079, train_wall=487624
| epoch 089:  40000 / 49553 loss=3.842, nll_loss=2.179, ppl=4.53, wps=57215, ups=6, wpb=10099.219, bsz=617.936, num_updates=1.09084e+06, lr=3.02775e-05, gnorm=1.036, clip=0.000, oom=0.000, loss_scale=8.000, wall=25258, train_wall=487784
| WARNING: overflow detected, setting loss scale to: 8.0
| epoch 089:  41000 / 49553 loss=3.843, nll_loss=2.179, ppl=4.53, wps=57209, ups=6, wpb=10099.603, bsz=618.217, num_updates=1.09184e+06, lr=3.02636e-05, gnorm=1.036, clip=0.000, oom=0.000, loss_scale=8.000, wall=25435, train_wall=487942
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 089:  42000 / 49553 loss=3.842, nll_loss=2.179, ppl=4.53, wps=57208, ups=6, wpb=10099.006, bsz=617.803, num_updates=1.09284e+06, lr=3.02498e-05, gnorm=1.036, clip=0.000, oom=0.000, loss_scale=4.000, wall=25611, train_wall=488099
Invalid bert_input shape:torch.Size([3, 1514])
| epoch 089:  43000 / 49553 loss=3.843, nll_loss=2.179, ppl=4.53, wps=57223, ups=6, wpb=10099.691, bsz=617.935, num_updates=1.09384e+06, lr=3.02359e-05, gnorm=1.036, clip=0.000, oom=0.000, loss_scale=4.000, wall=25786, train_wall=488256
Invalid bert_input shape:torch.Size([4, 832])
| epoch 089:  44000 / 49553 loss=3.842, nll_loss=2.179, ppl=4.53, wps=57231, ups=6, wpb=10098.729, bsz=618.332, num_updates=1.09484e+06, lr=3.02221e-05, gnorm=1.037, clip=0.000, oom=0.000, loss_scale=4.000, wall=25961, train_wall=488410
Invalid bert_input shape:torch.Size([5, 616])
| epoch 089:  45000 / 49553 loss=3.842, nll_loss=2.179, ppl=4.53, wps=57237, ups=6, wpb=10099.290, bsz=618.345, num_updates=1.09584e+06, lr=3.02083e-05, gnorm=1.036, clip=0.000, oom=0.000, loss_scale=4.000, wall=26137, train_wall=488567
| epoch 089:  46000 / 49553 loss=3.842, nll_loss=2.179, ppl=4.53, wps=57244, ups=6, wpb=10097.919, bsz=618.551, num_updates=1.09684e+06, lr=3.01946e-05, gnorm=1.037, clip=0.000, oom=0.000, loss_scale=8.000, wall=26311, train_wall=488722
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([6, 595])
| epoch 089:  47000 / 49553 loss=3.842, nll_loss=2.179, ppl=4.53, wps=57270, ups=6, wpb=10099.625, bsz=618.512, num_updates=1.09784e+06, lr=3.01808e-05, gnorm=1.037, clip=0.000, oom=0.000, loss_scale=4.000, wall=26485, train_wall=488878
Invalid bert_input shape:torch.Size([4, 859])
| epoch 089:  48000 / 49553 loss=3.842, nll_loss=2.179, ppl=4.53, wps=57275, ups=6, wpb=10100.261, bsz=618.472, num_updates=1.09884e+06, lr=3.01671e-05, gnorm=1.037, clip=0.000, oom=0.000, loss_scale=4.000, wall=26661, train_wall=489035
Invalid bert_input shape:torch.Size([5, 602])
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 089:  49000 / 49553 loss=3.843, nll_loss=2.179, ppl=4.53, wps=57286, ups=6, wpb=10100.328, bsz=618.664, num_updates=1.09984e+06, lr=3.01534e-05, gnorm=1.037, clip=0.000, oom=0.000, loss_scale=2.000, wall=26836, train_wall=489191
| epoch 089 | loss 3.843 | nll_loss 2.179 | ppl 4.53 | wps 57291 | ups 6 | wpb 10099.914 | bsz 618.683 | num_updates 1.10039e+06 | lr 3.01458e-05 | gnorm 1.037 | clip 0.000 | oom 0.000 | loss_scale 2.000 | wall 26932 | train_wall 489277
| epoch 089 | valid on 'valid' subset | loss 2.758 | nll_loss 0.942 | ppl 1.92 | num_updates 1.10039e+06 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint89.pt (epoch 89 @ 1100388 updates) (writing took 7.112639665603638 seconds)
| epoch 090:   1000 / 49553 loss=3.833, nll_loss=2.169, ppl=4.50, wps=57921, ups=3, wpb=10098.211, bsz=614.177, num_updates=1.10139e+06, lr=3.01321e-05, gnorm=1.044, clip=0.000, oom=0.000, loss_scale=2.000, wall=27241, train_wall=489434
Invalid bert_input shape:torch.Size([4, 790])
| epoch 090:   2000 / 49553 loss=3.836, nll_loss=2.172, ppl=4.51, wps=57669, ups=4, wpb=10091.786, bsz=613.217, num_updates=1.10239e+06, lr=3.01184e-05, gnorm=1.048, clip=0.000, oom=0.000, loss_scale=2.000, wall=27416, train_wall=489591
| epoch 090:   3000 / 49553 loss=3.843, nll_loss=2.180, ppl=4.53, wps=57901, ups=5, wpb=10108.029, bsz=615.315, num_updates=1.10339e+06, lr=3.01048e-05, gnorm=1.049, clip=0.000, oom=0.000, loss_scale=2.000, wall=27590, train_wall=489747
Invalid bert_input shape:torch.Size([4, 776])
| epoch 090:   4000 / 49553 loss=3.844, nll_loss=2.180, ppl=4.53, wps=57891, ups=5, wpb=10105.548, bsz=616.414, num_updates=1.10439e+06, lr=3.00912e-05, gnorm=1.049, clip=0.000, oom=0.000, loss_scale=4.000, wall=27765, train_wall=489903
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 090:   5000 / 49553 loss=3.839, nll_loss=2.176, ppl=4.52, wps=57787, ups=5, wpb=10103.806, bsz=615.920, num_updates=1.10539e+06, lr=3.00776e-05, gnorm=1.046, clip=0.000, oom=0.000, loss_scale=2.000, wall=27940, train_wall=490060
Invalid bert_input shape:torch.Size([4, 760])
| epoch 090:   6000 / 49553 loss=3.839, nll_loss=2.175, ppl=4.52, wps=57845, ups=5, wpb=10105.975, bsz=615.566, num_updates=1.10639e+06, lr=3.0064e-05, gnorm=1.048, clip=0.000, oom=0.000, loss_scale=2.000, wall=28114, train_wall=490216
| epoch 090:   7000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57787, ups=5, wpb=10092.576, bsz=617.560, num_updates=1.10739e+06, lr=3.00504e-05, gnorm=1.049, clip=0.000, oom=0.000, loss_scale=2.000, wall=28289, train_wall=490372
Invalid bert_input shape:torch.Size([6, 589])
| epoch 090:   8000 / 49553 loss=3.842, nll_loss=2.179, ppl=4.53, wps=57729, ups=5, wpb=10102.532, bsz=617.386, num_updates=1.10839e+06, lr=3.00368e-05, gnorm=1.049, clip=0.000, oom=0.000, loss_scale=2.000, wall=28466, train_wall=490531
| epoch 090:   9000 / 49553 loss=3.842, nll_loss=2.178, ppl=4.53, wps=57557, ups=5, wpb=10101.209, bsz=619.385, num_updates=1.10939e+06, lr=3.00233e-05, gnorm=1.049, clip=0.000, oom=0.000, loss_scale=4.000, wall=28646, train_wall=490693
Invalid bert_input shape:torch.Size([2, 1513])
| epoch 090:  10000 / 49553 loss=3.840, nll_loss=2.176, ppl=4.52, wps=57535, ups=5, wpb=10096.512, bsz=618.193, num_updates=1.11039e+06, lr=3.00098e-05, gnorm=1.048, clip=0.000, oom=0.000, loss_scale=4.000, wall=28821, train_wall=490848
Invalid bert_input shape:torch.Size([6, 595])
| epoch 090:  11000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57534, ups=5, wpb=10103.409, bsz=618.312, num_updates=1.11139e+06, lr=2.99963e-05, gnorm=1.048, clip=0.000, oom=0.000, loss_scale=4.000, wall=28998, train_wall=491004
| epoch 090:  12000 / 49553 loss=3.841, nll_loss=2.178, ppl=4.52, wps=57518, ups=5, wpb=10104.585, bsz=618.665, num_updates=1.11239e+06, lr=2.99828e-05, gnorm=1.050, clip=0.000, oom=0.000, loss_scale=4.000, wall=29174, train_wall=491161
Invalid bert_input shape:torch.Size([7, 840])
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 090:  13000 / 49553 loss=3.840, nll_loss=2.176, ppl=4.52, wps=57500, ups=5, wpb=10104.496, bsz=619.392, num_updates=1.11339e+06, lr=2.99693e-05, gnorm=1.050, clip=0.000, oom=0.000, loss_scale=2.000, wall=29351, train_wall=491316
Invalid bert_input shape:torch.Size([3, 944])
| epoch 090:  14000 / 49553 loss=3.840, nll_loss=2.176, ppl=4.52, wps=57526, ups=5, wpb=10105.268, bsz=619.300, num_updates=1.11439e+06, lr=2.99559e-05, gnorm=1.050, clip=0.000, oom=0.000, loss_scale=2.000, wall=29525, train_wall=491472
Invalid bert_input shape:torch.Size([4, 790])
Invalid bert_input shape:torch.Size([5, 703])
| epoch 090:  15000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57487, ups=5, wpb=10101.014, bsz=618.380, num_updates=1.11539e+06, lr=2.99424e-05, gnorm=1.051, clip=0.000, oom=0.000, loss_scale=2.000, wall=29702, train_wall=491630
| epoch 090:  16000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57441, ups=5, wpb=10101.177, bsz=618.554, num_updates=1.11639e+06, lr=2.9929e-05, gnorm=1.051, clip=0.000, oom=0.000, loss_scale=2.000, wall=29880, train_wall=491788
Invalid bert_input shape:torch.Size([6, 566])
| epoch 090:  17000 / 49553 loss=3.841, nll_loss=2.178, ppl=4.52, wps=57437, ups=5, wpb=10096.359, bsz=618.773, num_updates=1.11739e+06, lr=2.99156e-05, gnorm=1.051, clip=0.000, oom=0.000, loss_scale=4.000, wall=30054, train_wall=491943
Invalid bert_input shape:torch.Size([7, 790])
| epoch 090:  18000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57432, ups=5, wpb=10097.366, bsz=618.630, num_updates=1.11839e+06, lr=2.99023e-05, gnorm=1.051, clip=0.000, oom=0.000, loss_scale=4.000, wall=30231, train_wall=492102
| epoch 090:  19000 / 49553 loss=3.840, nll_loss=2.176, ppl=4.52, wps=57406, ups=5, wpb=10095.683, bsz=618.517, num_updates=1.11939e+06, lr=2.98889e-05, gnorm=1.052, clip=0.000, oom=0.000, loss_scale=4.000, wall=30407, train_wall=492259
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 090:  20000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57358, ups=5, wpb=10095.545, bsz=618.185, num_updates=1.12039e+06, lr=2.98756e-05, gnorm=1.053, clip=0.000, oom=0.000, loss_scale=2.000, wall=30586, train_wall=492419
Invalid bert_input shape:torch.Size([6, 878])
| epoch 090:  21000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57298, ups=5, wpb=10094.582, bsz=618.363, num_updates=1.12139e+06, lr=2.98622e-05, gnorm=1.054, clip=0.000, oom=0.000, loss_scale=2.000, wall=30766, train_wall=492579
Invalid bert_input shape:torch.Size([5, 701])
| epoch 090:  22000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57281, ups=5, wpb=10095.748, bsz=618.118, num_updates=1.12239e+06, lr=2.98489e-05, gnorm=1.054, clip=0.000, oom=0.000, loss_scale=2.000, wall=30943, train_wall=492738
| epoch 090:  23000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57291, ups=5, wpb=10096.784, bsz=618.029, num_updates=1.12339e+06, lr=2.98356e-05, gnorm=1.054, clip=0.000, oom=0.000, loss_scale=2.000, wall=31119, train_wall=492895
| epoch 090:  24000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57253, ups=5, wpb=10095.585, bsz=617.821, num_updates=1.12439e+06, lr=2.98224e-05, gnorm=1.054, clip=0.000, oom=0.000, loss_scale=4.000, wall=31298, train_wall=493056
| epoch 090:  25000 / 49553 loss=3.840, nll_loss=2.176, ppl=4.52, wps=57256, ups=6, wpb=10096.173, bsz=617.907, num_updates=1.12539e+06, lr=2.98091e-05, gnorm=1.054, clip=0.000, oom=0.000, loss_scale=4.000, wall=31474, train_wall=493213
| epoch 090:  26000 / 49553 loss=3.840, nll_loss=2.176, ppl=4.52, wps=57247, ups=6, wpb=10098.326, bsz=618.067, num_updates=1.12639e+06, lr=2.97959e-05, gnorm=1.054, clip=0.000, oom=0.000, loss_scale=4.000, wall=31652, train_wall=493373
| epoch 090:  27000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57224, ups=6, wpb=10097.710, bsz=618.113, num_updates=1.12739e+06, lr=2.97827e-05, gnorm=1.054, clip=0.000, oom=0.000, loss_scale=4.000, wall=31830, train_wall=493532
Invalid bert_input shape:torch.Size([6, 784])
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 090:  28000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57229, ups=6, wpb=10097.826, bsz=618.020, num_updates=1.12838e+06, lr=2.97695e-05, gnorm=1.054, clip=0.000, oom=0.000, loss_scale=4.000, wall=32006, train_wall=493688
| epoch 090:  29000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57204, ups=6, wpb=10097.567, bsz=618.129, num_updates=1.12938e+06, lr=2.97563e-05, gnorm=1.054, clip=0.000, oom=0.000, loss_scale=4.000, wall=32185, train_wall=493847
Invalid bert_input shape:torch.Size([3, 1514])
| epoch 090:  30000 / 49553 loss=3.841, nll_loss=2.178, ppl=4.52, wps=57211, ups=6, wpb=10098.265, bsz=617.764, num_updates=1.13038e+06, lr=2.97431e-05, gnorm=1.054, clip=0.000, oom=0.000, loss_scale=4.000, wall=32361, train_wall=494000
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 090:  31000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57216, ups=6, wpb=10097.533, bsz=618.121, num_updates=1.13138e+06, lr=2.973e-05, gnorm=1.055, clip=0.000, oom=0.000, loss_scale=2.000, wall=32536, train_wall=494154
Invalid bert_input shape:torch.Size([4, 823])
| epoch 090:  32000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57221, ups=6, wpb=10097.719, bsz=618.209, num_updates=1.13238e+06, lr=2.97169e-05, gnorm=1.055, clip=0.000, oom=0.000, loss_scale=2.000, wall=32712, train_wall=494311
Invalid bert_input shape:torch.Size([3, 1119])
| epoch 090:  33000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57249, ups=6, wpb=10099.443, bsz=618.288, num_updates=1.13338e+06, lr=2.97038e-05, gnorm=1.055, clip=0.000, oom=0.000, loss_scale=2.000, wall=32887, train_wall=494466
| epoch 090:  34000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57269, ups=6, wpb=10100.397, bsz=618.202, num_updates=1.13438e+06, lr=2.96907e-05, gnorm=1.055, clip=0.000, oom=0.000, loss_scale=2.000, wall=33062, train_wall=494623
| epoch 090:  35000 / 49553 loss=3.840, nll_loss=2.176, ppl=4.52, wps=57266, ups=6, wpb=10098.509, bsz=617.918, num_updates=1.13538e+06, lr=2.96776e-05, gnorm=1.055, clip=0.000, oom=0.000, loss_scale=4.000, wall=33238, train_wall=494780
| epoch 090:  36000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57259, ups=6, wpb=10097.388, bsz=618.122, num_updates=1.13638e+06, lr=2.96645e-05, gnorm=1.055, clip=0.000, oom=0.000, loss_scale=4.000, wall=33414, train_wall=494937
| epoch 090:  37000 / 49553 loss=3.840, nll_loss=2.176, ppl=4.52, wps=57268, ups=6, wpb=10097.370, bsz=618.181, num_updates=1.13738e+06, lr=2.96515e-05, gnorm=1.055, clip=0.000, oom=0.000, loss_scale=4.000, wall=33589, train_wall=495094
| epoch 090:  38000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57271, ups=6, wpb=10096.026, bsz=618.054, num_updates=1.13838e+06, lr=2.96385e-05, gnorm=1.055, clip=0.000, oom=0.000, loss_scale=4.000, wall=33764, train_wall=495251
Invalid bert_input shape:torch.Size([5, 616])
| epoch 090:  39000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57271, ups=6, wpb=10094.385, bsz=618.248, num_updates=1.13938e+06, lr=2.96254e-05, gnorm=1.055, clip=0.000, oom=0.000, loss_scale=8.000, wall=33940, train_wall=495406
| epoch 090:  40000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57277, ups=6, wpb=10095.170, bsz=618.449, num_updates=1.14038e+06, lr=2.96125e-05, gnorm=1.055, clip=0.000, oom=0.000, loss_scale=8.000, wall=34116, train_wall=495563
Invalid bert_input shape:torch.Size([5, 627])
| epoch 090:  41000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57294, ups=6, wpb=10096.546, bsz=618.402, num_updates=1.14138e+06, lr=2.95995e-05, gnorm=1.055, clip=0.000, oom=0.000, loss_scale=8.000, wall=34291, train_wall=495718
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([5, 795])
| epoch 090:  42000 / 49553 loss=3.841, nll_loss=2.178, ppl=4.52, wps=57309, ups=6, wpb=10098.886, bsz=618.399, num_updates=1.14238e+06, lr=2.95865e-05, gnorm=1.056, clip=0.000, oom=0.000, loss_scale=4.000, wall=34467, train_wall=495874
Invalid bert_input shape:torch.Size([4, 843])
| epoch 090:  43000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57312, ups=6, wpb=10098.169, bsz=618.642, num_updates=1.14338e+06, lr=2.95736e-05, gnorm=1.056, clip=0.000, oom=0.000, loss_scale=4.000, wall=34642, train_wall=496030
Invalid bert_input shape:torch.Size([7, 865])
| epoch 090:  44000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57324, ups=6, wpb=10098.316, bsz=618.424, num_updates=1.14438e+06, lr=2.95607e-05, gnorm=1.056, clip=0.000, oom=0.000, loss_scale=4.000, wall=34816, train_wall=496186
Invalid bert_input shape:torch.Size([5, 638])
Invalid bert_input shape:torch.Size([8, 844])
| epoch 090:  45000 / 49553 loss=3.840, nll_loss=2.177, ppl=4.52, wps=57340, ups=6, wpb=10099.022, bsz=618.524, num_updates=1.14538e+06, lr=2.95478e-05, gnorm=1.056, clip=0.000, oom=0.000, loss_scale=4.000, wall=34991, train_wall=496341
| epoch 090:  46000 / 49553 loss=3.841, nll_loss=2.177, ppl=4.52, wps=57344, ups=6, wpb=10099.385, bsz=618.521, num_updates=1.14638e+06, lr=2.95349e-05, gnorm=1.056, clip=0.000, oom=0.000, loss_scale=8.000, wall=35167, train_wall=496498
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 090:  47000 / 49553 loss=3.841, nll_loss=2.178, ppl=4.52, wps=57354, ups=6, wpb=10099.790, bsz=618.502, num_updates=1.14738e+06, lr=2.9522e-05, gnorm=1.056, clip=0.000, oom=0.000, loss_scale=4.000, wall=35342, train_wall=496654
| WARNING: overflow detected, setting loss scale to: 2.0
Invalid bert_input shape:torch.Size([8, 1356])
| epoch 090:  48000 / 49553 loss=3.841, nll_loss=2.178, ppl=4.52, wps=57376, ups=6, wpb=10101.456, bsz=618.349, num_updates=1.14838e+06, lr=2.95092e-05, gnorm=1.056, clip=0.000, oom=0.000, loss_scale=2.000, wall=35516, train_wall=496809
Invalid bert_input shape:torch.Size([5, 1524])
| epoch 090:  49000 / 49553 loss=3.841, nll_loss=2.178, ppl=4.53, wps=57379, ups=6, wpb=10100.629, bsz=618.402, num_updates=1.14938e+06, lr=2.94963e-05, gnorm=1.056, clip=0.000, oom=0.000, loss_scale=2.000, wall=35691, train_wall=496965
| epoch 090 | loss 3.841 | nll_loss 2.178 | ppl 4.53 | wps 57378 | ups 6 | wpb 10099.972 | bsz 618.682 | num_updates 1.14993e+06 | lr 2.94893e-05 | gnorm 1.056 | clip 0.000 | oom 0.000 | loss_scale 2.000 | wall 35787 | train_wall 497051
| epoch 090 | valid on 'valid' subset | loss 2.753 | nll_loss 0.938 | ppl 1.92 | num_updates 1.14993e+06 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint90.pt (epoch 90 @ 1149933 updates) (writing took 7.280216217041016 seconds)
Invalid bert_input shape:torch.Size([4, 720])
Invalid bert_input shape:torch.Size([5, 704])
| epoch 091:   1000 / 49553 loss=3.822, nll_loss=2.156, ppl=4.46, wps=57802, ups=3, wpb=10070.667, bsz=620.235, num_updates=1.15093e+06, lr=2.94764e-05, gnorm=1.057, clip=0.000, oom=0.000, loss_scale=2.000, wall=36094, train_wall=497213
Invalid bert_input shape:torch.Size([6, 575])
| epoch 091:   2000 / 49553 loss=3.818, nll_loss=2.152, ppl=4.44, wps=57377, ups=4, wpb=10027.571, bsz=624.523, num_updates=1.15193e+06, lr=2.94636e-05, gnorm=1.064, clip=0.000, oom=0.000, loss_scale=4.000, wall=36269, train_wall=497368
| epoch 091:   3000 / 49553 loss=3.824, nll_loss=2.158, ppl=4.46, wps=57516, ups=5, wpb=10067.583, bsz=620.124, num_updates=1.15293e+06, lr=2.94508e-05, gnorm=1.063, clip=0.000, oom=0.000, loss_scale=4.000, wall=36445, train_wall=497525
Invalid bert_input shape:torch.Size([4, 859])
| epoch 091:   4000 / 49553 loss=3.826, nll_loss=2.161, ppl=4.47, wps=57613, ups=5, wpb=10082.393, bsz=618.645, num_updates=1.15393e+06, lr=2.94381e-05, gnorm=1.062, clip=0.000, oom=0.000, loss_scale=4.000, wall=36620, train_wall=497681
| epoch 091:   5000 / 49553 loss=3.828, nll_loss=2.163, ppl=4.48, wps=57616, ups=5, wpb=10090.527, bsz=619.403, num_updates=1.15493e+06, lr=2.94253e-05, gnorm=1.061, clip=0.000, oom=0.000, loss_scale=4.000, wall=36796, train_wall=497837
Invalid bert_input shape:torch.Size([5, 602])
| epoch 091:   6000 / 49553 loss=3.827, nll_loss=2.162, ppl=4.48, wps=57604, ups=5, wpb=10092.229, bsz=619.089, num_updates=1.15593e+06, lr=2.94126e-05, gnorm=1.061, clip=0.000, oom=0.000, loss_scale=4.000, wall=36971, train_wall=497993
Invalid bert_input shape:torch.Size([2, 1203])
| epoch 091:   7000 / 49553 loss=3.827, nll_loss=2.162, ppl=4.48, wps=57697, ups=5, wpb=10099.968, bsz=617.764, num_updates=1.15693e+06, lr=2.93999e-05, gnorm=1.061, clip=0.000, oom=0.000, loss_scale=8.000, wall=37145, train_wall=498149
| epoch 091:   8000 / 49553 loss=3.829, nll_loss=2.164, ppl=4.48, wps=57660, ups=5, wpb=10109.977, bsz=617.689, num_updates=1.15793e+06, lr=2.93872e-05, gnorm=1.061, clip=0.000, oom=0.000, loss_scale=8.000, wall=37323, train_wall=498307
| epoch 091:   9000 / 49553 loss=3.829, nll_loss=2.164, ppl=4.48, wps=57542, ups=5, wpb=10111.469, bsz=617.923, num_updates=1.15893e+06, lr=2.93745e-05, gnorm=1.061, clip=0.000, oom=0.000, loss_scale=8.000, wall=37501, train_wall=498467
| epoch 091:  10000 / 49553 loss=3.831, nll_loss=2.167, ppl=4.49, wps=57532, ups=5, wpb=10108.158, bsz=618.246, num_updates=1.15993e+06, lr=2.93618e-05, gnorm=1.061, clip=0.000, oom=0.000, loss_scale=8.000, wall=37677, train_wall=498623
| WARNING: overflow detected, setting loss scale to: 8.0
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 091:  11000 / 49553 loss=3.831, nll_loss=2.166, ppl=4.49, wps=57499, ups=5, wpb=10102.167, bsz=618.019, num_updates=1.16093e+06, lr=2.93492e-05, gnorm=1.061, clip=0.000, oom=0.000, loss_scale=4.000, wall=37852, train_wall=498780
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 091:  12000 / 49553 loss=3.829, nll_loss=2.165, ppl=4.48, wps=57512, ups=5, wpb=10105.415, bsz=618.904, num_updates=1.16193e+06, lr=2.93366e-05, gnorm=1.062, clip=0.000, oom=0.000, loss_scale=2.000, wall=38028, train_wall=498936
| epoch 091:  13000 / 49553 loss=3.830, nll_loss=2.166, ppl=4.49, wps=57491, ups=5, wpb=10097.865, bsz=619.492, num_updates=1.16293e+06, lr=2.9324e-05, gnorm=1.063, clip=0.000, oom=0.000, loss_scale=2.000, wall=38203, train_wall=499091
| epoch 091:  14000 / 49553 loss=3.832, nll_loss=2.167, ppl=4.49, wps=57499, ups=5, wpb=10103.440, bsz=618.686, num_updates=1.16393e+06, lr=2.93114e-05, gnorm=1.063, clip=0.000, oom=0.000, loss_scale=2.000, wall=38379, train_wall=499249
| epoch 091:  15000 / 49553 loss=3.832, nll_loss=2.168, ppl=4.49, wps=57521, ups=5, wpb=10105.328, bsz=619.297, num_updates=1.16493e+06, lr=2.92988e-05, gnorm=1.063, clip=0.000, oom=0.000, loss_scale=2.000, wall=38555, train_wall=499405
Invalid bert_input shape:torch.Size([6, 878])
Invalid bert_input shape:torch.Size([6, 863])
Invalid bert_input shape:torch.Size([4, 790])
Invalid bert_input shape:torch.Size([3, 1160])
| epoch 091:  16000 / 49553 loss=3.831, nll_loss=2.167, ppl=4.49, wps=57525, ups=5, wpb=10102.688, bsz=619.391, num_updates=1.16593e+06, lr=2.92862e-05, gnorm=1.064, clip=0.000, oom=0.000, loss_scale=4.000, wall=38729, train_wall=499562
| epoch 091:  17000 / 49553 loss=3.833, nll_loss=2.169, ppl=4.50, wps=57522, ups=5, wpb=10102.935, bsz=619.419, num_updates=1.16693e+06, lr=2.92737e-05, gnorm=1.064, clip=0.000, oom=0.000, loss_scale=4.000, wall=38905, train_wall=499718
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 091:  18000 / 49553 loss=3.832, nll_loss=2.168, ppl=4.49, wps=57527, ups=5, wpb=10104.963, bsz=619.237, num_updates=1.16793e+06, lr=2.92612e-05, gnorm=1.064, clip=0.000, oom=0.000, loss_scale=2.000, wall=39081, train_wall=499875
| epoch 091:  19000 / 49553 loss=3.833, nll_loss=2.168, ppl=4.50, wps=57511, ups=5, wpb=10107.347, bsz=619.203, num_updates=1.16893e+06, lr=2.92486e-05, gnorm=1.064, clip=0.000, oom=0.000, loss_scale=2.000, wall=39258, train_wall=500034
Invalid bert_input shape:torch.Size([4, 823])
| epoch 091:  20000 / 49553 loss=3.833, nll_loss=2.169, ppl=4.50, wps=57437, ups=5, wpb=10104.605, bsz=618.496, num_updates=1.16993e+06, lr=2.92361e-05, gnorm=1.065, clip=0.000, oom=0.000, loss_scale=2.000, wall=39438, train_wall=500194
| epoch 091:  21000 / 49553 loss=3.834, nll_loss=2.170, ppl=4.50, wps=57453, ups=5, wpb=10106.342, bsz=618.787, num_updates=1.17093e+06, lr=2.92237e-05, gnorm=1.065, clip=0.000, oom=0.000, loss_scale=2.000, wall=39613, train_wall=500351
| epoch 091:  22000 / 49553 loss=3.834, nll_loss=2.170, ppl=4.50, wps=57473, ups=5, wpb=10106.682, bsz=618.615, num_updates=1.17193e+06, lr=2.92112e-05, gnorm=1.066, clip=0.000, oom=0.000, loss_scale=4.000, wall=39788, train_wall=500506
| epoch 091:  23000 / 49553 loss=3.835, nll_loss=2.171, ppl=4.50, wps=57501, ups=6, wpb=10111.695, bsz=618.024, num_updates=1.17293e+06, lr=2.91987e-05, gnorm=1.066, clip=0.000, oom=0.000, loss_scale=4.000, wall=39964, train_wall=500665
Invalid bert_input shape:torch.Size([4, 776])
| epoch 091:  24000 / 49553 loss=3.835, nll_loss=2.171, ppl=4.50, wps=57504, ups=6, wpb=10112.001, bsz=618.008, num_updates=1.17393e+06, lr=2.91863e-05, gnorm=1.066, clip=0.000, oom=0.000, loss_scale=4.000, wall=40140, train_wall=500822
| epoch 091:  25000 / 49553 loss=3.835, nll_loss=2.171, ppl=4.50, wps=57475, ups=6, wpb=10113.848, bsz=618.391, num_updates=1.17493e+06, lr=2.91739e-05, gnorm=1.066, clip=0.000, oom=0.000, loss_scale=4.000, wall=40318, train_wall=500978
| epoch 091:  26000 / 49553 loss=3.835, nll_loss=2.171, ppl=4.50, wps=57407, ups=6, wpb=10112.217, bsz=618.702, num_updates=1.17593e+06, lr=2.91615e-05, gnorm=1.067, clip=0.000, oom=0.000, loss_scale=8.000, wall=40499, train_wall=501139
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([4, 790])
| epoch 091:  27000 / 49553 loss=3.836, nll_loss=2.172, ppl=4.51, wps=57350, ups=6, wpb=10111.617, bsz=618.894, num_updates=1.17693e+06, lr=2.91491e-05, gnorm=1.067, clip=0.000, oom=0.000, loss_scale=4.000, wall=40680, train_wall=501300
Invalid bert_input shape:torch.Size([3, 1119])
| epoch 091:  28000 / 49553 loss=3.837, nll_loss=2.173, ppl=4.51, wps=57325, ups=6, wpb=10111.023, bsz=618.777, num_updates=1.17793e+06, lr=2.91367e-05, gnorm=1.067, clip=0.000, oom=0.000, loss_scale=4.000, wall=40858, train_wall=501459
Invalid bert_input shape:torch.Size([7, 790])
| epoch 091:  29000 / 49553 loss=3.836, nll_loss=2.173, ppl=4.51, wps=57317, ups=6, wpb=10110.586, bsz=618.319, num_updates=1.17893e+06, lr=2.91243e-05, gnorm=1.068, clip=0.000, oom=0.000, loss_scale=4.000, wall=41035, train_wall=501618
| WARNING: overflow detected, setting loss scale to: 2.0
Invalid bert_input shape:torch.Size([5, 636])
| epoch 091:  30000 / 49553 loss=3.836, nll_loss=2.173, ppl=4.51, wps=57315, ups=6, wpb=10107.551, bsz=618.167, num_updates=1.17993e+06, lr=2.9112e-05, gnorm=1.068, clip=0.000, oom=0.000, loss_scale=2.000, wall=41209, train_wall=501773
| epoch 091:  31000 / 49553 loss=3.837, nll_loss=2.173, ppl=4.51, wps=57326, ups=6, wpb=10106.834, bsz=618.337, num_updates=1.18093e+06, lr=2.90997e-05, gnorm=1.068, clip=0.000, oom=0.000, loss_scale=2.000, wall=41384, train_wall=501927
Invalid bert_input shape:torch.Size([6, 555])
| epoch 091:  32000 / 49553 loss=3.837, nll_loss=2.173, ppl=4.51, wps=57335, ups=6, wpb=10106.529, bsz=618.136, num_updates=1.18193e+06, lr=2.90874e-05, gnorm=1.069, clip=0.000, oom=0.000, loss_scale=2.000, wall=41560, train_wall=502084
| epoch 091:  33000 / 49553 loss=3.837, nll_loss=2.173, ppl=4.51, wps=57307, ups=6, wpb=10104.038, bsz=618.118, num_updates=1.18293e+06, lr=2.90751e-05, gnorm=1.069, clip=0.000, oom=0.000, loss_scale=2.000, wall=41737, train_wall=502243
| epoch 091:  34000 / 49553 loss=3.837, nll_loss=2.173, ppl=4.51, wps=57293, ups=6, wpb=10102.645, bsz=617.580, num_updates=1.18393e+06, lr=2.90628e-05, gnorm=1.069, clip=0.000, oom=0.000, loss_scale=4.000, wall=41914, train_wall=502402
| epoch 091:  35000 / 49553 loss=3.837, nll_loss=2.173, ppl=4.51, wps=57290, ups=6, wpb=10101.053, bsz=617.509, num_updates=1.18493e+06, lr=2.90505e-05, gnorm=1.070, clip=0.000, oom=0.000, loss_scale=4.000, wall=42090, train_wall=502559
| epoch 091:  36000 / 49553 loss=3.837, nll_loss=2.174, ppl=4.51, wps=57320, ups=6, wpb=10104.645, bsz=617.432, num_updates=1.18593e+06, lr=2.90383e-05, gnorm=1.070, clip=0.000, oom=0.000, loss_scale=4.000, wall=42265, train_wall=502714
| epoch 091:  37000 / 49553 loss=3.838, nll_loss=2.174, ppl=4.51, wps=57332, ups=6, wpb=10104.775, bsz=617.520, num_updates=1.18693e+06, lr=2.9026e-05, gnorm=1.070, clip=0.000, oom=0.000, loss_scale=4.000, wall=42440, train_wall=502871
Invalid bert_input shape:torch.Size([4, 837])
Invalid bert_input shape:torch.Size([5, 666])
| epoch 091:  38000 / 49553 loss=3.838, nll_loss=2.175, ppl=4.52, wps=57334, ups=6, wpb=10103.006, bsz=617.596, num_updates=1.18793e+06, lr=2.90138e-05, gnorm=1.070, clip=0.000, oom=0.000, loss_scale=8.000, wall=42615, train_wall=503026
Invalid bert_input shape:torch.Size([4, 831])
| epoch 091:  39000 / 49553 loss=3.838, nll_loss=2.175, ppl=4.51, wps=57342, ups=6, wpb=10102.176, bsz=617.744, num_updates=1.18893e+06, lr=2.90016e-05, gnorm=1.070, clip=0.000, oom=0.000, loss_scale=8.000, wall=42790, train_wall=503182
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 091:  40000 / 49553 loss=3.838, nll_loss=2.175, ppl=4.52, wps=57344, ups=6, wpb=10102.559, bsz=617.911, num_updates=1.18993e+06, lr=2.89894e-05, gnorm=1.071, clip=0.000, oom=0.000, loss_scale=4.000, wall=42966, train_wall=503338
| epoch 091:  41000 / 49553 loss=3.838, nll_loss=2.175, ppl=4.52, wps=57319, ups=6, wpb=10102.108, bsz=618.163, num_updates=1.19093e+06, lr=2.89773e-05, gnorm=1.071, clip=0.000, oom=0.000, loss_scale=4.000, wall=43145, train_wall=503491
| WARNING: overflow detected, setting loss scale to: 2.0
Invalid bert_input shape:torch.Size([5, 869])
Invalid bert_input shape:torch.Size([6, 896])
| epoch 091:  42000 / 49553 loss=3.838, nll_loss=2.175, ppl=4.52, wps=57297, ups=6, wpb=10101.347, bsz=618.162, num_updates=1.19193e+06, lr=2.89651e-05, gnorm=1.071, clip=0.000, oom=0.000, loss_scale=2.000, wall=43323, train_wall=503642
| epoch 091:  43000 / 49553 loss=3.839, nll_loss=2.176, ppl=4.52, wps=57273, ups=6, wpb=10101.765, bsz=618.082, num_updates=1.19293e+06, lr=2.8953e-05, gnorm=1.071, clip=0.000, oom=0.000, loss_scale=2.000, wall=43503, train_wall=503795
Invalid bert_input shape:torch.Size([6, 528])
| epoch 091:  44000 / 49553 loss=3.839, nll_loss=2.176, ppl=4.52, wps=57268, ups=6, wpb=10101.602, bsz=618.496, num_updates=1.19393e+06, lr=2.89409e-05, gnorm=1.071, clip=0.000, oom=0.000, loss_scale=2.000, wall=43680, train_wall=503948
| epoch 091:  45000 / 49553 loss=3.839, nll_loss=2.175, ppl=4.52, wps=57280, ups=6, wpb=10101.226, bsz=618.346, num_updates=1.19493e+06, lr=2.89287e-05, gnorm=1.071, clip=0.000, oom=0.000, loss_scale=2.000, wall=43854, train_wall=504104
Invalid bert_input shape:torch.Size([6, 550])
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 091:  46000 / 49553 loss=3.838, nll_loss=2.175, ppl=4.52, wps=57272, ups=6, wpb=10100.708, bsz=618.455, num_updates=1.19592e+06, lr=2.89167e-05, gnorm=1.071, clip=0.000, oom=0.000, loss_scale=2.000, wall=44031, train_wall=504262
Invalid bert_input shape:torch.Size([8, 1356])
| epoch 091:  47000 / 49553 loss=3.839, nll_loss=2.175, ppl=4.52, wps=57277, ups=6, wpb=10100.392, bsz=618.708, num_updates=1.19692e+06, lr=2.89046e-05, gnorm=1.071, clip=0.000, oom=0.000, loss_scale=2.000, wall=44206, train_wall=504419
| epoch 091:  48000 / 49553 loss=3.839, nll_loss=2.176, ppl=4.52, wps=57283, ups=6, wpb=10098.809, bsz=618.563, num_updates=1.19792e+06, lr=2.88925e-05, gnorm=1.072, clip=0.000, oom=0.000, loss_scale=2.000, wall=44381, train_wall=504574
Invalid bert_input shape:torch.Size([5, 644])
| epoch 091:  49000 / 49553 loss=3.839, nll_loss=2.176, ppl=4.52, wps=57285, ups=6, wpb=10099.357, bsz=618.599, num_updates=1.19892e+06, lr=2.88805e-05, gnorm=1.072, clip=0.000, oom=0.000, loss_scale=2.000, wall=44557, train_wall=504732
| epoch 091 | loss 3.840 | nll_loss 2.177 | ppl 4.52 | wps 57296 | ups 6 | wpb 10100.012 | bsz 618.660 | num_updates 1.19948e+06 | lr 2.88738e-05 | gnorm 1.072 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 44653 | train_wall 504818
| epoch 091 | valid on 'valid' subset | loss 2.750 | nll_loss 0.936 | ppl 1.91 | num_updates 1.19948e+06 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint91.pt (epoch 91 @ 1199477 updates) (writing took 9.15912675857544 seconds)
Invalid bert_input shape:torch.Size([3, 1160])
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 092:   1000 / 49553 loss=3.828, nll_loss=2.164, ppl=4.48, wps=57577, ups=3, wpb=10116.453, bsz=621.575, num_updates=1.20048e+06, lr=2.88618e-05, gnorm=1.076, clip=0.000, oom=0.000, loss_scale=2.000, wall=44967, train_wall=504982
| epoch 092:   2000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57781, ups=4, wpb=10122.602, bsz=619.999, num_updates=1.20148e+06, lr=2.88498e-05, gnorm=1.076, clip=0.000, oom=0.000, loss_scale=2.000, wall=45141, train_wall=505137
| epoch 092:   3000 / 49553 loss=3.834, nll_loss=2.170, ppl=4.50, wps=57718, ups=5, wpb=10116.546, bsz=620.564, num_updates=1.20248e+06, lr=2.88378e-05, gnorm=1.078, clip=0.000, oom=0.000, loss_scale=2.000, wall=45317, train_wall=505294
| epoch 092:   4000 / 49553 loss=3.833, nll_loss=2.169, ppl=4.50, wps=57813, ups=5, wpb=10130.580, bsz=619.935, num_updates=1.20348e+06, lr=2.88258e-05, gnorm=1.080, clip=0.000, oom=0.000, loss_scale=2.000, wall=45492, train_wall=505451
| epoch 092:   5000 / 49553 loss=3.834, nll_loss=2.170, ppl=4.50, wps=57672, ups=5, wpb=10108.886, bsz=619.331, num_updates=1.20448e+06, lr=2.88138e-05, gnorm=1.082, clip=0.000, oom=0.000, loss_scale=4.000, wall=45667, train_wall=505608
Invalid bert_input shape:torch.Size([5, 1524])
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 092:   6000 / 49553 loss=3.832, nll_loss=2.168, ppl=4.49, wps=57707, ups=5, wpb=10111.585, bsz=620.228, num_updates=1.20548e+06, lr=2.88019e-05, gnorm=1.080, clip=0.000, oom=0.000, loss_scale=2.000, wall=45842, train_wall=505764
| epoch 092:   7000 / 49553 loss=3.835, nll_loss=2.172, ppl=4.51, wps=57705, ups=5, wpb=10108.918, bsz=619.669, num_updates=1.20648e+06, lr=2.87899e-05, gnorm=1.080, clip=0.000, oom=0.000, loss_scale=2.000, wall=46017, train_wall=505920
Invalid bert_input shape:torch.Size([8, 1356])
| epoch 092:   8000 / 49553 loss=3.837, nll_loss=2.173, ppl=4.51, wps=57625, ups=5, wpb=10111.414, bsz=620.367, num_updates=1.20748e+06, lr=2.8778e-05, gnorm=1.081, clip=0.000, oom=0.000, loss_scale=2.000, wall=46195, train_wall=506078
| epoch 092:   9000 / 49553 loss=3.837, nll_loss=2.173, ppl=4.51, wps=57620, ups=5, wpb=10115.943, bsz=621.305, num_updates=1.20848e+06, lr=2.87661e-05, gnorm=1.081, clip=0.000, oom=0.000, loss_scale=2.000, wall=46371, train_wall=506235
| epoch 092:  10000 / 49553 loss=3.838, nll_loss=2.175, ppl=4.52, wps=57666, ups=5, wpb=10123.100, bsz=620.671, num_updates=1.20948e+06, lr=2.87542e-05, gnorm=1.081, clip=0.000, oom=0.000, loss_scale=4.000, wall=46546, train_wall=506392
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 092:  11000 / 49553 loss=3.835, nll_loss=2.171, ppl=4.50, wps=57646, ups=5, wpb=10127.829, bsz=619.465, num_updates=1.21048e+06, lr=2.87423e-05, gnorm=1.079, clip=0.000, oom=0.000, loss_scale=2.000, wall=46723, train_wall=506550
Invalid bert_input shape:torch.Size([3, 1119])
| epoch 092:  12000 / 49553 loss=3.835, nll_loss=2.171, ppl=4.50, wps=57527, ups=5, wpb=10125.794, bsz=619.429, num_updates=1.21148e+06, lr=2.87305e-05, gnorm=1.079, clip=0.000, oom=0.000, loss_scale=2.000, wall=46903, train_wall=506711
Invalid bert_input shape:torch.Size([5, 602])
| epoch 092:  13000 / 49553 loss=3.834, nll_loss=2.170, ppl=4.50, wps=57465, ups=5, wpb=10120.349, bsz=619.255, num_updates=1.21248e+06, lr=2.87186e-05, gnorm=1.081, clip=0.000, oom=0.000, loss_scale=2.000, wall=47080, train_wall=506869
Invalid bert_input shape:torch.Size([7, 865])
| epoch 092:  14000 / 49553 loss=3.835, nll_loss=2.171, ppl=4.50, wps=57467, ups=5, wpb=10117.876, bsz=619.220, num_updates=1.21348e+06, lr=2.87068e-05, gnorm=1.081, clip=0.000, oom=0.000, loss_scale=2.000, wall=47255, train_wall=507026
Invalid bert_input shape:torch.Size([3, 944])
| epoch 092:  15000 / 49553 loss=3.835, nll_loss=2.171, ppl=4.50, wps=57494, ups=5, wpb=10120.690, bsz=619.125, num_updates=1.21448e+06, lr=2.8695e-05, gnorm=1.082, clip=0.000, oom=0.000, loss_scale=4.000, wall=47431, train_wall=507183
Invalid bert_input shape:torch.Size([6, 863])
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 092:  16000 / 49553 loss=3.836, nll_loss=2.173, ppl=4.51, wps=57465, ups=5, wpb=10124.650, bsz=619.341, num_updates=1.21547e+06, lr=2.86832e-05, gnorm=1.082, clip=0.000, oom=0.000, loss_scale=2.000, wall=47609, train_wall=507343
| epoch 092:  17000 / 49553 loss=3.836, nll_loss=2.173, ppl=4.51, wps=57403, ups=5, wpb=10121.138, bsz=619.359, num_updates=1.21647e+06, lr=2.86714e-05, gnorm=1.082, clip=0.000, oom=0.000, loss_scale=2.000, wall=47788, train_wall=507502
| epoch 092:  18000 / 49553 loss=3.836, nll_loss=2.173, ppl=4.51, wps=57390, ups=5, wpb=10119.451, bsz=619.105, num_updates=1.21747e+06, lr=2.86596e-05, gnorm=1.083, clip=0.000, oom=0.000, loss_scale=2.000, wall=47964, train_wall=507660
Invalid bert_input shape:torch.Size([5, 656])
| epoch 092:  19000 / 49553 loss=3.837, nll_loss=2.173, ppl=4.51, wps=57420, ups=5, wpb=10118.591, bsz=619.225, num_updates=1.21847e+06, lr=2.86478e-05, gnorm=1.083, clip=0.000, oom=0.000, loss_scale=2.000, wall=48139, train_wall=507815
Invalid bert_input shape:torch.Size([5, 795])
| epoch 092:  20000 / 49553 loss=3.837, nll_loss=2.173, ppl=4.51, wps=57383, ups=5, wpb=10120.243, bsz=619.214, num_updates=1.21947e+06, lr=2.86361e-05, gnorm=1.083, clip=0.000, oom=0.000, loss_scale=4.000, wall=48318, train_wall=507976
Invalid bert_input shape:torch.Size([5, 638])
| epoch 092:  21000 / 49553 loss=3.838, nll_loss=2.175, ppl=4.51, wps=57359, ups=5, wpb=10117.066, bsz=618.639, num_updates=1.22047e+06, lr=2.86244e-05, gnorm=1.083, clip=0.000, oom=0.000, loss_scale=4.000, wall=48494, train_wall=508135
| epoch 092:  22000 / 49553 loss=3.838, nll_loss=2.175, ppl=4.51, wps=57379, ups=5, wpb=10116.164, bsz=618.809, num_updates=1.22147e+06, lr=2.86126e-05, gnorm=1.084, clip=0.000, oom=0.000, loss_scale=4.000, wall=48669, train_wall=508290
| epoch 092:  23000 / 49553 loss=3.838, nll_loss=2.175, ppl=4.52, wps=57387, ups=5, wpb=10117.716, bsz=618.757, num_updates=1.22247e+06, lr=2.86009e-05, gnorm=1.084, clip=0.000, oom=0.000, loss_scale=4.000, wall=48845, train_wall=508448
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 092:  24000 / 49553 loss=3.837, nll_loss=2.174, ppl=4.51, wps=57405, ups=5, wpb=10117.570, bsz=618.671, num_updates=1.22347e+06, lr=2.85893e-05, gnorm=1.084, clip=0.000, oom=0.000, loss_scale=2.000, wall=49020, train_wall=508604
| epoch 092:  25000 / 49553 loss=3.838, nll_loss=2.174, ppl=4.51, wps=57421, ups=6, wpb=10115.663, bsz=618.463, num_updates=1.22447e+06, lr=2.85776e-05, gnorm=1.084, clip=0.000, oom=0.000, loss_scale=2.000, wall=49194, train_wall=508759
Invalid bert_input shape:torch.Size([4, 837])
| epoch 092:  26000 / 49553 loss=3.837, nll_loss=2.174, ppl=4.51, wps=57406, ups=6, wpb=10112.456, bsz=618.516, num_updates=1.22547e+06, lr=2.85659e-05, gnorm=1.085, clip=0.000, oom=0.000, loss_scale=2.000, wall=49370, train_wall=508917
| epoch 092:  27000 / 49553 loss=3.837, nll_loss=2.174, ppl=4.51, wps=57420, ups=6, wpb=10111.781, bsz=619.171, num_updates=1.22647e+06, lr=2.85543e-05, gnorm=1.086, clip=0.000, oom=0.000, loss_scale=2.000, wall=49545, train_wall=509072
| epoch 092:  28000 / 49553 loss=3.837, nll_loss=2.173, ppl=4.51, wps=57436, ups=6, wpb=10111.255, bsz=619.159, num_updates=1.22747e+06, lr=2.85426e-05, gnorm=1.085, clip=0.000, oom=0.000, loss_scale=4.000, wall=49719, train_wall=509228
| epoch 092:  29000 / 49553 loss=3.836, nll_loss=2.173, ppl=4.51, wps=57411, ups=6, wpb=10110.268, bsz=618.878, num_updates=1.22847e+06, lr=2.8531e-05, gnorm=1.086, clip=0.000, oom=0.000, loss_scale=4.000, wall=49897, train_wall=509385
| epoch 092:  30000 / 49553 loss=3.836, nll_loss=2.173, ppl=4.51, wps=57366, ups=6, wpb=10107.519, bsz=618.950, num_updates=1.22947e+06, lr=2.85194e-05, gnorm=1.086, clip=0.000, oom=0.000, loss_scale=4.000, wall=50076, train_wall=509542
Invalid bert_input shape:torch.Size([5, 994])
Invalid bert_input shape:torch.Size([4, 832])
| epoch 092:  31000 / 49553 loss=3.837, nll_loss=2.173, ppl=4.51, wps=57368, ups=6, wpb=10108.928, bsz=618.683, num_updates=1.23047e+06, lr=2.85078e-05, gnorm=1.086, clip=0.000, oom=0.000, loss_scale=4.000, wall=50253, train_wall=509699
| epoch 092:  32000 / 49553 loss=3.837, nll_loss=2.174, ppl=4.51, wps=57337, ups=6, wpb=10109.297, bsz=618.463, num_updates=1.23147e+06, lr=2.84962e-05, gnorm=1.086, clip=0.000, oom=0.000, loss_scale=8.000, wall=50432, train_wall=509852
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 092:  33000 / 49553 loss=3.837, nll_loss=2.174, ppl=4.51, wps=57340, ups=6, wpb=10108.751, bsz=618.353, num_updates=1.23247e+06, lr=2.84847e-05, gnorm=1.087, clip=0.000, oom=0.000, loss_scale=4.000, wall=50608, train_wall=510008
Invalid bert_input shape:torch.Size([6, 528])
Invalid bert_input shape:torch.Size([4, 1167])
| epoch 092:  34000 / 49553 loss=3.837, nll_loss=2.174, ppl=4.51, wps=57317, ups=6, wpb=10107.740, bsz=618.806, num_updates=1.23347e+06, lr=2.84731e-05, gnorm=1.087, clip=0.000, oom=0.000, loss_scale=4.000, wall=50786, train_wall=510168
Invalid bert_input shape:torch.Size([6, 878])
| epoch 092:  35000 / 49553 loss=3.837, nll_loss=2.173, ppl=4.51, wps=57309, ups=6, wpb=10105.723, bsz=619.218, num_updates=1.23447e+06, lr=2.84616e-05, gnorm=1.087, clip=0.000, oom=0.000, loss_scale=4.000, wall=50962, train_wall=510325
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 092:  36000 / 49553 loss=3.836, nll_loss=2.173, ppl=4.51, wps=57313, ups=6, wpb=10105.978, bsz=619.085, num_updates=1.23547e+06, lr=2.84501e-05, gnorm=1.087, clip=0.000, oom=0.000, loss_scale=2.000, wall=51138, train_wall=510481
| epoch 092:  37000 / 49553 loss=3.836, nll_loss=2.173, ppl=4.51, wps=57316, ups=6, wpb=10105.014, bsz=618.934, num_updates=1.23647e+06, lr=2.84386e-05, gnorm=1.087, clip=0.000, oom=0.000, loss_scale=2.000, wall=51313, train_wall=510638
| epoch 092:  38000 / 49553 loss=3.837, nll_loss=2.174, ppl=4.51, wps=57283, ups=6, wpb=10104.151, bsz=618.887, num_updates=1.23747e+06, lr=2.84271e-05, gnorm=1.087, clip=0.000, oom=0.000, loss_scale=2.000, wall=51493, train_wall=510799
| epoch 092:  39000 / 49553 loss=3.836, nll_loss=2.173, ppl=4.51, wps=57281, ups=6, wpb=10103.282, bsz=619.074, num_updates=1.23847e+06, lr=2.84156e-05, gnorm=1.088, clip=0.000, oom=0.000, loss_scale=2.000, wall=51669, train_wall=510954
| epoch 092:  40000 / 49553 loss=3.836, nll_loss=2.173, ppl=4.51, wps=57289, ups=6, wpb=10102.429, bsz=618.701, num_updates=1.23947e+06, lr=2.84042e-05, gnorm=1.088, clip=0.000, oom=0.000, loss_scale=4.000, wall=51844, train_wall=511111
| epoch 092:  41000 / 49553 loss=3.836, nll_loss=2.173, ppl=4.51, wps=57296, ups=6, wpb=10103.343, bsz=618.747, num_updates=1.24047e+06, lr=2.83927e-05, gnorm=1.088, clip=0.000, oom=0.000, loss_scale=4.000, wall=52020, train_wall=511267
Invalid bert_input shape:torch.Size([4, 721])
| epoch 092:  42000 / 49553 loss=3.837, nll_loss=2.174, ppl=4.51, wps=57309, ups=6, wpb=10102.471, bsz=618.808, num_updates=1.24147e+06, lr=2.83813e-05, gnorm=1.088, clip=0.000, oom=0.000, loss_scale=4.000, wall=52194, train_wall=511422
| epoch 092:  43000 / 49553 loss=3.837, nll_loss=2.174, ppl=4.51, wps=57317, ups=6, wpb=10101.801, bsz=618.889, num_updates=1.24247e+06, lr=2.83698e-05, gnorm=1.088, clip=0.000, oom=0.000, loss_scale=4.000, wall=52368, train_wall=511578
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 092:  44000 / 49553 loss=3.837, nll_loss=2.174, ppl=4.51, wps=57283, ups=6, wpb=10101.094, bsz=618.870, num_updates=1.24347e+06, lr=2.83584e-05, gnorm=1.089, clip=0.000, oom=0.000, loss_scale=2.000, wall=52548, train_wall=511738
Invalid bert_input shape:torch.Size([7, 840])
| epoch 092:  45000 / 49553 loss=3.837, nll_loss=2.174, ppl=4.51, wps=57275, ups=6, wpb=10101.942, bsz=619.002, num_updates=1.24447e+06, lr=2.8347e-05, gnorm=1.089, clip=0.000, oom=0.000, loss_scale=2.000, wall=52727, train_wall=511896
Invalid bert_input shape:torch.Size([6, 555])
Invalid bert_input shape:torch.Size([2, 1562])
| epoch 092:  46000 / 49553 loss=3.837, nll_loss=2.174, ppl=4.51, wps=57265, ups=6, wpb=10100.712, bsz=618.802, num_updates=1.24547e+06, lr=2.83357e-05, gnorm=1.089, clip=0.000, oom=0.000, loss_scale=2.000, wall=52903, train_wall=512054
| epoch 092:  47000 / 49553 loss=3.837, nll_loss=2.174, ppl=4.51, wps=57271, ups=6, wpb=10101.355, bsz=618.865, num_updates=1.24647e+06, lr=2.83243e-05, gnorm=1.089, clip=0.000, oom=0.000, loss_scale=2.000, wall=53079, train_wall=512211
| epoch 092:  48000 / 49553 loss=3.837, nll_loss=2.174, ppl=4.51, wps=57283, ups=6, wpb=10100.687, bsz=618.763, num_updates=1.24747e+06, lr=2.83129e-05, gnorm=1.089, clip=0.000, oom=0.000, loss_scale=4.000, wall=53254, train_wall=512366
Invalid bert_input shape:torch.Size([3, 1184])
| epoch 092:  49000 / 49553 loss=3.837, nll_loss=2.174, ppl=4.51, wps=57281, ups=6, wpb=10099.472, bsz=618.887, num_updates=1.24847e+06, lr=2.83016e-05, gnorm=1.089, clip=0.000, oom=0.000, loss_scale=4.000, wall=53429, train_wall=512522
| epoch 092 | loss 3.837 | nll_loss 2.174 | ppl 4.51 | wps 57285 | ups 6 | wpb 10099.921 | bsz 618.709 | num_updates 1.24902e+06 | lr 2.82953e-05 | gnorm 1.090 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 53526 | train_wall 512609
| epoch 092 | valid on 'valid' subset | loss 2.751 | nll_loss 0.933 | ppl 1.91 | num_updates 1.24902e+06 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint92.pt (epoch 92 @ 1249022 updates) (writing took 20.79608964920044 seconds)
| epoch 093:   1000 / 49553 loss=3.824, nll_loss=2.159, ppl=4.47, wps=57211, ups=3, wpb=10145.491, bsz=619.571, num_updates=1.25002e+06, lr=2.8284e-05, gnorm=1.085, clip=0.000, oom=0.000, loss_scale=4.000, wall=53841, train_wall=512768
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 093:   2000 / 49553 loss=3.819, nll_loss=2.154, ppl=4.45, wps=56880, ups=4, wpb=10151.029, bsz=617.768, num_updates=1.25102e+06, lr=2.82727e-05, gnorm=1.087, clip=0.000, oom=0.000, loss_scale=2.000, wall=54021, train_wall=512928
Invalid bert_input shape:torch.Size([3, 1514])
| epoch 093:   3000 / 49553 loss=3.823, nll_loss=2.158, ppl=4.46, wps=56662, ups=4, wpb=10120.484, bsz=619.893, num_updates=1.25202e+06, lr=2.82614e-05, gnorm=1.093, clip=0.000, oom=0.000, loss_scale=2.000, wall=54200, train_wall=513083
| epoch 093:   4000 / 49553 loss=3.827, nll_loss=2.162, ppl=4.48, wps=56831, ups=5, wpb=10135.160, bsz=621.270, num_updates=1.25302e+06, lr=2.82501e-05, gnorm=1.095, clip=0.000, oom=0.000, loss_scale=2.000, wall=54377, train_wall=513242
| epoch 093:   5000 / 49553 loss=3.830, nll_loss=2.166, ppl=4.49, wps=56965, ups=5, wpb=10131.693, bsz=620.053, num_updates=1.25402e+06, lr=2.82389e-05, gnorm=1.095, clip=0.000, oom=0.000, loss_scale=2.000, wall=54553, train_wall=513399
| epoch 093:   6000 / 49553 loss=3.830, nll_loss=2.165, ppl=4.49, wps=57014, ups=5, wpb=10117.231, bsz=620.133, num_updates=1.25502e+06, lr=2.82276e-05, gnorm=1.096, clip=0.000, oom=0.000, loss_scale=4.000, wall=54728, train_wall=513555
Invalid bert_input shape:torch.Size([5, 656])
| epoch 093:   7000 / 49553 loss=3.827, nll_loss=2.163, ppl=4.48, wps=57080, ups=5, wpb=10104.296, bsz=620.337, num_updates=1.25602e+06, lr=2.82164e-05, gnorm=1.096, clip=0.000, oom=0.000, loss_scale=4.000, wall=54903, train_wall=513711
| epoch 093:   8000 / 49553 loss=3.829, nll_loss=2.165, ppl=4.48, wps=57148, ups=5, wpb=10110.151, bsz=620.516, num_updates=1.25702e+06, lr=2.82052e-05, gnorm=1.095, clip=0.000, oom=0.000, loss_scale=4.000, wall=55079, train_wall=513867
| epoch 093:   9000 / 49553 loss=3.830, nll_loss=2.166, ppl=4.49, wps=57162, ups=5, wpb=10111.512, bsz=621.041, num_updates=1.25802e+06, lr=2.81939e-05, gnorm=1.095, clip=0.000, oom=0.000, loss_scale=4.000, wall=55256, train_wall=514025
| epoch 093:  10000 / 49553 loss=3.829, nll_loss=2.165, ppl=4.48, wps=57224, ups=5, wpb=10108.271, bsz=620.595, num_updates=1.25902e+06, lr=2.81827e-05, gnorm=1.095, clip=0.000, oom=0.000, loss_scale=4.000, wall=55430, train_wall=514182
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([5, 674])
| epoch 093:  11000 / 49553 loss=3.831, nll_loss=2.167, ppl=4.49, wps=57228, ups=5, wpb=10104.703, bsz=620.649, num_updates=1.26002e+06, lr=2.81716e-05, gnorm=1.096, clip=0.000, oom=0.000, loss_scale=4.000, wall=55606, train_wall=514338
| epoch 093:  12000 / 49553 loss=3.833, nll_loss=2.169, ppl=4.50, wps=57199, ups=5, wpb=10105.844, bsz=619.437, num_updates=1.26102e+06, lr=2.81604e-05, gnorm=1.097, clip=0.000, oom=0.000, loss_scale=4.000, wall=55784, train_wall=514491
| epoch 093:  13000 / 49553 loss=3.833, nll_loss=2.169, ppl=4.50, wps=57213, ups=5, wpb=10100.850, bsz=618.626, num_updates=1.26202e+06, lr=2.81492e-05, gnorm=1.097, clip=0.000, oom=0.000, loss_scale=4.000, wall=55959, train_wall=514647
Invalid bert_input shape:torch.Size([5, 602])
| epoch 093:  14000 / 49553 loss=3.832, nll_loss=2.168, ppl=4.49, wps=57258, ups=5, wpb=10103.672, bsz=619.154, num_updates=1.26302e+06, lr=2.81381e-05, gnorm=1.097, clip=0.000, oom=0.000, loss_scale=4.000, wall=56134, train_wall=514803
| epoch 093:  15000 / 49553 loss=3.833, nll_loss=2.169, ppl=4.50, wps=57279, ups=5, wpb=10104.694, bsz=619.124, num_updates=1.26402e+06, lr=2.8127e-05, gnorm=1.097, clip=0.000, oom=0.000, loss_scale=8.000, wall=56310, train_wall=514961
Invalid bert_input shape:torch.Size([6, 863])
| epoch 093:  16000 / 49553 loss=3.832, nll_loss=2.168, ppl=4.50, wps=57288, ups=5, wpb=10102.491, bsz=619.831, num_updates=1.26502e+06, lr=2.81158e-05, gnorm=1.098, clip=0.000, oom=0.000, loss_scale=8.000, wall=56485, train_wall=515117
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 093:  17000 / 49553 loss=3.832, nll_loss=2.168, ppl=4.49, wps=57302, ups=5, wpb=10104.383, bsz=619.557, num_updates=1.26602e+06, lr=2.81047e-05, gnorm=1.098, clip=0.000, oom=0.000, loss_scale=4.000, wall=56661, train_wall=515275
Invalid bert_input shape:torch.Size([6, 1334])
| epoch 093:  18000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57210, ups=5, wpb=10098.864, bsz=619.947, num_updates=1.26702e+06, lr=2.80937e-05, gnorm=1.098, clip=0.000, oom=0.000, loss_scale=4.000, wall=56841, train_wall=515436
| epoch 093:  19000 / 49553 loss=3.831, nll_loss=2.167, ppl=4.49, wps=57169, ups=5, wpb=10098.963, bsz=620.151, num_updates=1.26802e+06, lr=2.80826e-05, gnorm=1.098, clip=0.000, oom=0.000, loss_scale=4.000, wall=57020, train_wall=515596
Invalid bert_input shape:torch.Size([3, 1160])
| epoch 093:  20000 / 49553 loss=3.832, nll_loss=2.168, ppl=4.49, wps=57127, ups=5, wpb=10096.570, bsz=620.227, num_updates=1.26902e+06, lr=2.80715e-05, gnorm=1.099, clip=0.000, oom=0.000, loss_scale=4.000, wall=57198, train_wall=515755
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([5, 614])
| epoch 093:  21000 / 49553 loss=3.831, nll_loss=2.167, ppl=4.49, wps=57130, ups=5, wpb=10095.584, bsz=620.548, num_updates=1.27002e+06, lr=2.80605e-05, gnorm=1.098, clip=0.000, oom=0.000, loss_scale=4.000, wall=57374, train_wall=515912
Invalid bert_input shape:torch.Size([6, 546])
| epoch 093:  22000 / 49553 loss=3.831, nll_loss=2.167, ppl=4.49, wps=57154, ups=5, wpb=10095.874, bsz=620.067, num_updates=1.27102e+06, lr=2.80494e-05, gnorm=1.099, clip=0.000, oom=0.000, loss_scale=4.000, wall=57549, train_wall=516069
| epoch 093:  23000 / 49553 loss=3.831, nll_loss=2.167, ppl=4.49, wps=57167, ups=5, wpb=10095.965, bsz=619.914, num_updates=1.27202e+06, lr=2.80384e-05, gnorm=1.099, clip=0.000, oom=0.000, loss_scale=4.000, wall=57725, train_wall=516226
| epoch 093:  24000 / 49553 loss=3.831, nll_loss=2.167, ppl=4.49, wps=57174, ups=5, wpb=10094.031, bsz=620.580, num_updates=1.27302e+06, lr=2.80274e-05, gnorm=1.099, clip=0.000, oom=0.000, loss_scale=4.000, wall=57900, train_wall=516381
| epoch 093:  25000 / 49553 loss=3.831, nll_loss=2.167, ppl=4.49, wps=57192, ups=5, wpb=10094.345, bsz=620.481, num_updates=1.27402e+06, lr=2.80164e-05, gnorm=1.100, clip=0.000, oom=0.000, loss_scale=8.000, wall=58076, train_wall=516538
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 093:  26000 / 49553 loss=3.832, nll_loss=2.169, ppl=4.50, wps=57199, ups=6, wpb=10095.805, bsz=619.991, num_updates=1.27502e+06, lr=2.80054e-05, gnorm=1.100, clip=0.000, oom=0.000, loss_scale=4.000, wall=58252, train_wall=516695
| epoch 093:  27000 / 49553 loss=3.832, nll_loss=2.169, ppl=4.50, wps=57225, ups=6, wpb=10099.948, bsz=619.285, num_updates=1.27602e+06, lr=2.79944e-05, gnorm=1.100, clip=0.000, oom=0.000, loss_scale=4.000, wall=58428, train_wall=516853
| epoch 093:  28000 / 49553 loss=3.833, nll_loss=2.169, ppl=4.50, wps=57192, ups=6, wpb=10100.402, bsz=619.193, num_updates=1.27702e+06, lr=2.79835e-05, gnorm=1.100, clip=0.000, oom=0.000, loss_scale=4.000, wall=58608, train_wall=517013
| epoch 093:  29000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57207, ups=6, wpb=10102.019, bsz=619.114, num_updates=1.27802e+06, lr=2.79725e-05, gnorm=1.100, clip=0.000, oom=0.000, loss_scale=4.000, wall=58784, train_wall=517170
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 093:  30000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57224, ups=6, wpb=10100.869, bsz=619.140, num_updates=1.27902e+06, lr=2.79616e-05, gnorm=1.100, clip=0.000, oom=0.000, loss_scale=2.000, wall=58958, train_wall=517326
Invalid bert_input shape:torch.Size([5, 703])
| epoch 093:  31000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57234, ups=6, wpb=10098.294, bsz=619.236, num_updates=1.28002e+06, lr=2.79507e-05, gnorm=1.100, clip=0.000, oom=0.000, loss_scale=2.000, wall=59132, train_wall=517481
| epoch 093:  32000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57245, ups=6, wpb=10099.281, bsz=618.959, num_updates=1.28102e+06, lr=2.79398e-05, gnorm=1.101, clip=0.000, oom=0.000, loss_scale=2.000, wall=59308, train_wall=517638
Invalid bert_input shape:torch.Size([4, 858])
Invalid bert_input shape:torch.Size([7, 600])
| epoch 093:  33000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57227, ups=6, wpb=10096.774, bsz=618.674, num_updates=1.28202e+06, lr=2.79289e-05, gnorm=1.101, clip=0.000, oom=0.000, loss_scale=2.000, wall=59485, train_wall=517795
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 093:  34000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57215, ups=6, wpb=10098.205, bsz=618.684, num_updates=1.28302e+06, lr=2.7918e-05, gnorm=1.101, clip=0.000, oom=0.000, loss_scale=2.000, wall=59663, train_wall=517953
| epoch 093:  35000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57189, ups=6, wpb=10097.256, bsz=618.814, num_updates=1.28402e+06, lr=2.79071e-05, gnorm=1.101, clip=0.000, oom=0.000, loss_scale=2.000, wall=59842, train_wall=518106
Invalid bert_input shape:torch.Size([5, 666])
| epoch 093:  36000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57194, ups=6, wpb=10098.409, bsz=618.728, num_updates=1.28502e+06, lr=2.78962e-05, gnorm=1.101, clip=0.000, oom=0.000, loss_scale=2.000, wall=60019, train_wall=518258
| epoch 093:  37000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57199, ups=6, wpb=10096.882, bsz=619.161, num_updates=1.28602e+06, lr=2.78854e-05, gnorm=1.102, clip=0.000, oom=0.000, loss_scale=2.000, wall=60194, train_wall=518414
| epoch 093:  38000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57196, ups=6, wpb=10098.580, bsz=618.814, num_updates=1.28702e+06, lr=2.78746e-05, gnorm=1.102, clip=0.000, oom=0.000, loss_scale=4.000, wall=60372, train_wall=518574
| epoch 093:  39000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57221, ups=6, wpb=10100.081, bsz=618.467, num_updates=1.28802e+06, lr=2.78637e-05, gnorm=1.102, clip=0.000, oom=0.000, loss_scale=4.000, wall=60546, train_wall=518730
| epoch 093:  40000 / 49553 loss=3.835, nll_loss=2.171, ppl=4.50, wps=57231, ups=6, wpb=10100.150, bsz=618.358, num_updates=1.28902e+06, lr=2.78529e-05, gnorm=1.102, clip=0.000, oom=0.000, loss_scale=4.000, wall=60722, train_wall=518887
Invalid bert_input shape:torch.Size([4, 758])
| epoch 093:  41000 / 49553 loss=3.835, nll_loss=2.171, ppl=4.50, wps=57239, ups=6, wpb=10100.599, bsz=618.457, num_updates=1.29002e+06, lr=2.78421e-05, gnorm=1.102, clip=0.000, oom=0.000, loss_scale=4.000, wall=60898, train_wall=519043
| epoch 093:  42000 / 49553 loss=3.835, nll_loss=2.172, ppl=4.51, wps=57259, ups=6, wpb=10101.390, bsz=618.397, num_updates=1.29102e+06, lr=2.78313e-05, gnorm=1.102, clip=0.000, oom=0.000, loss_scale=8.000, wall=61072, train_wall=519199
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 093:  43000 / 49553 loss=3.835, nll_loss=2.172, ppl=4.51, wps=57270, ups=6, wpb=10101.545, bsz=618.554, num_updates=1.29202e+06, lr=2.78206e-05, gnorm=1.102, clip=0.000, oom=0.000, loss_scale=4.000, wall=61247, train_wall=519354
Invalid bert_input shape:torch.Size([4, 782])
| epoch 093:  44000 / 49553 loss=3.835, nll_loss=2.172, ppl=4.51, wps=57273, ups=6, wpb=10101.155, bsz=618.705, num_updates=1.29302e+06, lr=2.78098e-05, gnorm=1.102, clip=0.000, oom=0.000, loss_scale=4.000, wall=61423, train_wall=519509
| epoch 093:  45000 / 49553 loss=3.835, nll_loss=2.172, ppl=4.51, wps=57291, ups=6, wpb=10100.894, bsz=618.623, num_updates=1.29402e+06, lr=2.77991e-05, gnorm=1.103, clip=0.000, oom=0.000, loss_scale=4.000, wall=61596, train_wall=519665
Invalid bert_input shape:torch.Size([4, 760])
| epoch 093:  46000 / 49553 loss=3.836, nll_loss=2.173, ppl=4.51, wps=57301, ups=6, wpb=10100.998, bsz=618.607, num_updates=1.29502e+06, lr=2.77883e-05, gnorm=1.103, clip=0.000, oom=0.000, loss_scale=4.000, wall=61771, train_wall=519821
| epoch 093:  47000 / 49553 loss=3.836, nll_loss=2.173, ppl=4.51, wps=57305, ups=6, wpb=10101.249, bsz=618.482, num_updates=1.29602e+06, lr=2.77776e-05, gnorm=1.103, clip=0.000, oom=0.000, loss_scale=8.000, wall=61947, train_wall=519978
| epoch 093:  48000 / 49553 loss=3.836, nll_loss=2.173, ppl=4.51, wps=57311, ups=6, wpb=10100.193, bsz=618.543, num_updates=1.29702e+06, lr=2.77669e-05, gnorm=1.104, clip=0.000, oom=0.000, loss_scale=8.000, wall=62122, train_wall=520133
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 093:  49000 / 49553 loss=3.836, nll_loss=2.173, ppl=4.51, wps=57310, ups=6, wpb=10099.811, bsz=618.642, num_updates=1.29801e+06, lr=2.77562e-05, gnorm=1.104, clip=0.000, oom=0.000, loss_scale=4.000, wall=62298, train_wall=520290
| epoch 093 | loss 3.836 | nll_loss 2.173 | ppl 4.51 | wps 57314 | ups 6 | wpb 10099.928 | bsz 618.658 | num_updates 1.29857e+06 | lr 2.77503e-05 | gnorm 1.104 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 62394 | train_wall 520375
| epoch 093 | valid on 'valid' subset | loss 2.753 | nll_loss 0.935 | ppl 1.91 | num_updates 1.29857e+06 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint93.pt (epoch 93 @ 1298566 updates) (writing took 7.520724534988403 seconds)
| epoch 094:   1000 / 49553 loss=3.807, nll_loss=2.140, ppl=4.41, wps=57607, ups=3, wpb=10070.107, bsz=617.412, num_updates=1.29957e+06, lr=2.77396e-05, gnorm=1.111, clip=0.000, oom=0.000, loss_scale=4.000, wall=62707, train_wall=520544
Invalid bert_input shape:torch.Size([4, 843])
| epoch 094:   2000 / 49553 loss=3.816, nll_loss=2.151, ppl=4.44, wps=57546, ups=4, wpb=10066.040, bsz=621.820, num_updates=1.30057e+06, lr=2.7729e-05, gnorm=1.111, clip=0.000, oom=0.000, loss_scale=4.000, wall=62882, train_wall=520699
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 094:   3000 / 49553 loss=3.826, nll_loss=2.162, ppl=4.47, wps=57519, ups=5, wpb=10087.429, bsz=620.172, num_updates=1.30157e+06, lr=2.77183e-05, gnorm=1.113, clip=0.000, oom=0.000, loss_scale=2.000, wall=63058, train_wall=520857
| epoch 094:   4000 / 49553 loss=3.823, nll_loss=2.158, ppl=4.46, wps=57618, ups=5, wpb=10089.379, bsz=618.757, num_updates=1.30257e+06, lr=2.77077e-05, gnorm=1.110, clip=0.000, oom=0.000, loss_scale=2.000, wall=63233, train_wall=521012
| epoch 094:   5000 / 49553 loss=3.826, nll_loss=2.162, ppl=4.48, wps=57602, ups=5, wpb=10098.572, bsz=618.119, num_updates=1.30357e+06, lr=2.7697e-05, gnorm=1.112, clip=0.000, oom=0.000, loss_scale=2.000, wall=63409, train_wall=521169
Invalid bert_input shape:torch.Size([4, 858])
| epoch 094:   6000 / 49553 loss=3.828, nll_loss=2.164, ppl=4.48, wps=57363, ups=5, wpb=10105.888, bsz=619.651, num_updates=1.30457e+06, lr=2.76864e-05, gnorm=1.112, clip=0.000, oom=0.000, loss_scale=2.000, wall=63589, train_wall=521328
| epoch 094:   7000 / 49553 loss=3.829, nll_loss=2.165, ppl=4.49, wps=57241, ups=5, wpb=10104.430, bsz=621.182, num_updates=1.30557e+06, lr=2.76758e-05, gnorm=1.113, clip=0.000, oom=0.000, loss_scale=4.000, wall=63768, train_wall=521488
Invalid bert_input shape:torch.Size([5, 636])
| epoch 094:   8000 / 49553 loss=3.827, nll_loss=2.163, ppl=4.48, wps=57175, ups=5, wpb=10106.061, bsz=620.870, num_updates=1.30657e+06, lr=2.76652e-05, gnorm=1.113, clip=0.000, oom=0.000, loss_scale=4.000, wall=63946, train_wall=521647
| epoch 094:   9000 / 49553 loss=3.828, nll_loss=2.164, ppl=4.48, wps=57101, ups=5, wpb=10099.387, bsz=621.594, num_updates=1.30757e+06, lr=2.76547e-05, gnorm=1.114, clip=0.000, oom=0.000, loss_scale=4.000, wall=64124, train_wall=521804
| epoch 094:  10000 / 49553 loss=3.830, nll_loss=2.166, ppl=4.49, wps=57036, ups=5, wpb=10106.407, bsz=621.085, num_updates=1.30857e+06, lr=2.76441e-05, gnorm=1.114, clip=0.000, oom=0.000, loss_scale=4.000, wall=64304, train_wall=521965
| epoch 094:  11000 / 49553 loss=3.832, nll_loss=2.169, ppl=4.50, wps=57074, ups=5, wpb=10110.506, bsz=621.926, num_updates=1.30957e+06, lr=2.76335e-05, gnorm=1.114, clip=0.000, oom=0.000, loss_scale=8.000, wall=64481, train_wall=522121
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([4, 760])
| epoch 094:  12000 / 49553 loss=3.832, nll_loss=2.168, ppl=4.49, wps=57097, ups=5, wpb=10109.583, bsz=622.163, num_updates=1.31056e+06, lr=2.7623e-05, gnorm=1.114, clip=0.000, oom=0.000, loss_scale=4.000, wall=64657, train_wall=522277
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 094:  13000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57085, ups=5, wpb=10113.828, bsz=621.655, num_updates=1.31156e+06, lr=2.76125e-05, gnorm=1.113, clip=0.000, oom=0.000, loss_scale=2.000, wall=64835, train_wall=522428
| epoch 094:  14000 / 49553 loss=3.831, nll_loss=2.167, ppl=4.49, wps=57101, ups=5, wpb=10115.919, bsz=620.977, num_updates=1.31256e+06, lr=2.76019e-05, gnorm=1.113, clip=0.000, oom=0.000, loss_scale=2.000, wall=65012, train_wall=522586
| epoch 094:  15000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57043, ups=5, wpb=10111.673, bsz=621.222, num_updates=1.31356e+06, lr=2.75914e-05, gnorm=1.113, clip=0.000, oom=0.000, loss_scale=2.000, wall=65191, train_wall=522746
Invalid bert_input shape:torch.Size([5, 638])
| epoch 094:  16000 / 49553 loss=3.832, nll_loss=2.169, ppl=4.50, wps=57091, ups=5, wpb=10110.930, bsz=620.466, num_updates=1.31456e+06, lr=2.75809e-05, gnorm=1.114, clip=0.000, oom=0.000, loss_scale=2.000, wall=65366, train_wall=522903
Invalid bert_input shape:torch.Size([2, 1203])
| epoch 094:  17000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57090, ups=5, wpb=10110.876, bsz=619.542, num_updates=1.31556e+06, lr=2.75705e-05, gnorm=1.114, clip=0.000, oom=0.000, loss_scale=4.000, wall=65543, train_wall=523061
| epoch 094:  18000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57107, ups=5, wpb=10110.984, bsz=619.331, num_updates=1.31656e+06, lr=2.756e-05, gnorm=1.115, clip=0.000, oom=0.000, loss_scale=4.000, wall=65719, train_wall=523219
Invalid bert_input shape:torch.Size([5, 1524])
Invalid bert_input shape:torch.Size([6, 575])
| epoch 094:  19000 / 49553 loss=3.833, nll_loss=2.169, ppl=4.50, wps=57109, ups=5, wpb=10111.830, bsz=619.354, num_updates=1.31756e+06, lr=2.75495e-05, gnorm=1.115, clip=0.000, oom=0.000, loss_scale=4.000, wall=65896, train_wall=523373
| epoch 094:  20000 / 49553 loss=3.832, nll_loss=2.169, ppl=4.50, wps=57125, ups=5, wpb=10113.930, bsz=619.661, num_updates=1.31856e+06, lr=2.75391e-05, gnorm=1.115, clip=0.000, oom=0.000, loss_scale=4.000, wall=66073, train_wall=523530
| epoch 094:  21000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57144, ups=5, wpb=10110.004, bsz=619.428, num_updates=1.31956e+06, lr=2.75286e-05, gnorm=1.116, clip=0.000, oom=0.000, loss_scale=8.000, wall=66247, train_wall=523684
| WARNING: overflow detected, setting loss scale to: 4.0
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 094:  22000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57174, ups=5, wpb=10110.524, bsz=619.602, num_updates=1.32056e+06, lr=2.75182e-05, gnorm=1.116, clip=0.000, oom=0.000, loss_scale=2.000, wall=66422, train_wall=523840
Invalid bert_input shape:torch.Size([5, 666])
| epoch 094:  23000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57170, ups=5, wpb=10113.712, bsz=619.649, num_updates=1.32156e+06, lr=2.75078e-05, gnorm=1.116, clip=0.000, oom=0.000, loss_scale=2.000, wall=66600, train_wall=523999
| epoch 094:  24000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57210, ups=5, wpb=10113.265, bsz=619.215, num_updates=1.32256e+06, lr=2.74974e-05, gnorm=1.116, clip=0.000, oom=0.000, loss_scale=2.000, wall=66774, train_wall=524155
| epoch 094:  25000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57226, ups=5, wpb=10110.535, bsz=619.015, num_updates=1.32356e+06, lr=2.7487e-05, gnorm=1.116, clip=0.000, oom=0.000, loss_scale=2.000, wall=66949, train_wall=524311
Invalid bert_input shape:torch.Size([4, 721])
| epoch 094:  26000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57245, ups=5, wpb=10110.032, bsz=619.268, num_updates=1.32456e+06, lr=2.74767e-05, gnorm=1.117, clip=0.000, oom=0.000, loss_scale=2.000, wall=67123, train_wall=524467
Invalid bert_input shape:torch.Size([3, 1119])
| epoch 094:  27000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57277, ups=6, wpb=10111.176, bsz=619.192, num_updates=1.32556e+06, lr=2.74663e-05, gnorm=1.116, clip=0.000, oom=0.000, loss_scale=4.000, wall=67298, train_wall=524624
| epoch 094:  28000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57292, ups=6, wpb=10109.684, bsz=619.082, num_updates=1.32656e+06, lr=2.74559e-05, gnorm=1.117, clip=0.000, oom=0.000, loss_scale=4.000, wall=67472, train_wall=524779
| epoch 094:  29000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57304, ups=6, wpb=10108.329, bsz=619.425, num_updates=1.32756e+06, lr=2.74456e-05, gnorm=1.117, clip=0.000, oom=0.000, loss_scale=4.000, wall=67647, train_wall=524935
| epoch 094:  30000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57320, ups=6, wpb=10108.317, bsz=619.187, num_updates=1.32856e+06, lr=2.74353e-05, gnorm=1.117, clip=0.000, oom=0.000, loss_scale=4.000, wall=67822, train_wall=525091
Invalid bert_input shape:torch.Size([4, 790])
Invalid bert_input shape:torch.Size([6, 784])
| epoch 094:  31000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57299, ups=6, wpb=10108.574, bsz=619.070, num_updates=1.32956e+06, lr=2.74249e-05, gnorm=1.117, clip=0.000, oom=0.000, loss_scale=8.000, wall=68001, train_wall=525250
Invalid bert_input shape:torch.Size([2, 1562])
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 094:  32000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57300, ups=6, wpb=10109.282, bsz=618.809, num_updates=1.33056e+06, lr=2.74146e-05, gnorm=1.117, clip=0.000, oom=0.000, loss_scale=4.000, wall=68177, train_wall=525407
| epoch 094:  33000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57314, ups=6, wpb=10111.188, bsz=618.653, num_updates=1.33156e+06, lr=2.74043e-05, gnorm=1.117, clip=0.000, oom=0.000, loss_scale=4.000, wall=68353, train_wall=525560
Invalid bert_input shape:torch.Size([4, 790])
| epoch 094:  34000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57318, ups=6, wpb=10109.886, bsz=618.685, num_updates=1.33256e+06, lr=2.73941e-05, gnorm=1.118, clip=0.000, oom=0.000, loss_scale=4.000, wall=68528, train_wall=525714
| epoch 094:  35000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57301, ups=6, wpb=10108.698, bsz=618.650, num_updates=1.33356e+06, lr=2.73838e-05, gnorm=1.118, clip=0.000, oom=0.000, loss_scale=4.000, wall=68706, train_wall=525873
| epoch 094:  36000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57290, ups=6, wpb=10110.784, bsz=618.550, num_updates=1.33456e+06, lr=2.73735e-05, gnorm=1.118, clip=0.000, oom=0.000, loss_scale=4.000, wall=68885, train_wall=526028
| epoch 094:  37000 / 49553 loss=3.834, nll_loss=2.172, ppl=4.50, wps=57272, ups=6, wpb=10110.341, bsz=618.386, num_updates=1.33556e+06, lr=2.73633e-05, gnorm=1.118, clip=0.000, oom=0.000, loss_scale=8.000, wall=69063, train_wall=526180
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 094:  38000 / 49553 loss=3.834, nll_loss=2.171, ppl=4.50, wps=57279, ups=6, wpb=10110.798, bsz=618.142, num_updates=1.33656e+06, lr=2.73531e-05, gnorm=1.118, clip=0.000, oom=0.000, loss_scale=4.000, wall=69239, train_wall=526337
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 094:  39000 / 49553 loss=3.835, nll_loss=2.172, ppl=4.51, wps=57291, ups=6, wpb=10110.672, bsz=618.095, num_updates=1.33756e+06, lr=2.73428e-05, gnorm=1.119, clip=0.000, oom=0.000, loss_scale=2.000, wall=69414, train_wall=526492
| epoch 094:  40000 / 49553 loss=3.835, nll_loss=2.172, ppl=4.51, wps=57302, ups=6, wpb=10110.325, bsz=618.289, num_updates=1.33856e+06, lr=2.73326e-05, gnorm=1.119, clip=0.000, oom=0.000, loss_scale=2.000, wall=69589, train_wall=526648
| epoch 094:  41000 / 49553 loss=3.835, nll_loss=2.172, ppl=4.51, wps=57305, ups=6, wpb=10109.572, bsz=618.793, num_updates=1.33956e+06, lr=2.73224e-05, gnorm=1.119, clip=0.000, oom=0.000, loss_scale=2.000, wall=69764, train_wall=526804
| epoch 094:  42000 / 49553 loss=3.835, nll_loss=2.172, ppl=4.51, wps=57302, ups=6, wpb=10108.275, bsz=618.943, num_updates=1.34056e+06, lr=2.73122e-05, gnorm=1.119, clip=0.000, oom=0.000, loss_scale=2.000, wall=69940, train_wall=526961
Invalid bert_input shape:torch.Size([7, 573])
| epoch 094:  43000 / 49553 loss=3.835, nll_loss=2.172, ppl=4.51, wps=57308, ups=6, wpb=10107.331, bsz=619.025, num_updates=1.34156e+06, lr=2.7302e-05, gnorm=1.119, clip=0.000, oom=0.000, loss_scale=4.000, wall=70115, train_wall=527116
| epoch 094:  44000 / 49553 loss=3.835, nll_loss=2.172, ppl=4.51, wps=57306, ups=6, wpb=10105.527, bsz=618.814, num_updates=1.34256e+06, lr=2.72919e-05, gnorm=1.120, clip=0.000, oom=0.000, loss_scale=4.000, wall=70290, train_wall=527272
| epoch 094:  45000 / 49553 loss=3.835, nll_loss=2.172, ppl=4.51, wps=57320, ups=6, wpb=10105.239, bsz=618.816, num_updates=1.34356e+06, lr=2.72817e-05, gnorm=1.120, clip=0.000, oom=0.000, loss_scale=4.000, wall=70464, train_wall=527428
| epoch 094:  46000 / 49553 loss=3.835, nll_loss=2.172, ppl=4.51, wps=57327, ups=6, wpb=10103.819, bsz=618.761, num_updates=1.34456e+06, lr=2.72716e-05, gnorm=1.120, clip=0.000, oom=0.000, loss_scale=4.000, wall=70638, train_wall=527583
Invalid bert_input shape:torch.Size([5, 703])
| epoch 094:  47000 / 49553 loss=3.835, nll_loss=2.173, ppl=4.51, wps=57335, ups=6, wpb=10104.175, bsz=618.723, num_updates=1.34556e+06, lr=2.72614e-05, gnorm=1.120, clip=0.000, oom=0.000, loss_scale=8.000, wall=70814, train_wall=527740
Invalid bert_input shape:torch.Size([8, 1356])
Invalid bert_input shape:torch.Size([5, 869])
| epoch 094:  48000 / 49553 loss=3.835, nll_loss=2.172, ppl=4.51, wps=57345, ups=6, wpb=10103.647, bsz=618.674, num_updates=1.34656e+06, lr=2.72513e-05, gnorm=1.120, clip=0.000, oom=0.000, loss_scale=8.000, wall=70988, train_wall=527895
| epoch 094:  49000 / 49553 loss=3.835, nll_loss=2.172, ppl=4.51, wps=57335, ups=6, wpb=10100.882, bsz=618.644, num_updates=1.34756e+06, lr=2.72412e-05, gnorm=1.121, clip=0.000, oom=0.000, loss_scale=8.000, wall=71164, train_wall=528052
| epoch 094 | loss 3.835 | nll_loss 2.172 | ppl 4.51 | wps 57335 | ups 6 | wpb 10099.965 | bsz 618.649 | num_updates 1.34811e+06 | lr 2.72356e-05 | gnorm 1.121 | clip 0.000 | oom 0.000 | loss_scale 8.000 | wall 71260 | train_wall 528138
| epoch 094 | valid on 'valid' subset | loss 2.749 | nll_loss 0.935 | ppl 1.91 | num_updates 1.34811e+06 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint94.pt (epoch 94 @ 1348111 updates) (writing took 25.18100094795227 seconds)
| epoch 095:   1000 / 49553 loss=3.817, nll_loss=2.152, ppl=4.44, wps=56924, ups=3, wpb=10126.116, bsz=607.512, num_updates=1.34911e+06, lr=2.72255e-05, gnorm=1.122, clip=0.000, oom=0.000, loss_scale=8.000, wall=71586, train_wall=528299
| WARNING: overflow detected, setting loss scale to: 8.0
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 095:   2000 / 49553 loss=3.821, nll_loss=2.156, ppl=4.46, wps=57322, ups=4, wpb=10122.086, bsz=612.517, num_updates=1.35011e+06, lr=2.72154e-05, gnorm=1.126, clip=0.000, oom=0.000, loss_scale=4.000, wall=71761, train_wall=528455
| epoch 095:   3000 / 49553 loss=3.821, nll_loss=2.157, ppl=4.46, wps=57217, ups=4, wpb=10101.743, bsz=615.146, num_updates=1.35111e+06, lr=2.72054e-05, gnorm=1.128, clip=0.000, oom=0.000, loss_scale=4.000, wall=71937, train_wall=528613
| epoch 095:   4000 / 49553 loss=3.825, nll_loss=2.161, ppl=4.47, wps=57324, ups=5, wpb=10100.844, bsz=615.921, num_updates=1.35211e+06, lr=2.71953e-05, gnorm=1.129, clip=0.000, oom=0.000, loss_scale=4.000, wall=72112, train_wall=528769
| epoch 095:   5000 / 49553 loss=3.821, nll_loss=2.156, ppl=4.46, wps=57074, ups=5, wpb=10090.431, bsz=618.211, num_updates=1.35311e+06, lr=2.71853e-05, gnorm=1.131, clip=0.000, oom=0.000, loss_scale=4.000, wall=72291, train_wall=528919
Invalid bert_input shape:torch.Size([5, 692])
| epoch 095:   6000 / 49553 loss=3.821, nll_loss=2.156, ppl=4.46, wps=57109, ups=5, wpb=10095.644, bsz=615.427, num_updates=1.35411e+06, lr=2.71752e-05, gnorm=1.130, clip=0.000, oom=0.000, loss_scale=8.000, wall=72468, train_wall=529074
Invalid bert_input shape:torch.Size([3, 1184])
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 095:   7000 / 49553 loss=3.821, nll_loss=2.156, ppl=4.46, wps=57199, ups=5, wpb=10088.964, bsz=616.884, num_updates=1.35511e+06, lr=2.71652e-05, gnorm=1.129, clip=0.000, oom=0.000, loss_scale=4.000, wall=72642, train_wall=529230
| epoch 095:   8000 / 49553 loss=3.820, nll_loss=2.155, ppl=4.45, wps=57231, ups=5, wpb=10088.440, bsz=618.435, num_updates=1.35611e+06, lr=2.71552e-05, gnorm=1.129, clip=0.000, oom=0.000, loss_scale=4.000, wall=72817, train_wall=529386
Invalid bert_input shape:torch.Size([5, 602])
| epoch 095:   9000 / 49553 loss=3.821, nll_loss=2.157, ppl=4.46, wps=57280, ups=5, wpb=10094.063, bsz=618.318, num_updates=1.35711e+06, lr=2.71452e-05, gnorm=1.130, clip=0.000, oom=0.000, loss_scale=4.000, wall=72993, train_wall=529542
| epoch 095:  10000 / 49553 loss=3.821, nll_loss=2.157, ppl=4.46, wps=57391, ups=5, wpb=10100.685, bsz=617.499, num_updates=1.35811e+06, lr=2.71352e-05, gnorm=1.129, clip=0.000, oom=0.000, loss_scale=4.000, wall=73167, train_wall=529698
Invalid bert_input shape:torch.Size([5, 636])
| epoch 095:  11000 / 49553 loss=3.822, nll_loss=2.158, ppl=4.46, wps=57397, ups=5, wpb=10099.370, bsz=618.502, num_updates=1.35911e+06, lr=2.71252e-05, gnorm=1.131, clip=0.000, oom=0.000, loss_scale=8.000, wall=73343, train_wall=529855
| WARNING: overflow detected, setting loss scale to: 4.0
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 095:  12000 / 49553 loss=3.822, nll_loss=2.157, ppl=4.46, wps=57440, ups=5, wpb=10102.391, bsz=618.284, num_updates=1.36011e+06, lr=2.71152e-05, gnorm=1.130, clip=0.000, oom=0.000, loss_scale=2.000, wall=73517, train_wall=530011
| epoch 095:  13000 / 49553 loss=3.823, nll_loss=2.159, ppl=4.46, wps=57500, ups=5, wpb=10102.708, bsz=617.869, num_updates=1.36111e+06, lr=2.71053e-05, gnorm=1.130, clip=0.000, oom=0.000, loss_scale=2.000, wall=73691, train_wall=530166
| epoch 095:  14000 / 49553 loss=3.824, nll_loss=2.160, ppl=4.47, wps=57528, ups=5, wpb=10104.704, bsz=617.566, num_updates=1.36211e+06, lr=2.70953e-05, gnorm=1.131, clip=0.000, oom=0.000, loss_scale=2.000, wall=73866, train_wall=530323
| epoch 095:  15000 / 49553 loss=3.824, nll_loss=2.159, ppl=4.47, wps=57525, ups=5, wpb=10104.136, bsz=617.468, num_updates=1.36311e+06, lr=2.70854e-05, gnorm=1.132, clip=0.000, oom=0.000, loss_scale=2.000, wall=74042, train_wall=530479
Invalid bert_input shape:torch.Size([7, 790])
| epoch 095:  16000 / 49553 loss=3.825, nll_loss=2.161, ppl=4.47, wps=57544, ups=5, wpb=10101.760, bsz=616.984, num_updates=1.36411e+06, lr=2.70755e-05, gnorm=1.132, clip=0.000, oom=0.000, loss_scale=4.000, wall=74216, train_wall=530634
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 095:  17000 / 49553 loss=3.826, nll_loss=2.163, ppl=4.48, wps=57530, ups=5, wpb=10103.047, bsz=616.797, num_updates=1.36511e+06, lr=2.70655e-05, gnorm=1.133, clip=0.000, oom=0.000, loss_scale=2.000, wall=74392, train_wall=530793
Invalid bert_input shape:torch.Size([4, 859])
| epoch 095:  18000 / 49553 loss=3.826, nll_loss=2.162, ppl=4.48, wps=57537, ups=5, wpb=10103.064, bsz=616.638, num_updates=1.36611e+06, lr=2.70556e-05, gnorm=1.133, clip=0.000, oom=0.000, loss_scale=2.000, wall=74567, train_wall=530950
| epoch 095:  19000 / 49553 loss=3.826, nll_loss=2.162, ppl=4.48, wps=57513, ups=5, wpb=10103.962, bsz=616.849, num_updates=1.36711e+06, lr=2.70457e-05, gnorm=1.133, clip=0.000, oom=0.000, loss_scale=2.000, wall=74745, train_wall=531108
| epoch 095:  20000 / 49553 loss=3.826, nll_loss=2.162, ppl=4.48, wps=57511, ups=5, wpb=10103.304, bsz=616.956, num_updates=1.36811e+06, lr=2.70359e-05, gnorm=1.133, clip=0.000, oom=0.000, loss_scale=2.000, wall=74920, train_wall=531263
Invalid bert_input shape:torch.Size([5, 674])
| epoch 095:  21000 / 49553 loss=3.826, nll_loss=2.162, ppl=4.48, wps=57520, ups=5, wpb=10104.072, bsz=617.127, num_updates=1.36911e+06, lr=2.7026e-05, gnorm=1.133, clip=0.000, oom=0.000, loss_scale=4.000, wall=75096, train_wall=531420
| epoch 095:  22000 / 49553 loss=3.827, nll_loss=2.163, ppl=4.48, wps=57547, ups=5, wpb=10103.813, bsz=616.957, num_updates=1.37011e+06, lr=2.70161e-05, gnorm=1.133, clip=0.000, oom=0.000, loss_scale=4.000, wall=75269, train_wall=531575
| epoch 095:  23000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57537, ups=5, wpb=10103.477, bsz=617.462, num_updates=1.37111e+06, lr=2.70063e-05, gnorm=1.133, clip=0.000, oom=0.000, loss_scale=4.000, wall=75445, train_wall=531733
Invalid bert_input shape:torch.Size([2, 1203])
Invalid bert_input shape:torch.Size([7, 600])
Invalid bert_input shape:torch.Size([4, 800])
| epoch 095:  24000 / 49553 loss=3.828, nll_loss=2.164, ppl=4.48, wps=57550, ups=6, wpb=10103.806, bsz=617.607, num_updates=1.37211e+06, lr=2.69964e-05, gnorm=1.133, clip=0.000, oom=0.000, loss_scale=4.000, wall=75620, train_wall=531889
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 095:  25000 / 49553 loss=3.829, nll_loss=2.165, ppl=4.49, wps=57578, ups=6, wpb=10105.499, bsz=617.866, num_updates=1.37310e+06, lr=2.69866e-05, gnorm=1.134, clip=0.000, oom=0.000, loss_scale=4.000, wall=75794, train_wall=532045
| WARNING: overflow detected, setting loss scale to: 2.0
Invalid bert_input shape:torch.Size([6, 566])
| epoch 095:  26000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57578, ups=6, wpb=10107.029, bsz=618.076, num_updates=1.3741e+06, lr=2.69768e-05, gnorm=1.133, clip=0.000, oom=0.000, loss_scale=2.000, wall=75970, train_wall=532202
Invalid bert_input shape:torch.Size([3, 1514])
Invalid bert_input shape:torch.Size([5, 907])
| epoch 095:  27000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57578, ups=6, wpb=10108.238, bsz=618.233, num_updates=1.3751e+06, lr=2.6967e-05, gnorm=1.134, clip=0.000, oom=0.000, loss_scale=2.000, wall=76146, train_wall=532358
| epoch 095:  28000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57568, ups=6, wpb=10108.074, bsz=618.249, num_updates=1.3761e+06, lr=2.69572e-05, gnorm=1.134, clip=0.000, oom=0.000, loss_scale=2.000, wall=76323, train_wall=532511
| epoch 095:  29000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57550, ups=6, wpb=10107.731, bsz=618.354, num_updates=1.3771e+06, lr=2.69474e-05, gnorm=1.134, clip=0.000, oom=0.000, loss_scale=2.000, wall=76500, train_wall=532668
Invalid bert_input shape:torch.Size([3, 1119])
| epoch 095:  30000 / 49553 loss=3.831, nll_loss=2.167, ppl=4.49, wps=57537, ups=6, wpb=10104.385, bsz=618.482, num_updates=1.3781e+06, lr=2.69376e-05, gnorm=1.135, clip=0.000, oom=0.000, loss_scale=4.000, wall=76675, train_wall=532823
Invalid bert_input shape:torch.Size([2, 1562])
| epoch 095:  31000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57552, ups=6, wpb=10104.372, bsz=618.159, num_updates=1.3791e+06, lr=2.69278e-05, gnorm=1.135, clip=0.000, oom=0.000, loss_scale=4.000, wall=76849, train_wall=532978
| epoch 095:  32000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57547, ups=6, wpb=10103.825, bsz=617.975, num_updates=1.3801e+06, lr=2.69181e-05, gnorm=1.135, clip=0.000, oom=0.000, loss_scale=4.000, wall=77025, train_wall=533134
Invalid bert_input shape:torch.Size([4, 1167])
| epoch 095:  33000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57537, ups=6, wpb=10103.536, bsz=618.195, num_updates=1.3811e+06, lr=2.69083e-05, gnorm=1.135, clip=0.000, oom=0.000, loss_scale=4.000, wall=77201, train_wall=533291
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 095:  34000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57517, ups=6, wpb=10102.989, bsz=618.739, num_updates=1.3821e+06, lr=2.68986e-05, gnorm=1.135, clip=0.000, oom=0.000, loss_scale=4.000, wall=77378, train_wall=533447
Invalid bert_input shape:torch.Size([8, 844])
| epoch 095:  35000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57509, ups=6, wpb=10102.506, bsz=618.964, num_updates=1.3831e+06, lr=2.68889e-05, gnorm=1.135, clip=0.000, oom=0.000, loss_scale=4.000, wall=77554, train_wall=533603
| epoch 095:  36000 / 49553 loss=3.832, nll_loss=2.169, ppl=4.50, wps=57509, ups=6, wpb=10100.740, bsz=618.947, num_updates=1.3841e+06, lr=2.68792e-05, gnorm=1.136, clip=0.000, oom=0.000, loss_scale=4.000, wall=77729, train_wall=533759
| epoch 095:  37000 / 49553 loss=3.832, nll_loss=2.168, ppl=4.50, wps=57509, ups=6, wpb=10100.161, bsz=618.931, num_updates=1.3851e+06, lr=2.68695e-05, gnorm=1.136, clip=0.000, oom=0.000, loss_scale=4.000, wall=77904, train_wall=533915
| epoch 095:  38000 / 49553 loss=3.832, nll_loss=2.169, ppl=4.50, wps=57457, ups=6, wpb=10098.082, bsz=619.038, num_updates=1.3861e+06, lr=2.68598e-05, gnorm=1.137, clip=0.000, oom=0.000, loss_scale=8.000, wall=78085, train_wall=534076
| epoch 095:  39000 / 49553 loss=3.832, nll_loss=2.169, ppl=4.50, wps=57458, ups=6, wpb=10099.946, bsz=618.994, num_updates=1.3871e+06, lr=2.68501e-05, gnorm=1.137, clip=0.000, oom=0.000, loss_scale=8.000, wall=78262, train_wall=534234
| epoch 095:  40000 / 49553 loss=3.832, nll_loss=2.169, ppl=4.50, wps=57466, ups=6, wpb=10100.666, bsz=618.921, num_updates=1.3881e+06, lr=2.68404e-05, gnorm=1.137, clip=0.000, oom=0.000, loss_scale=8.000, wall=78437, train_wall=534390
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([8, 1356])
| epoch 095:  41000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57475, ups=6, wpb=10100.971, bsz=618.613, num_updates=1.3891e+06, lr=2.68308e-05, gnorm=1.137, clip=0.000, oom=0.000, loss_scale=4.000, wall=78612, train_wall=534546
Invalid bert_input shape:torch.Size([7, 865])
| epoch 095:  42000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57494, ups=6, wpb=10102.925, bsz=618.413, num_updates=1.3901e+06, lr=2.68211e-05, gnorm=1.137, clip=0.000, oom=0.000, loss_scale=4.000, wall=78786, train_wall=534702
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 095:  43000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57491, ups=6, wpb=10102.079, bsz=618.475, num_updates=1.3911e+06, lr=2.68115e-05, gnorm=1.137, clip=0.000, oom=0.000, loss_scale=2.000, wall=78961, train_wall=534859
| epoch 095:  44000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57496, ups=6, wpb=10101.897, bsz=618.816, num_updates=1.3921e+06, lr=2.68018e-05, gnorm=1.137, clip=0.000, oom=0.000, loss_scale=2.000, wall=79136, train_wall=535015
| epoch 095:  45000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57504, ups=6, wpb=10101.829, bsz=618.543, num_updates=1.3931e+06, lr=2.67922e-05, gnorm=1.137, clip=0.000, oom=0.000, loss_scale=2.000, wall=79311, train_wall=535172
Invalid bert_input shape:torch.Size([5, 703])
| epoch 095:  46000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57505, ups=6, wpb=10101.829, bsz=618.318, num_updates=1.3941e+06, lr=2.67826e-05, gnorm=1.137, clip=0.000, oom=0.000, loss_scale=2.000, wall=79487, train_wall=535329
Invalid bert_input shape:torch.Size([5, 729])
| epoch 095:  47000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57510, ups=6, wpb=10101.822, bsz=618.408, num_updates=1.3951e+06, lr=2.6773e-05, gnorm=1.138, clip=0.000, oom=0.000, loss_scale=4.000, wall=79661, train_wall=535485
Invalid bert_input shape:torch.Size([5, 704])
| epoch 095:  48000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57477, ups=6, wpb=10101.047, bsz=618.571, num_updates=1.3961e+06, lr=2.67634e-05, gnorm=1.138, clip=0.000, oom=0.000, loss_scale=4.000, wall=79841, train_wall=535646
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 095:  49000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=57432, ups=6, wpb=10099.263, bsz=618.653, num_updates=1.3971e+06, lr=2.67538e-05, gnorm=1.138, clip=0.000, oom=0.000, loss_scale=2.000, wall=80022, train_wall=535808
| epoch 095 | loss 3.833 | nll_loss 2.170 | ppl 4.50 | wps 57421 | ups 6 | wpb 10099.955 | bsz 618.664 | num_updates 1.39765e+06 | lr 2.67486e-05 | gnorm 1.138 | clip 0.000 | oom 0.000 | loss_scale 2.000 | wall 80121 | train_wall 535897
| epoch 095 | valid on 'valid' subset | loss 2.749 | nll_loss 0.931 | ppl 1.91 | num_updates 1.39765e+06 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint95.pt (epoch 95 @ 1397652 updates) (writing took 17.50045680999756 seconds)
| epoch 096:   1000 / 49553 loss=3.833, nll_loss=2.170, ppl=4.50, wps=56975, ups=3, wpb=10065.377, bsz=613.290, num_updates=1.39865e+06, lr=2.6739e-05, gnorm=1.153, clip=0.000, oom=0.000, loss_scale=2.000, wall=80441, train_wall=536056
| epoch 096:   2000 / 49553 loss=3.828, nll_loss=2.164, ppl=4.48, wps=56613, ups=4, wpb=10082.693, bsz=615.268, num_updates=1.39965e+06, lr=2.67294e-05, gnorm=1.143, clip=0.000, oom=0.000, loss_scale=2.000, wall=80621, train_wall=536218
Invalid bert_input shape:torch.Size([3, 1184])
| epoch 096:   3000 / 49553 loss=3.826, nll_loss=2.163, ppl=4.48, wps=56835, ups=4, wpb=10104.838, bsz=620.118, num_updates=1.40065e+06, lr=2.67199e-05, gnorm=1.142, clip=0.000, oom=0.000, loss_scale=4.000, wall=80798, train_wall=536376
Invalid bert_input shape:torch.Size([7, 722])
| WARNING: overflow detected, setting loss scale to: 2.0
Invalid bert_input shape:torch.Size([6, 784])
| epoch 096:   4000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57000, ups=5, wpb=10112.393, bsz=621.562, num_updates=1.40165e+06, lr=2.67104e-05, gnorm=1.143, clip=0.000, oom=0.000, loss_scale=2.000, wall=80974, train_wall=536532
| epoch 096:   5000 / 49553 loss=3.828, nll_loss=2.164, ppl=4.48, wps=57063, ups=5, wpb=10102.040, bsz=621.931, num_updates=1.40265e+06, lr=2.67008e-05, gnorm=1.145, clip=0.000, oom=0.000, loss_scale=2.000, wall=81150, train_wall=536689
| epoch 096:   6000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57080, ups=5, wpb=10108.996, bsz=619.278, num_updates=1.40365e+06, lr=2.66913e-05, gnorm=1.145, clip=0.000, oom=0.000, loss_scale=2.000, wall=81327, train_wall=536842
Invalid bert_input shape:torch.Size([5, 704])
| epoch 096:   7000 / 49553 loss=3.829, nll_loss=2.165, ppl=4.49, wps=57026, ups=5, wpb=10106.630, bsz=617.767, num_updates=1.40465e+06, lr=2.66818e-05, gnorm=1.146, clip=0.000, oom=0.000, loss_scale=2.000, wall=81505, train_wall=536994
Invalid bert_input shape:torch.Size([4, 758])
| epoch 096:   8000 / 49553 loss=3.828, nll_loss=2.164, ppl=4.48, wps=57070, ups=5, wpb=10114.684, bsz=617.347, num_updates=1.40565e+06, lr=2.66723e-05, gnorm=1.145, clip=0.000, oom=0.000, loss_scale=4.000, wall=81683, train_wall=537152
Invalid bert_input shape:torch.Size([8, 844])
| epoch 096:   9000 / 49553 loss=3.830, nll_loss=2.166, ppl=4.49, wps=57079, ups=5, wpb=10099.683, bsz=618.689, num_updates=1.40665e+06, lr=2.66629e-05, gnorm=1.148, clip=0.000, oom=0.000, loss_scale=4.000, wall=81857, train_wall=537308
| epoch 096:  10000 / 49553 loss=3.829, nll_loss=2.165, ppl=4.49, wps=57189, ups=5, wpb=10106.212, bsz=618.342, num_updates=1.40765e+06, lr=2.66534e-05, gnorm=1.148, clip=0.000, oom=0.000, loss_scale=4.000, wall=82032, train_wall=537464
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 096:  11000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57123, ups=5, wpb=10107.398, bsz=617.638, num_updates=1.40865e+06, lr=2.66439e-05, gnorm=1.147, clip=0.000, oom=0.000, loss_scale=2.000, wall=82211, train_wall=537624
| epoch 096:  12000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57212, ups=5, wpb=10112.161, bsz=617.373, num_updates=1.40965e+06, lr=2.66345e-05, gnorm=1.148, clip=0.000, oom=0.000, loss_scale=2.000, wall=82385, train_wall=537781
| epoch 096:  13000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57247, ups=5, wpb=10107.188, bsz=618.085, num_updates=1.41065e+06, lr=2.6625e-05, gnorm=1.148, clip=0.000, oom=0.000, loss_scale=2.000, wall=82560, train_wall=537937
| epoch 096:  14000 / 49553 loss=3.830, nll_loss=2.166, ppl=4.49, wps=57270, ups=5, wpb=10106.957, bsz=618.277, num_updates=1.41165e+06, lr=2.66156e-05, gnorm=1.148, clip=0.000, oom=0.000, loss_scale=2.000, wall=82735, train_wall=538094
| epoch 096:  15000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57330, ups=5, wpb=10109.448, bsz=618.187, num_updates=1.41265e+06, lr=2.66062e-05, gnorm=1.148, clip=0.000, oom=0.000, loss_scale=4.000, wall=82910, train_wall=538249
| epoch 096:  16000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57350, ups=5, wpb=10106.095, bsz=618.662, num_updates=1.41365e+06, lr=2.65968e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=4.000, wall=83084, train_wall=538405
| epoch 096:  17000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57352, ups=5, wpb=10106.727, bsz=618.723, num_updates=1.41465e+06, lr=2.65874e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=4.000, wall=83260, train_wall=538562
| epoch 096:  18000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57389, ups=5, wpb=10105.971, bsz=618.554, num_updates=1.41565e+06, lr=2.6578e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=4.000, wall=83434, train_wall=538717
| epoch 096:  19000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.50, wps=57416, ups=5, wpb=10106.750, bsz=618.193, num_updates=1.41665e+06, lr=2.65686e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=8.000, wall=83609, train_wall=538873
| epoch 096:  20000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57410, ups=5, wpb=10106.419, bsz=618.451, num_updates=1.41765e+06, lr=2.65592e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=8.000, wall=83785, train_wall=539029
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 096:  21000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57426, ups=5, wpb=10104.282, bsz=618.238, num_updates=1.41865e+06, lr=2.65499e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=4.000, wall=83959, train_wall=539185
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 096:  22000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57440, ups=5, wpb=10103.847, bsz=618.017, num_updates=1.41965e+06, lr=2.65405e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=2.000, wall=84134, train_wall=539341
| epoch 096:  23000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57472, ups=5, wpb=10109.525, bsz=618.408, num_updates=1.42065e+06, lr=2.65312e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=2.000, wall=84310, train_wall=539497
| epoch 096:  24000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57491, ups=6, wpb=10107.505, bsz=617.898, num_updates=1.42165e+06, lr=2.65218e-05, gnorm=1.150, clip=0.000, oom=0.000, loss_scale=2.000, wall=84484, train_wall=539653
Invalid bert_input shape:torch.Size([2, 1608])
| epoch 096:  25000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57456, ups=6, wpb=10102.481, bsz=618.784, num_updates=1.42265e+06, lr=2.65125e-05, gnorm=1.150, clip=0.000, oom=0.000, loss_scale=2.000, wall=84660, train_wall=539809
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 096:  26000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57463, ups=6, wpb=10102.106, bsz=619.084, num_updates=1.42365e+06, lr=2.65032e-05, gnorm=1.150, clip=0.000, oom=0.000, loss_scale=2.000, wall=84835, train_wall=539965
| epoch 096:  27000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57479, ups=6, wpb=10102.233, bsz=619.053, num_updates=1.42465e+06, lr=2.64939e-05, gnorm=1.151, clip=0.000, oom=0.000, loss_scale=2.000, wall=85009, train_wall=540121
Invalid bert_input shape:torch.Size([7, 573])
| epoch 096:  28000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57488, ups=6, wpb=10102.312, bsz=619.191, num_updates=1.42565e+06, lr=2.64846e-05, gnorm=1.151, clip=0.000, oom=0.000, loss_scale=2.000, wall=85184, train_wall=540276
Invalid bert_input shape:torch.Size([7, 865])
Invalid bert_input shape:torch.Size([6, 566])
| epoch 096:  29000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57489, ups=6, wpb=10100.122, bsz=619.236, num_updates=1.42665e+06, lr=2.64753e-05, gnorm=1.151, clip=0.000, oom=0.000, loss_scale=2.000, wall=85359, train_wall=540433
Invalid bert_input shape:torch.Size([6, 595])
Invalid bert_input shape:torch.Size([4, 823])
| epoch 096:  30000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57467, ups=6, wpb=10099.737, bsz=618.767, num_updates=1.42765e+06, lr=2.64661e-05, gnorm=1.152, clip=0.000, oom=0.000, loss_scale=2.000, wall=85536, train_wall=540592
Invalid bert_input shape:torch.Size([7, 900])
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 096:  31000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57420, ups=6, wpb=10097.621, bsz=618.702, num_updates=1.42865e+06, lr=2.64568e-05, gnorm=1.152, clip=0.000, oom=0.000, loss_scale=2.000, wall=85715, train_wall=540751
Invalid bert_input shape:torch.Size([6, 547])
| epoch 096:  32000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57429, ups=6, wpb=10099.403, bsz=618.524, num_updates=1.42965e+06, lr=2.64476e-05, gnorm=1.151, clip=0.000, oom=0.000, loss_scale=2.000, wall=85891, train_wall=540909
| epoch 096:  33000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57445, ups=6, wpb=10100.421, bsz=618.303, num_updates=1.43065e+06, lr=2.64383e-05, gnorm=1.152, clip=0.000, oom=0.000, loss_scale=2.000, wall=86066, train_wall=541066
| distributed init (rank 2): tcp://localhost:10431
| distributed init (rank 0): tcp://localhost:10431
| distributed init (rank 1): tcp://localhost:10431
| distributed init (rank 3): tcp://localhost:10431
| initialized host r16g02.bullx as rank 2
| initialized host r16g02.bullx as rank 3
| initialized host r16g02.bullx as rank 1
| initialized host r16g02.bullx as rank 0
Namespace(activation_dropout=0.0, activation_fn='relu', adam_betas='(0.9,0.98)', adam_eps=1e-08, adaptive_input=False, adaptive_softmax_cutoff=None, adaptive_softmax_dropout=0, arch='transformer_vaswani_wmt_en_de_big', attention_dropout=0.0, bert_first=True, bert_gates=[1, 1, 1, 1, 1, 1], bert_model_name='/scratch/project_2003453/bert-base-finnish-uncased-v1', bert_output_layer=-1, bert_ratio=1.0, bucket_cap_mb=25, clip_norm=25, cpu=False, criterion='label_smoothed_cross_entropy', curriculum=0, data='/scratch/project_2003453/bertnmt_data', dataset_impl='cached', ddp_backend='c10d', decoder_attention_heads=16, decoder_embed_dim=1024, decoder_embed_path=None, decoder_ffn_embed_dim=4096, decoder_input_dim=1024, decoder_layers=6, decoder_learned_pos=False, decoder_no_bert=False, decoder_normalize_before=False, decoder_output_dim=1024, device_id=0, disable_validation=False, distributed_backend='nccl', distributed_init_method='tcp://localhost:10431', distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=4, dropout=0.3, encoder_attention_heads=16, encoder_bert_dropout=True, encoder_bert_dropout_ratio=0.5, encoder_bert_mixup=False, encoder_embed_dim=1024, encoder_embed_path=None, encoder_ffn_embed_dim=4096, encoder_layers=6, encoder_learned_pos=False, encoder_normalize_before=False, encoder_ratio=1.0, find_unused_parameters=False, finetune_bert=False, fix_batches_to_gpus=False, fp16=True, fp16_init_scale=128, fp16_scale_tolerance=0.0, fp16_scale_window=None, keep_interval_updates=-1, keep_last_epochs=-1, label_smoothing=0.1, lazy_load=False, left_pad_source='True', left_pad_target='False', log_format=None, log_interval=1000, lr=[0.0005], lr_scheduler='inverse_sqrt', mask_cls_sep=False, max_epoch=0, max_sentences=None, max_sentences_valid=None, max_source_positions=1024, max_target_positions=1024, max_tokens=3584, max_update=0, memory_efficient_fp16=False, min_loss_scale=0.0001, min_lr=1e-09, no_epoch_checkpoints=False, no_progress_bar=False, no_save=False, no_token_positional_embeddings=False, num_workers=0, optimizer='adam', optimizer_overrides='{}', raw_text=False, required_batch_size_multiple=8, reset_dataloader=False, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file='checkpoint_last.pt', save_dir='/scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv', save_interval=1, save_interval_updates=0, seed=1, sentence_avg=False, share_all_embeddings=True, share_decoder_input_output_embed=False, skip_invalid_size_inputs_valid_test=False, source_lang='fi', target_lang='sv', task='translation', tbmf_wrapper=False, tensorboard_logdir='', threshold_loss_scale=None, train_subset='train', update_freq=[1], upsample_primary=1, user_dir=None, valid_subset='valid', validate_interval=1, warmup_from_nmt=False, warmup_init_lr=1e-07, warmup_nmt_file='checkpoint_nmt.pt', warmup_updates=4000, weight_decay=0.0001)
| [fi] dictionary: 37752 types
| [sv] dictionary: 37752 types
| /scratch/project_2003453/bertnmt_data valid fi-sv 5000 examples
bert_gates [True, True, True, True, True, True]
TransformerModel(
  (encoder): TransformerEncoder(
    (embed_tokens): Embedding(37752, 1024, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (1): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (2): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (3): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (4): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (5): TransformerEncoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (decoder): TransformerDecoder(
    (embed_tokens): Embedding(37752, 1024, padding_idx=1)
    (embed_positions): SinusoidalPositionalEmbedding()
    (layers): ModuleList(
      (0): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (1): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (2): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (3): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (4): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (5): TransformerDecoderLayer(
        (self_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (self_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (encoder_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (bert_attn): MultiheadAttention(
          (out_proj): Linear(in_features=1024, out_features=1024, bias=True)
        )
        (encoder_attn_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
        (fc1): Linear(in_features=1024, out_features=4096, bias=True)
        (fc2): Linear(in_features=4096, out_features=1024, bias=True)
        (final_layer_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
    )
  )
  (bert_encoder): BertModel(
    (embeddings): BertEmbeddings(
      (word_embeddings): Embedding(50101, 768, padding_idx=0)
      (position_embeddings): Embedding(512, 768)
      (token_type_embeddings): Embedding(2, 768)
      (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): BertEncoder(
      (layer): ModuleList(
        (0): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (1): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (2): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (3): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (4): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (5): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (6): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (7): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (8): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (9): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (10): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
        (11): BertLayer(
          (attention): BertAttention(
            (self): BertSelfAttention(
              (query): Linear(in_features=768, out_features=768, bias=True)
              (key): Linear(in_features=768, out_features=768, bias=True)
              (value): Linear(in_features=768, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
            (output): BertSelfOutput(
              (dense): Linear(in_features=768, out_features=768, bias=True)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              (dropout): Dropout(p=0.1, inplace=False)
            )
          )
          (intermediate): BertIntermediate(
            (dense): Linear(in_features=768, out_features=3072, bias=True)
          )
          (output): BertOutput(
            (dense): Linear(in_features=3072, out_features=768, bias=True)
            (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (dropout): Dropout(p=0.1, inplace=False)
          )
        )
      )
    )
    (pooler): BertPooler(
      (dense): Linear(in_features=768, out_features=768, bias=True)
      (activation): Tanh()
    )
  )
)
| model transformer_vaswani_wmt_en_de_big, criterion LabelSmoothedCrossEntropyCriterion
| num. model params: 361579008 (num. trained: 237060096)
| training on 4 GPUs
| max tokens per GPU = 3584 and max sentences per GPU = None
| loaded checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint_last.pt (epoch 95 @ 1397652 updates)
| loading train data for epoch 95
| /scratch/project_2003453/bertnmt_data train fi-sv 30659795 examples
| epoch 096:   1000 / 49553 loss=3.839, nll_loss=2.177, ppl=4.52, wps=56928, ups=2, wpb=10065.377, bsz=613.290, num_updates=1.39865e+06, lr=2.6739e-05, gnorm=1.155, clip=0.000, oom=0.000, loss_scale=2.000, wall=626, train_wall=536064
| epoch 096:   2000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57391, ups=2, wpb=10082.693, bsz=615.268, num_updates=1.39965e+06, lr=2.67294e-05, gnorm=1.147, clip=0.000, oom=0.000, loss_scale=2.000, wall=801, train_wall=536220
Invalid bert_input shape:torch.Size([3, 1184])
| epoch 096:   3000 / 49553 loss=3.828, nll_loss=2.164, ppl=4.48, wps=57274, ups=3, wpb=10104.838, bsz=620.118, num_updates=1.40065e+06, lr=2.67199e-05, gnorm=1.145, clip=0.000, oom=0.000, loss_scale=2.000, wall=979, train_wall=536377
Invalid bert_input shape:torch.Size([7, 722])
Invalid bert_input shape:torch.Size([6, 784])
| epoch 096:   4000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57417, ups=3, wpb=10112.789, bsz=621.750, num_updates=1.40165e+06, lr=2.67104e-05, gnorm=1.146, clip=0.000, oom=0.000, loss_scale=2.000, wall=1154, train_wall=536533
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 096:   5000 / 49553 loss=3.828, nll_loss=2.165, ppl=4.48, wps=57467, ups=4, wpb=10101.890, bsz=622.064, num_updates=1.40265e+06, lr=2.67008e-05, gnorm=1.146, clip=0.000, oom=0.000, loss_scale=2.000, wall=1328, train_wall=536688
| epoch 096:   6000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57491, ups=4, wpb=10108.871, bsz=619.389, num_updates=1.40365e+06, lr=2.66913e-05, gnorm=1.146, clip=0.000, oom=0.000, loss_scale=2.000, wall=1504, train_wall=536845
Invalid bert_input shape:torch.Size([5, 704])
| epoch 096:   7000 / 49553 loss=3.829, nll_loss=2.165, ppl=4.49, wps=57487, ups=4, wpb=10106.523, bsz=617.862, num_updates=1.40465e+06, lr=2.66818e-05, gnorm=1.146, clip=0.000, oom=0.000, loss_scale=2.000, wall=1680, train_wall=537001
Invalid bert_input shape:torch.Size([4, 758])
| epoch 096:   8000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57586, ups=4, wpb=10114.591, bsz=617.430, num_updates=1.40565e+06, lr=2.66723e-05, gnorm=1.146, clip=0.000, oom=0.000, loss_scale=2.000, wall=1854, train_wall=537156
Invalid bert_input shape:torch.Size([8, 844])
| epoch 096:   9000 / 49553 loss=3.830, nll_loss=2.166, ppl=4.49, wps=57501, ups=4, wpb=10099.600, bsz=618.763, num_updates=1.40665e+06, lr=2.66629e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=4.000, wall=2030, train_wall=537312
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 096:  10000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57523, ups=5, wpb=10106.216, bsz=618.366, num_updates=1.40765e+06, lr=2.66534e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=2.000, wall=2206, train_wall=537469
| epoch 096:  11000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57545, ups=5, wpb=10107.621, bsz=617.689, num_updates=1.40865e+06, lr=2.66439e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=2.000, wall=2381, train_wall=537626
| epoch 096:  12000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57563, ups=5, wpb=10112.365, bsz=617.419, num_updates=1.40965e+06, lr=2.66345e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=2.000, wall=2557, train_wall=537784
| epoch 096:  13000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57510, ups=5, wpb=10107.376, bsz=618.128, num_updates=1.41065e+06, lr=2.6625e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=2.000, wall=2734, train_wall=537942
| epoch 096:  14000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57470, ups=5, wpb=10107.132, bsz=618.317, num_updates=1.41165e+06, lr=2.66156e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=4.000, wall=2911, train_wall=538100
| epoch 096:  15000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57468, ups=5, wpb=10109.611, bsz=618.224, num_updates=1.41265e+06, lr=2.66062e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=4.000, wall=3088, train_wall=538258
| epoch 096:  16000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57390, ups=5, wpb=10106.248, bsz=618.697, num_updates=1.41365e+06, lr=2.65968e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=4.000, wall=3266, train_wall=538418
| epoch 096:  17000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57390, ups=5, wpb=10106.871, bsz=618.756, num_updates=1.41465e+06, lr=2.65874e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=4.000, wall=3443, train_wall=538576
| epoch 096:  18000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57385, ups=5, wpb=10106.107, bsz=618.585, num_updates=1.41565e+06, lr=2.6578e-05, gnorm=1.149, clip=0.000, oom=0.000, loss_scale=8.000, wall=3619, train_wall=538731
| epoch 096:  19000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57411, ups=5, wpb=10106.879, bsz=618.222, num_updates=1.41665e+06, lr=2.65686e-05, gnorm=1.150, clip=0.000, oom=0.000, loss_scale=8.000, wall=3794, train_wall=538888
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 096:  20000 / 49553 loss=3.831, nll_loss=2.167, ppl=4.49, wps=57439, ups=5, wpb=10106.460, bsz=618.439, num_updates=1.41765e+06, lr=2.65592e-05, gnorm=1.150, clip=0.000, oom=0.000, loss_scale=4.000, wall=3968, train_wall=539043
| epoch 096:  21000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57429, ups=5, wpb=10104.468, bsz=618.225, num_updates=1.41865e+06, lr=2.65499e-05, gnorm=1.150, clip=0.000, oom=0.000, loss_scale=4.000, wall=4144, train_wall=539199
| epoch 096:  22000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57439, ups=5, wpb=10103.933, bsz=618.015, num_updates=1.41965e+06, lr=2.65405e-05, gnorm=1.150, clip=0.000, oom=0.000, loss_scale=4.000, wall=4319, train_wall=539355
| epoch 096:  23000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57493, ups=5, wpb=10109.607, bsz=618.406, num_updates=1.42065e+06, lr=2.65312e-05, gnorm=1.150, clip=0.000, oom=0.000, loss_scale=4.000, wall=4493, train_wall=539510
| epoch 096:  24000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57483, ups=5, wpb=10107.584, bsz=617.896, num_updates=1.42165e+06, lr=2.65218e-05, gnorm=1.150, clip=0.000, oom=0.000, loss_scale=8.000, wall=4669, train_wall=539666
Invalid bert_input shape:torch.Size([2, 1608])
| epoch 096:  25000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57478, ups=5, wpb=10102.557, bsz=618.782, num_updates=1.42265e+06, lr=2.65125e-05, gnorm=1.150, clip=0.000, oom=0.000, loss_scale=8.000, wall=4843, train_wall=539822
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 096:  26000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57494, ups=5, wpb=10102.180, bsz=619.082, num_updates=1.42365e+06, lr=2.65032e-05, gnorm=1.150, clip=0.000, oom=0.000, loss_scale=4.000, wall=5017, train_wall=539977
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 096:  27000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57487, ups=5, wpb=10102.360, bsz=619.026, num_updates=1.42465e+06, lr=2.64939e-05, gnorm=1.150, clip=0.000, oom=0.000, loss_scale=2.000, wall=5193, train_wall=540133
Invalid bert_input shape:torch.Size([7, 573])
| epoch 096:  28000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57511, ups=5, wpb=10102.433, bsz=619.165, num_updates=1.42565e+06, lr=2.64846e-05, gnorm=1.150, clip=0.000, oom=0.000, loss_scale=2.000, wall=5367, train_wall=540287
Invalid bert_input shape:torch.Size([7, 865])
Invalid bert_input shape:torch.Size([6, 566])
| epoch 096:  29000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57516, ups=5, wpb=10100.240, bsz=619.211, num_updates=1.42665e+06, lr=2.64753e-05, gnorm=1.151, clip=0.000, oom=0.000, loss_scale=2.000, wall=5541, train_wall=540443
Invalid bert_input shape:torch.Size([6, 595])
Invalid bert_input shape:torch.Size([4, 823])
| epoch 096:  30000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57512, ups=5, wpb=10099.851, bsz=618.742, num_updates=1.42765e+06, lr=2.64661e-05, gnorm=1.151, clip=0.000, oom=0.000, loss_scale=2.000, wall=5717, train_wall=540600
Invalid bert_input shape:torch.Size([7, 900])
| epoch 096:  31000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57472, ups=5, wpb=10097.745, bsz=618.696, num_updates=1.42865e+06, lr=2.64568e-05, gnorm=1.151, clip=0.000, oom=0.000, loss_scale=4.000, wall=5895, train_wall=540751
Invalid bert_input shape:torch.Size([6, 547])
| epoch 096:  32000 / 49553 loss=3.830, nll_loss=2.166, ppl=4.49, wps=57457, ups=5, wpb=10099.522, bsz=618.518, num_updates=1.42965e+06, lr=2.64475e-05, gnorm=1.151, clip=0.000, oom=0.000, loss_scale=4.000, wall=6073, train_wall=540903
| epoch 096:  33000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57444, ups=5, wpb=10100.537, bsz=618.297, num_updates=1.43065e+06, lr=2.64383e-05, gnorm=1.151, clip=0.000, oom=0.000, loss_scale=4.000, wall=6251, train_wall=541059
| epoch 096:  34000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57472, ups=5, wpb=10103.005, bsz=618.145, num_updates=1.43165e+06, lr=2.64291e-05, gnorm=1.151, clip=0.000, oom=0.000, loss_scale=4.000, wall=6425, train_wall=541215
| epoch 096:  35000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57476, ups=5, wpb=10101.674, bsz=618.247, num_updates=1.43265e+06, lr=2.64198e-05, gnorm=1.151, clip=0.000, oom=0.000, loss_scale=8.000, wall=6600, train_wall=541371
| WARNING: overflow detected, setting loss scale to: 4.0
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 096:  36000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57470, ups=5, wpb=10102.299, bsz=618.168, num_updates=1.43365e+06, lr=2.64106e-05, gnorm=1.152, clip=0.000, oom=0.000, loss_scale=2.000, wall=6776, train_wall=541526
Invalid bert_input shape:torch.Size([3, 1514])
| epoch 096:  37000 / 49553 loss=3.831, nll_loss=2.169, ppl=4.50, wps=57485, ups=5, wpb=10102.601, bsz=618.133, num_updates=1.43465e+06, lr=2.64014e-05, gnorm=1.152, clip=0.000, oom=0.000, loss_scale=2.000, wall=6950, train_wall=541682
Invalid bert_input shape:torch.Size([4, 721])
| epoch 096:  38000 / 49553 loss=3.832, nll_loss=2.169, ppl=4.50, wps=57487, ups=5, wpb=10100.615, bsz=618.121, num_updates=1.43565e+06, lr=2.63922e-05, gnorm=1.152, clip=0.000, oom=0.000, loss_scale=2.000, wall=7125, train_wall=541837
| epoch 096:  39000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.50, wps=57485, ups=5, wpb=10100.797, bsz=618.375, num_updates=1.43665e+06, lr=2.63831e-05, gnorm=1.152, clip=0.000, oom=0.000, loss_scale=2.000, wall=7301, train_wall=541993
| epoch 096:  40000 / 49553 loss=3.832, nll_loss=2.169, ppl=4.50, wps=57501, ups=5, wpb=10101.623, bsz=618.365, num_updates=1.43765e+06, lr=2.63739e-05, gnorm=1.153, clip=0.000, oom=0.000, loss_scale=4.000, wall=7475, train_wall=542149
| epoch 096:  41000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57502, ups=5, wpb=10100.270, bsz=618.419, num_updates=1.43865e+06, lr=2.63647e-05, gnorm=1.153, clip=0.000, oom=0.000, loss_scale=4.000, wall=7650, train_wall=542304
| epoch 096:  42000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57497, ups=5, wpb=10101.773, bsz=618.269, num_updates=1.43965e+06, lr=2.63556e-05, gnorm=1.153, clip=0.000, oom=0.000, loss_scale=4.000, wall=7827, train_wall=542463
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 096:  43000 / 49553 loss=3.831, nll_loss=2.169, ppl=4.50, wps=57508, ups=5, wpb=10101.459, bsz=618.604, num_updates=1.44064e+06, lr=2.63464e-05, gnorm=1.153, clip=0.000, oom=0.000, loss_scale=2.000, wall=8001, train_wall=542619
| epoch 096:  44000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.50, wps=57517, ups=5, wpb=10100.991, bsz=618.732, num_updates=1.44164e+06, lr=2.63373e-05, gnorm=1.153, clip=0.000, oom=0.000, loss_scale=2.000, wall=8175, train_wall=542775
| epoch 096:  45000 / 49553 loss=3.831, nll_loss=2.169, ppl=4.50, wps=57516, ups=5, wpb=10101.347, bsz=618.791, num_updates=1.44264e+06, lr=2.63281e-05, gnorm=1.153, clip=0.000, oom=0.000, loss_scale=2.000, wall=8351, train_wall=542930
| epoch 096:  46000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57517, ups=5, wpb=10100.072, bsz=618.791, num_updates=1.44364e+06, lr=2.6319e-05, gnorm=1.153, clip=0.000, oom=0.000, loss_scale=2.000, wall=8526, train_wall=543086
| epoch 096:  47000 / 49553 loss=3.831, nll_loss=2.168, ppl=4.49, wps=57518, ups=5, wpb=10099.099, bsz=618.946, num_updates=1.44464e+06, lr=2.63099e-05, gnorm=1.153, clip=0.000, oom=0.000, loss_scale=4.000, wall=8700, train_wall=543242
| epoch 096:  48000 / 49553 loss=3.832, nll_loss=2.169, ppl=4.50, wps=57514, ups=5, wpb=10098.580, bsz=619.003, num_updates=1.44564e+06, lr=2.63008e-05, gnorm=1.154, clip=0.000, oom=0.000, loss_scale=4.000, wall=8876, train_wall=543399
Invalid bert_input shape:torch.Size([6, 575])
| epoch 096:  49000 / 49553 loss=3.832, nll_loss=2.169, ppl=4.50, wps=57526, ups=5, wpb=10099.182, bsz=618.771, num_updates=1.44664e+06, lr=2.62917e-05, gnorm=1.154, clip=0.000, oom=0.000, loss_scale=4.000, wall=9050, train_wall=543555
| epoch 096 | loss 3.831 | nll_loss 2.169 | ppl 4.50 | wps 57535 | ups 5 | wpb 10099.907 | bsz 618.639 | num_updates 1.4472e+06 | lr 2.62867e-05 | gnorm 1.154 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 9146 | train_wall 543641
| epoch 096 | valid on 'valid' subset | loss 2.749 | nll_loss 0.934 | ppl 1.91 | num_updates 1.4472e+06 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint96.pt (epoch 96 @ 1447197 updates) (writing took 8.158715724945068 seconds)
| epoch 097:   1000 / 49553 loss=3.815, nll_loss=2.150, ppl=4.44, wps=57235, ups=3, wpb=10149.756, bsz=611.245, num_updates=1.4482e+06, lr=2.62776e-05, gnorm=1.155, clip=0.000, oom=0.000, loss_scale=4.000, wall=9460, train_wall=543807
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 097:   2000 / 49553 loss=3.817, nll_loss=2.152, ppl=4.44, wps=57307, ups=4, wpb=10104.004, bsz=618.288, num_updates=1.4492e+06, lr=2.62686e-05, gnorm=1.163, clip=0.000, oom=0.000, loss_scale=4.000, wall=9635, train_wall=543962
Invalid bert_input shape:torch.Size([3, 1119])
| epoch 097:   3000 / 49553 loss=3.823, nll_loss=2.159, ppl=4.47, wps=57438, ups=5, wpb=10103.133, bsz=619.515, num_updates=1.4502e+06, lr=2.62595e-05, gnorm=1.164, clip=0.000, oom=0.000, loss_scale=4.000, wall=9810, train_wall=544118
| epoch 097:   4000 / 49553 loss=3.825, nll_loss=2.161, ppl=4.47, wps=57431, ups=5, wpb=10104.365, bsz=619.754, num_updates=1.4512e+06, lr=2.62505e-05, gnorm=1.163, clip=0.000, oom=0.000, loss_scale=4.000, wall=9986, train_wall=544275
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 097:   5000 / 49553 loss=3.823, nll_loss=2.159, ppl=4.47, wps=57532, ups=5, wpb=10100.880, bsz=618.724, num_updates=1.4522e+06, lr=2.62414e-05, gnorm=1.163, clip=0.000, oom=0.000, loss_scale=2.000, wall=10160, train_wall=544430
| WARNING: overflow detected, setting loss scale to: 1.0
| epoch 097:   6000 / 49553 loss=3.823, nll_loss=2.159, ppl=4.47, wps=57643, ups=5, wpb=10110.370, bsz=619.134, num_updates=1.4532e+06, lr=2.62324e-05, gnorm=1.162, clip=0.000, oom=0.000, loss_scale=1.000, wall=10334, train_wall=544586
| epoch 097:   7000 / 49553 loss=3.821, nll_loss=2.157, ppl=4.46, wps=57633, ups=5, wpb=10110.912, bsz=619.242, num_updates=1.4542e+06, lr=2.62234e-05, gnorm=1.161, clip=0.000, oom=0.000, loss_scale=1.000, wall=10510, train_wall=544743
| epoch 097:   8000 / 49553 loss=3.820, nll_loss=2.156, ppl=4.46, wps=57664, ups=5, wpb=10112.889, bsz=619.306, num_updates=1.4552e+06, lr=2.62144e-05, gnorm=1.162, clip=0.000, oom=0.000, loss_scale=1.000, wall=10685, train_wall=544900
| epoch 097:   9000 / 49553 loss=3.820, nll_loss=2.156, ppl=4.46, wps=57734, ups=5, wpb=10122.464, bsz=618.018, num_updates=1.4562e+06, lr=2.62054e-05, gnorm=1.163, clip=0.000, oom=0.000, loss_scale=1.000, wall=10860, train_wall=545056
| epoch 097:  10000 / 49553 loss=3.821, nll_loss=2.157, ppl=4.46, wps=57555, ups=5, wpb=10118.816, bsz=618.229, num_updates=1.4572e+06, lr=2.61964e-05, gnorm=1.163, clip=0.000, oom=0.000, loss_scale=2.000, wall=11040, train_wall=545208
| epoch 097:  11000 / 49553 loss=3.819, nll_loss=2.155, ppl=4.45, wps=57517, ups=5, wpb=10118.424, bsz=616.688, num_updates=1.4582e+06, lr=2.61874e-05, gnorm=1.163, clip=0.000, oom=0.000, loss_scale=2.000, wall=11217, train_wall=545361
Invalid bert_input shape:torch.Size([7, 573])
| epoch 097:  12000 / 49553 loss=3.819, nll_loss=2.155, ppl=4.45, wps=57523, ups=5, wpb=10113.903, bsz=616.604, num_updates=1.4592e+06, lr=2.61784e-05, gnorm=1.163, clip=0.000, oom=0.000, loss_scale=2.000, wall=11392, train_wall=545516
| epoch 097:  13000 / 49553 loss=3.820, nll_loss=2.156, ppl=4.46, wps=57541, ups=5, wpb=10114.833, bsz=617.099, num_updates=1.4602e+06, lr=2.61694e-05, gnorm=1.163, clip=0.000, oom=0.000, loss_scale=2.000, wall=11567, train_wall=545672
| epoch 097:  14000 / 49553 loss=3.821, nll_loss=2.157, ppl=4.46, wps=57541, ups=5, wpb=10110.217, bsz=617.801, num_updates=1.4612e+06, lr=2.61605e-05, gnorm=1.164, clip=0.000, oom=0.000, loss_scale=4.000, wall=11742, train_wall=545828
| epoch 097:  15000 / 49553 loss=3.822, nll_loss=2.158, ppl=4.46, wps=57541, ups=5, wpb=10109.340, bsz=616.979, num_updates=1.4622e+06, lr=2.61515e-05, gnorm=1.165, clip=0.000, oom=0.000, loss_scale=4.000, wall=11917, train_wall=545984
| epoch 097:  16000 / 49553 loss=3.823, nll_loss=2.159, ppl=4.47, wps=57516, ups=5, wpb=10105.386, bsz=616.633, num_updates=1.4632e+06, lr=2.61426e-05, gnorm=1.165, clip=0.000, oom=0.000, loss_scale=4.000, wall=12093, train_wall=546141
| epoch 097:  17000 / 49553 loss=3.824, nll_loss=2.160, ppl=4.47, wps=57535, ups=5, wpb=10100.724, bsz=617.086, num_updates=1.4642e+06, lr=2.61337e-05, gnorm=1.166, clip=0.000, oom=0.000, loss_scale=4.000, wall=12266, train_wall=546296
Invalid bert_input shape:torch.Size([7, 600])
| epoch 097:  18000 / 49553 loss=3.825, nll_loss=2.161, ppl=4.47, wps=57543, ups=5, wpb=10099.947, bsz=617.601, num_updates=1.4652e+06, lr=2.61248e-05, gnorm=1.167, clip=0.000, oom=0.000, loss_scale=4.000, wall=12441, train_wall=546452
| epoch 097:  19000 / 49553 loss=3.825, nll_loss=2.161, ppl=4.47, wps=57566, ups=5, wpb=10102.702, bsz=617.427, num_updates=1.4662e+06, lr=2.61158e-05, gnorm=1.166, clip=0.000, oom=0.000, loss_scale=8.000, wall=12616, train_wall=546609
| WARNING: overflow detected, setting loss scale to: 4.0
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 097:  20000 / 49553 loss=3.826, nll_loss=2.162, ppl=4.48, wps=57584, ups=5, wpb=10103.672, bsz=617.534, num_updates=1.46719e+06, lr=2.6107e-05, gnorm=1.166, clip=0.000, oom=0.000, loss_scale=2.000, wall=12791, train_wall=546765
| epoch 097:  21000 / 49553 loss=3.825, nll_loss=2.161, ppl=4.47, wps=57585, ups=5, wpb=10102.959, bsz=617.328, num_updates=1.46819e+06, lr=2.60981e-05, gnorm=1.166, clip=0.000, oom=0.000, loss_scale=2.000, wall=12966, train_wall=546921
| WARNING: overflow detected, setting loss scale to: 1.0
| epoch 097:  22000 / 49553 loss=3.826, nll_loss=2.162, ppl=4.48, wps=57583, ups=6, wpb=10103.470, bsz=617.889, num_updates=1.46919e+06, lr=2.60892e-05, gnorm=1.166, clip=0.000, oom=0.000, loss_scale=1.000, wall=13141, train_wall=547077
| epoch 097:  23000 / 49553 loss=3.826, nll_loss=2.162, ppl=4.48, wps=57580, ups=6, wpb=10104.602, bsz=617.737, num_updates=1.47019e+06, lr=2.60803e-05, gnorm=1.167, clip=0.000, oom=0.000, loss_scale=1.000, wall=13318, train_wall=547234
| epoch 097:  24000 / 49553 loss=3.826, nll_loss=2.163, ppl=4.48, wps=57526, ups=6, wpb=10103.848, bsz=617.754, num_updates=1.47119e+06, lr=2.60715e-05, gnorm=1.168, clip=0.000, oom=0.000, loss_scale=1.000, wall=13497, train_wall=547394
Invalid bert_input shape:torch.Size([7, 900])
| epoch 097:  25000 / 49553 loss=3.826, nll_loss=2.163, ppl=4.48, wps=57464, ups=6, wpb=10103.275, bsz=617.782, num_updates=1.47219e+06, lr=2.60626e-05, gnorm=1.168, clip=0.000, oom=0.000, loss_scale=1.000, wall=13677, train_wall=547556
Invalid bert_input shape:torch.Size([5, 729])
| epoch 097:  26000 / 49553 loss=3.826, nll_loss=2.162, ppl=4.48, wps=57457, ups=6, wpb=10102.721, bsz=618.193, num_updates=1.47319e+06, lr=2.60538e-05, gnorm=1.168, clip=0.000, oom=0.000, loss_scale=2.000, wall=13853, train_wall=547712
| epoch 097:  27000 / 49553 loss=3.826, nll_loss=2.163, ppl=4.48, wps=57416, ups=6, wpb=10102.472, bsz=618.317, num_updates=1.47419e+06, lr=2.60449e-05, gnorm=1.169, clip=0.000, oom=0.000, loss_scale=2.000, wall=14032, train_wall=547871
| epoch 097:  28000 / 49553 loss=3.827, nll_loss=2.163, ppl=4.48, wps=57418, ups=6, wpb=10102.671, bsz=618.241, num_updates=1.47519e+06, lr=2.60361e-05, gnorm=1.169, clip=0.000, oom=0.000, loss_scale=2.000, wall=14208, train_wall=548028
Invalid bert_input shape:torch.Size([5, 704])
| epoch 097:  29000 / 49553 loss=3.827, nll_loss=2.163, ppl=4.48, wps=57427, ups=6, wpb=10103.234, bsz=618.347, num_updates=1.47619e+06, lr=2.60273e-05, gnorm=1.169, clip=0.000, oom=0.000, loss_scale=2.000, wall=14383, train_wall=548184
Invalid bert_input shape:torch.Size([6, 863])
| epoch 097:  30000 / 49553 loss=3.827, nll_loss=2.163, ppl=4.48, wps=57407, ups=6, wpb=10103.498, bsz=618.882, num_updates=1.47719e+06, lr=2.60185e-05, gnorm=1.170, clip=0.000, oom=0.000, loss_scale=4.000, wall=14561, train_wall=548344
| epoch 097:  31000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57396, ups=6, wpb=10103.447, bsz=618.818, num_updates=1.47819e+06, lr=2.60097e-05, gnorm=1.169, clip=0.000, oom=0.000, loss_scale=4.000, wall=14738, train_wall=548501
| epoch 097:  32000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57411, ups=6, wpb=10102.506, bsz=618.830, num_updates=1.47919e+06, lr=2.60009e-05, gnorm=1.169, clip=0.000, oom=0.000, loss_scale=4.000, wall=14912, train_wall=548657
| epoch 097:  33000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57411, ups=6, wpb=10102.293, bsz=618.910, num_updates=1.48019e+06, lr=2.59921e-05, gnorm=1.170, clip=0.000, oom=0.000, loss_scale=4.000, wall=15088, train_wall=548814
Invalid bert_input shape:torch.Size([5, 703])
| epoch 097:  34000 / 49553 loss=3.828, nll_loss=2.164, ppl=4.48, wps=57430, ups=6, wpb=10102.105, bsz=618.780, num_updates=1.48119e+06, lr=2.59833e-05, gnorm=1.170, clip=0.000, oom=0.000, loss_scale=8.000, wall=15262, train_wall=548969
Invalid bert_input shape:torch.Size([2, 1513])
| WARNING: overflow detected, setting loss scale to: 4.0
Invalid bert_input shape:torch.Size([6, 575])
| epoch 097:  35000 / 49553 loss=3.828, nll_loss=2.164, ppl=4.48, wps=57416, ups=6, wpb=10102.951, bsz=618.827, num_updates=1.48219e+06, lr=2.59745e-05, gnorm=1.170, clip=0.000, oom=0.000, loss_scale=4.000, wall=15440, train_wall=549129
Invalid bert_input shape:torch.Size([5, 627])
| epoch 097:  36000 / 49553 loss=3.828, nll_loss=2.165, ppl=4.48, wps=57421, ups=6, wpb=10100.939, bsz=619.033, num_updates=1.48319e+06, lr=2.59658e-05, gnorm=1.170, clip=0.000, oom=0.000, loss_scale=4.000, wall=15614, train_wall=549283
Invalid bert_input shape:torch.Size([5, 616])
| epoch 097:  37000 / 49553 loss=3.828, nll_loss=2.165, ppl=4.48, wps=57422, ups=6, wpb=10099.027, bsz=618.847, num_updates=1.48419e+06, lr=2.5957e-05, gnorm=1.170, clip=0.000, oom=0.000, loss_scale=4.000, wall=15788, train_wall=549440
Invalid bert_input shape:torch.Size([4, 758])
| epoch 097:  38000 / 49553 loss=3.828, nll_loss=2.165, ppl=4.49, wps=57422, ups=6, wpb=10096.983, bsz=618.710, num_updates=1.48519e+06, lr=2.59483e-05, gnorm=1.171, clip=0.000, oom=0.000, loss_scale=4.000, wall=15963, train_wall=549595
| epoch 097:  39000 / 49553 loss=3.829, nll_loss=2.165, ppl=4.49, wps=57436, ups=6, wpb=10097.596, bsz=618.868, num_updates=1.48619e+06, lr=2.59396e-05, gnorm=1.171, clip=0.000, oom=0.000, loss_scale=8.000, wall=16138, train_wall=549751
| epoch 097:  40000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57451, ups=6, wpb=10097.871, bsz=618.731, num_updates=1.48719e+06, lr=2.59308e-05, gnorm=1.171, clip=0.000, oom=0.000, loss_scale=8.000, wall=16312, train_wall=549907
| WARNING: overflow detected, setting loss scale to: 4.0
| epoch 097:  41000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57466, ups=6, wpb=10099.084, bsz=618.642, num_updates=1.48819e+06, lr=2.59221e-05, gnorm=1.171, clip=0.000, oom=0.000, loss_scale=4.000, wall=16486, train_wall=550063
| epoch 097:  42000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57471, ups=6, wpb=10099.311, bsz=618.686, num_updates=1.48919e+06, lr=2.59134e-05, gnorm=1.171, clip=0.000, oom=0.000, loss_scale=4.000, wall=16662, train_wall=550218
| epoch 097:  43000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57472, ups=6, wpb=10098.122, bsz=619.086, num_updates=1.49019e+06, lr=2.59047e-05, gnorm=1.172, clip=0.000, oom=0.000, loss_scale=4.000, wall=16836, train_wall=550374
| epoch 097:  44000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57463, ups=6, wpb=10097.721, bsz=619.337, num_updates=1.49119e+06, lr=2.5896e-05, gnorm=1.172, clip=0.000, oom=0.000, loss_scale=4.000, wall=17013, train_wall=550531
| epoch 097:  45000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57473, ups=6, wpb=10097.683, bsz=619.118, num_updates=1.49219e+06, lr=2.58874e-05, gnorm=1.172, clip=0.000, oom=0.000, loss_scale=8.000, wall=17187, train_wall=550686
| WARNING: overflow detected, setting loss scale to: 4.0
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 097:  46000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57480, ups=6, wpb=10098.130, bsz=619.239, num_updates=1.49319e+06, lr=2.58787e-05, gnorm=1.172, clip=0.000, oom=0.000, loss_scale=2.000, wall=17362, train_wall=550842
Invalid bert_input shape:torch.Size([5, 795])
| epoch 097:  47000 / 49553 loss=3.830, nll_loss=2.167, ppl=4.49, wps=57473, ups=6, wpb=10098.830, bsz=619.099, num_updates=1.49419e+06, lr=2.58701e-05, gnorm=1.172, clip=0.000, oom=0.000, loss_scale=2.000, wall=17539, train_wall=551001
| epoch 097:  48000 / 49553 loss=3.830, nll_loss=2.168, ppl=4.49, wps=57481, ups=6, wpb=10098.687, bsz=618.865, num_updates=1.49519e+06, lr=2.58614e-05, gnorm=1.172, clip=0.000, oom=0.000, loss_scale=2.000, wall=17714, train_wall=551157
Invalid bert_input shape:torch.Size([4, 800])
| epoch 097:  49000 / 49553 loss=3.830, nll_loss=2.168, ppl=4.49, wps=57489, ups=6, wpb=10099.480, bsz=618.790, num_updates=1.49619e+06, lr=2.58528e-05, gnorm=1.172, clip=0.000, oom=0.000, loss_scale=2.000, wall=17889, train_wall=551314
| epoch 097 | loss 3.831 | nll_loss 2.168 | ppl 4.49 | wps 57494 | ups 6 | wpb 10099.924 | bsz 618.677 | num_updates 1.49674e+06 | lr 2.5848e-05 | gnorm 1.172 | clip 0.000 | oom 0.000 | loss_scale 2.000 | wall 17985 | train_wall 551400
| epoch 097 | valid on 'valid' subset | loss 2.749 | nll_loss 0.936 | ppl 1.91 | num_updates 1.49674e+06 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint97.pt (epoch 97 @ 1496740 updates) (writing took 7.012346982955933 seconds)
Invalid bert_input shape:torch.Size([3, 1119])
| epoch 098:   1000 / 49553 loss=3.822, nll_loss=2.157, ppl=4.46, wps=56883, ups=3, wpb=10110.007, bsz=625.151, num_updates=1.49774e+06, lr=2.58394e-05, gnorm=1.172, clip=0.000, oom=0.000, loss_scale=4.000, wall=18296, train_wall=551552
| epoch 098:   2000 / 49553 loss=3.813, nll_loss=2.148, ppl=4.43, wps=56659, ups=4, wpb=10111.798, bsz=628.505, num_updates=1.49874e+06, lr=2.58307e-05, gnorm=1.174, clip=0.000, oom=0.000, loss_scale=4.000, wall=18475, train_wall=551708
Invalid bert_input shape:torch.Size([5, 1524])
Invalid bert_input shape:torch.Size([6, 589])
| epoch 098:   3000 / 49553 loss=3.817, nll_loss=2.153, ppl=4.45, wps=56861, ups=4, wpb=10130.146, bsz=622.717, num_updates=1.49974e+06, lr=2.58221e-05, gnorm=1.174, clip=0.000, oom=0.000, loss_scale=4.000, wall=18653, train_wall=551864
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 098:   4000 / 49553 loss=3.816, nll_loss=2.151, ppl=4.44, wps=57167, ups=5, wpb=10128.129, bsz=620.524, num_updates=1.50074e+06, lr=2.58135e-05, gnorm=1.175, clip=0.000, oom=0.000, loss_scale=2.000, wall=18827, train_wall=552018
Invalid bert_input shape:torch.Size([5, 674])
| epoch 098:   5000 / 49553 loss=3.818, nll_loss=2.153, ppl=4.45, wps=57312, ups=5, wpb=10124.821, bsz=618.612, num_updates=1.50174e+06, lr=2.58049e-05, gnorm=1.176, clip=0.000, oom=0.000, loss_scale=2.000, wall=19002, train_wall=552174
Invalid bert_input shape:torch.Size([7, 900])
| epoch 098:   6000 / 49553 loss=3.818, nll_loss=2.153, ppl=4.45, wps=57410, ups=5, wpb=10133.585, bsz=617.753, num_updates=1.50274e+06, lr=2.57963e-05, gnorm=1.175, clip=0.000, oom=0.000, loss_scale=2.000, wall=19177, train_wall=552331
| epoch 098:   7000 / 49553 loss=3.821, nll_loss=2.156, ppl=4.46, wps=57477, ups=5, wpb=10126.265, bsz=617.155, num_updates=1.50374e+06, lr=2.57878e-05, gnorm=1.177, clip=0.000, oom=0.000, loss_scale=2.000, wall=19352, train_wall=552486
| epoch 098:   8000 / 49553 loss=3.823, nll_loss=2.159, ppl=4.47, wps=57539, ups=5, wpb=10129.312, bsz=617.368, num_updates=1.50474e+06, lr=2.57792e-05, gnorm=1.178, clip=0.000, oom=0.000, loss_scale=4.000, wall=19527, train_wall=552642
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 098:   9000 / 49553 loss=3.821, nll_loss=2.157, ppl=4.46, wps=57538, ups=5, wpb=10126.350, bsz=617.338, num_updates=1.50574e+06, lr=2.57706e-05, gnorm=1.178, clip=0.000, oom=0.000, loss_scale=2.000, wall=19702, train_wall=552799
Invalid bert_input shape:torch.Size([4, 720])
| epoch 098:  10000 / 49553 loss=3.822, nll_loss=2.158, ppl=4.46, wps=57597, ups=5, wpb=10128.006, bsz=617.033, num_updates=1.50674e+06, lr=2.57621e-05, gnorm=1.179, clip=0.000, oom=0.000, loss_scale=2.000, wall=19877, train_wall=552955
Invalid bert_input shape:torch.Size([5, 666])
| epoch 098:  11000 / 49553 loss=3.823, nll_loss=2.159, ppl=4.47, wps=57613, ups=5, wpb=10127.153, bsz=618.312, num_updates=1.50774e+06, lr=2.57535e-05, gnorm=1.180, clip=0.000, oom=0.000, loss_scale=2.000, wall=20052, train_wall=553111
| epoch 098:  12000 / 49553 loss=3.824, nll_loss=2.160, ppl=4.47, wps=57638, ups=5, wpb=10131.675, bsz=618.135, num_updates=1.50874e+06, lr=2.5745e-05, gnorm=1.180, clip=0.000, oom=0.000, loss_scale=2.000, wall=20228, train_wall=553268
| epoch 098:  13000 / 49553 loss=3.825, nll_loss=2.161, ppl=4.47, wps=57706, ups=5, wpb=10134.815, bsz=618.327, num_updates=1.50974e+06, lr=2.57365e-05, gnorm=1.180, clip=0.000, oom=0.000, loss_scale=4.000, wall=20401, train_wall=553423
| epoch 098:  14000 / 49553 loss=3.824, nll_loss=2.160, ppl=4.47, wps=57699, ups=5, wpb=10131.162, bsz=618.489, num_updates=1.51074e+06, lr=2.5728e-05, gnorm=1.180, clip=0.000, oom=0.000, loss_scale=4.000, wall=20576, train_wall=553579
| epoch 098:  15000 / 49553 loss=3.824, nll_loss=2.161, ppl=4.47, wps=57723, ups=5, wpb=10133.318, bsz=618.135, num_updates=1.51174e+06, lr=2.57194e-05, gnorm=1.180, clip=0.000, oom=0.000, loss_scale=4.000, wall=20751, train_wall=553736
| epoch 098:  16000 / 49553 loss=3.824, nll_loss=2.160, ppl=4.47, wps=57728, ups=5, wpb=10129.100, bsz=618.900, num_updates=1.51274e+06, lr=2.57109e-05, gnorm=1.180, clip=0.000, oom=0.000, loss_scale=4.000, wall=20926, train_wall=553890
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 098:  17000 / 49553 loss=3.824, nll_loss=2.161, ppl=4.47, wps=57723, ups=5, wpb=10126.328, bsz=618.513, num_updates=1.51374e+06, lr=2.57025e-05, gnorm=1.180, clip=0.000, oom=0.000, loss_scale=2.000, wall=21100, train_wall=554046
| WARNING: overflow detected, setting loss scale to: 1.0
Invalid bert_input shape:torch.Size([5, 701])
| epoch 098:  18000 / 49553 loss=3.824, nll_loss=2.160, ppl=4.47, wps=57715, ups=5, wpb=10123.978, bsz=618.555, num_updates=1.51474e+06, lr=2.5694e-05, gnorm=1.180, clip=0.000, oom=0.000, loss_scale=1.000, wall=21275, train_wall=554202
| epoch 098:  19000 / 49553 loss=3.824, nll_loss=2.160, ppl=4.47, wps=57737, ups=5, wpb=10123.144, bsz=618.219, num_updates=1.51574e+06, lr=2.56855e-05, gnorm=1.180, clip=0.000, oom=0.000, loss_scale=1.000, wall=21449, train_wall=554358
| epoch 098:  20000 / 49553 loss=3.824, nll_loss=2.161, ppl=4.47, wps=57710, ups=5, wpb=10119.049, bsz=618.387, num_updates=1.51674e+06, lr=2.5677e-05, gnorm=1.182, clip=0.000, oom=0.000, loss_scale=1.000, wall=21625, train_wall=554514
| epoch 098:  21000 / 49553 loss=3.825, nll_loss=2.162, ppl=4.47, wps=57720, ups=6, wpb=10119.301, bsz=618.121, num_updates=1.51774e+06, lr=2.56686e-05, gnorm=1.181, clip=0.000, oom=0.000, loss_scale=1.000, wall=21799, train_wall=554670
Invalid bert_input shape:torch.Size([5, 656])
| epoch 098:  22000 / 49553 loss=3.826, nll_loss=2.162, ppl=4.48, wps=57724, ups=6, wpb=10117.479, bsz=618.131, num_updates=1.51874e+06, lr=2.56601e-05, gnorm=1.182, clip=0.000, oom=0.000, loss_scale=2.000, wall=21974, train_wall=554826
| epoch 098:  23000 / 49553 loss=3.826, nll_loss=2.162, ppl=4.48, wps=57661, ups=6, wpb=10114.204, bsz=618.333, num_updates=1.51974e+06, lr=2.56517e-05, gnorm=1.182, clip=0.000, oom=0.000, loss_scale=2.000, wall=22152, train_wall=554985
Invalid bert_input shape:torch.Size([4, 760])
Invalid bert_input shape:torch.Size([2, 1203])
| epoch 098:  24000 / 49553 loss=3.826, nll_loss=2.163, ppl=4.48, wps=57615, ups=6, wpb=10111.810, bsz=618.153, num_updates=1.52074e+06, lr=2.56432e-05, gnorm=1.183, clip=0.000, oom=0.000, loss_scale=2.000, wall=22330, train_wall=555144
| epoch 098:  25000 / 49553 loss=3.826, nll_loss=2.163, ppl=4.48, wps=57610, ups=6, wpb=10114.707, bsz=617.533, num_updates=1.52174e+06, lr=2.56348e-05, gnorm=1.183, clip=0.000, oom=0.000, loss_scale=2.000, wall=22507, train_wall=555302
| epoch 098:  26000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57591, ups=6, wpb=10114.704, bsz=617.878, num_updates=1.52274e+06, lr=2.56264e-05, gnorm=1.183, clip=0.000, oom=0.000, loss_scale=4.000, wall=22684, train_wall=555459
Invalid bert_input shape:torch.Size([6, 546])
Invalid bert_input shape:torch.Size([4, 758])
| epoch 098:  27000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57578, ups=6, wpb=10111.636, bsz=618.041, num_updates=1.52374e+06, lr=2.5618e-05, gnorm=1.183, clip=0.000, oom=0.000, loss_scale=4.000, wall=22859, train_wall=555614
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 098:  28000 / 49553 loss=3.828, nll_loss=2.164, ppl=4.48, wps=57549, ups=6, wpb=10111.606, bsz=617.990, num_updates=1.52474e+06, lr=2.56096e-05, gnorm=1.184, clip=0.000, oom=0.000, loss_scale=2.000, wall=23037, train_wall=555773
| epoch 098:  29000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57516, ups=6, wpb=10111.549, bsz=618.109, num_updates=1.52574e+06, lr=2.56012e-05, gnorm=1.184, clip=0.000, oom=0.000, loss_scale=2.000, wall=23216, train_wall=555926
Invalid bert_input shape:torch.Size([4, 837])
| epoch 098:  30000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57528, ups=6, wpb=10112.456, bsz=618.167, num_updates=1.52674e+06, lr=2.55928e-05, gnorm=1.184, clip=0.000, oom=0.000, loss_scale=2.000, wall=23391, train_wall=556081
Invalid bert_input shape:torch.Size([6, 575])
| epoch 098:  31000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57518, ups=6, wpb=10111.523, bsz=618.346, num_updates=1.52774e+06, lr=2.55844e-05, gnorm=1.184, clip=0.000, oom=0.000, loss_scale=2.000, wall=23567, train_wall=556236
| epoch 098:  32000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57479, ups=6, wpb=10110.622, bsz=618.476, num_updates=1.52874e+06, lr=2.55761e-05, gnorm=1.185, clip=0.000, oom=0.000, loss_scale=4.000, wall=23746, train_wall=556389
Invalid bert_input shape:torch.Size([3, 1160])
Invalid bert_input shape:torch.Size([4, 782])
| epoch 098:  33000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57446, ups=6, wpb=10110.661, bsz=618.359, num_updates=1.52974e+06, lr=2.55677e-05, gnorm=1.185, clip=0.000, oom=0.000, loss_scale=4.000, wall=23926, train_wall=556540
| epoch 098:  34000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57429, ups=6, wpb=10108.721, bsz=618.200, num_updates=1.53074e+06, lr=2.55594e-05, gnorm=1.185, clip=0.000, oom=0.000, loss_scale=4.000, wall=24102, train_wall=556695
| epoch 098:  35000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57436, ups=6, wpb=10108.205, bsz=618.388, num_updates=1.53174e+06, lr=2.5551e-05, gnorm=1.185, clip=0.000, oom=0.000, loss_scale=4.000, wall=24277, train_wall=556851
| epoch 098:  36000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57430, ups=6, wpb=10107.838, bsz=618.325, num_updates=1.53274e+06, lr=2.55427e-05, gnorm=1.185, clip=0.000, oom=0.000, loss_scale=4.000, wall=24454, train_wall=557009
| WARNING: overflow detected, setting loss scale to: 4.0
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 098:  37000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57443, ups=6, wpb=10109.906, bsz=618.484, num_updates=1.53373e+06, lr=2.55344e-05, gnorm=1.185, clip=0.000, oom=0.000, loss_scale=2.000, wall=24629, train_wall=557164
| epoch 098:  38000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57413, ups=6, wpb=10109.126, bsz=618.168, num_updates=1.53473e+06, lr=2.5526e-05, gnorm=1.185, clip=0.000, oom=0.000, loss_scale=2.000, wall=24808, train_wall=557324
| epoch 098:  39000 / 49553 loss=3.827, nll_loss=2.164, ppl=4.48, wps=57407, ups=6, wpb=10108.303, bsz=617.944, num_updates=1.53573e+06, lr=2.55177e-05, gnorm=1.186, clip=0.000, oom=0.000, loss_scale=2.000, wall=24985, train_wall=557482
| epoch 098:  40000 / 49553 loss=3.828, nll_loss=2.165, ppl=4.48, wps=57414, ups=6, wpb=10107.431, bsz=618.010, num_updates=1.53673e+06, lr=2.55094e-05, gnorm=1.186, clip=0.000, oom=0.000, loss_scale=2.000, wall=25159, train_wall=557636
| epoch 098:  41000 / 49553 loss=3.828, nll_loss=2.165, ppl=4.48, wps=57416, ups=6, wpb=10105.790, bsz=618.097, num_updates=1.53773e+06, lr=2.55011e-05, gnorm=1.186, clip=0.000, oom=0.000, loss_scale=4.000, wall=25334, train_wall=557792
| epoch 098:  42000 / 49553 loss=3.828, nll_loss=2.165, ppl=4.49, wps=57422, ups=6, wpb=10104.913, bsz=618.293, num_updates=1.53873e+06, lr=2.54928e-05, gnorm=1.186, clip=0.000, oom=0.000, loss_scale=4.000, wall=25508, train_wall=557947
Invalid bert_input shape:torch.Size([7, 600])
| epoch 098:  43000 / 49553 loss=3.828, nll_loss=2.165, ppl=4.49, wps=57415, ups=6, wpb=10103.031, bsz=618.390, num_updates=1.53973e+06, lr=2.54846e-05, gnorm=1.186, clip=0.000, oom=0.000, loss_scale=4.000, wall=25684, train_wall=558103
Invalid bert_input shape:torch.Size([6, 555])
| epoch 098:  44000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57414, ups=6, wpb=10099.933, bsz=618.127, num_updates=1.54073e+06, lr=2.54763e-05, gnorm=1.187, clip=0.000, oom=0.000, loss_scale=4.000, wall=25857, train_wall=558258
| WARNING: overflow detected, setting loss scale to: 2.0
Invalid bert_input shape:torch.Size([5, 655])
| epoch 098:  45000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57418, ups=6, wpb=10099.130, bsz=618.295, num_updates=1.54173e+06, lr=2.5468e-05, gnorm=1.187, clip=0.000, oom=0.000, loss_scale=2.000, wall=26032, train_wall=558414
Invalid bert_input shape:torch.Size([4, 843])
| epoch 098:  46000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57406, ups=6, wpb=10098.316, bsz=618.350, num_updates=1.54273e+06, lr=2.54598e-05, gnorm=1.187, clip=0.000, oom=0.000, loss_scale=2.000, wall=26209, train_wall=558572
Invalid bert_input shape:torch.Size([5, 907])
| epoch 098:  47000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57400, ups=6, wpb=10099.029, bsz=618.295, num_updates=1.54373e+06, lr=2.54515e-05, gnorm=1.187, clip=0.000, oom=0.000, loss_scale=2.000, wall=26386, train_wall=558730
Invalid bert_input shape:torch.Size([3, 944])
| epoch 098:  48000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57392, ups=6, wpb=10097.648, bsz=618.629, num_updates=1.54473e+06, lr=2.54433e-05, gnorm=1.188, clip=0.000, oom=0.000, loss_scale=2.000, wall=26562, train_wall=558887
| epoch 098:  49000 / 49553 loss=3.829, nll_loss=2.166, ppl=4.49, wps=57408, ups=6, wpb=10100.248, bsz=618.645, num_updates=1.54573e+06, lr=2.54351e-05, gnorm=1.188, clip=0.000, oom=0.000, loss_scale=4.000, wall=26738, train_wall=559043
| epoch 098 | loss 3.829 | nll_loss 2.166 | ppl 4.49 | wps 57408 | ups 6 | wpb 10099.915 | bsz 618.673 | num_updates 1.54628e+06 | lr 2.54305e-05 | gnorm 1.188 | clip 0.000 | oom 0.000 | loss_scale 4.000 | wall 26835 | train_wall 559129
| epoch 098 | valid on 'valid' subset | loss 2.753 | nll_loss 0.939 | ppl 1.92 | num_updates 1.54628e+06 | best_loss 2.70108
| saved checkpoint /scratch/project_2003453/bertnmt_data/bert-nmt_fi_sv/checkpoint98.pt (epoch 98 @ 1546285 updates) (writing took 7.394391059875488 seconds)
| WARNING: overflow detected, setting loss scale to: 2.0
| epoch 099:   1000 / 49553 loss=3.809, nll_loss=2.143, ppl=4.42, wps=56860, ups=3, wpb=10086.123, bsz=619.082, num_updates=1.54728e+06, lr=2.54223e-05, gnorm=1.195, clip=0.000, oom=0.000, loss_scale=2.000, wall=27153, train_wall=559282
